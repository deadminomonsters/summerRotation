from pyscf import gto, scf, mcscf
import basis_set_exchange

coor = '''
C  0.000000  1.40272  0.000000
H  0.000000  2.49029  0.000000
C -1.21479  0.70136  0.000000
H -2.15666  1.24515  0.000000
C -1.21479 -0.70136  0.000000
H -2.15666 -1.24515  0.000000
C  0.000000 -1.40272  0.000000
H  0.000000 -2.49029  0.000000
C  1.21479 -0.70136  0.000000
H  2.15666 -1.24515  0.000000
C  1.21479  0.70136  0.000000
H  2.15666  1.24515  0.000000
'''


#Building Benzene
benzene = gto.Mole()
benzene.atom = coor
benzene.basis = 'ccpvdz'
benzene.symmetry = True
benzene.spin = 0   # singlet
benzene.charge = 0
benzene.build()


# 2a. Perform RHF calculation
print("\nRHF Calculation")
rhf = scf.RHF(benzene)
rhf.verbose = 4
rhf.kernel()

#2b. Perform RHF with Newton Optimizer
print("\nRHF w/ Newton Optimizer")
mf_newton = scf.RHF(benzene).newton() 
mf_newton.verbose = 4
mf_newton.kernel()

#2c. Perform RHF w/ Density Fitting
print("\nRHF w/ Density Fitting")
rhf_df = scf.RHF(benzene).density_fit()
rhf_df.kernel()

# 3. Perform ROHF calculation
print("\nROHF Calculation")
rohf = scf.ROHF(benzene)
rohf.kernel()

# 4. Perform UHF calculation
print("\nUHF Calculation")
uhf = scf.UHF(benzene)
uhf.kernel()

# 5. Performing calculations with different basis sets
benzene = gto.Mole()
benzene.atom = coor
basis = {'H':"""
H    S
      4.020000E+02           0.000000E+00           0.000000E+00           2.790000E-04           0.000000E+00           0.000000E+00
      6.024000E+01           0.000000E+00           0.000000E+00           2.165000E-03           0.000000E+00           0.000000E+00
      1.373000E+01           0.000000E+00           0.000000E+00           1.120100E-02           0.000000E+00           0.000000E+00
      3.905000E+00           0.000000E+00           0.000000E+00           4.487800E-02           0.000000E+00           0.000000E+00
      1.283000E+00           1.000000E+00           0.000000E+00           1.422990E-01           0.000000E+00           0.000000E+00
      4.655000E-01           0.000000E+00           1.000000E+00           3.309790E-01           0.000000E+00           0.000000E+00
      1.811000E-01           0.000000E+00           0.000000E+00           4.362690E-01           1.000000E+00           0.000000E+00
      7.279000E-02           0.000000E+00           0.000000E+00           1.764400E-01           0.000000E+00           1.000000E+00
H    P
      4.516000E+00           1.000000E+00           0.000000E+00           0.000000E+00           0.000000E+00
      1.712000E+00           0.000000E+00           1.000000E+00           0.000000E+00           0.000000E+00
      6.490000E-01           0.000000E+00           0.000000E+00           1.000000E+00           0.000000E+00
      2.460000E-01           0.000000E+00           0.000000E+00           0.000000E+00           1.000000E+00
H    D
      2.950000E+00           1.000000E+00           0.000000E+00           0.000000E+00
      1.206000E+00           0.000000E+00           1.000000E+00           0.000000E+00
      4.930000E-01           0.000000E+00           0.000000E+00           1.000000E+00
H    F
      2.506000E+00           1.000000E+00           0.000000E+00
      8.750000E-01           0.000000E+00           1.000000E+00
H    G
      2.358000E+00           1.0000000
""",

'C': """
C    S
      9.677000E+04           2.500000E-05           0.000000E+00           0.000000E+00           0.000000E+00          -5.000000E-06           0.000000E+00
      1.450000E+04           1.900000E-04           0.000000E+00           0.000000E+00           0.000000E+00          -4.100000E-05           0.000000E+00
      3.300000E+03           1.000000E-03           0.000000E+00           0.000000E+00           0.000000E+00          -2.130000E-04           0.000000E+00
      9.358000E+02           4.183000E-03           0.000000E+00           0.000000E+00           0.000000E+00          -8.970000E-04           0.000000E+00
      3.062000E+02           1.485900E-02           0.000000E+00           0.000000E+00           0.000000E+00          -3.187000E-03           0.000000E+00
      1.113000E+02           4.530100E-02           0.000000E+00           0.000000E+00           0.000000E+00          -9.961000E-03           0.000000E+00
      4.390000E+01           1.165040E-01           0.000000E+00           0.000000E+00           0.000000E+00          -2.637500E-02           0.000000E+00
      1.840000E+01           2.402490E-01           0.000000E+00           0.000000E+00           0.000000E+00          -6.000100E-02           0.000000E+00
      8.054000E+00           3.587990E-01           0.000000E+00           0.000000E+00           0.000000E+00          -1.068250E-01           0.000000E+00
      3.637000E+00           2.939410E-01           0.000000E+00           0.000000E+00           0.000000E+00          -1.441660E-01           0.000000E+00
      1.656000E+00           7.766500E-02           1.000000E+00           0.000000E+00           0.000000E+00          -2.464420E-02           0.000000E+00
      6.333000E-01           2.333000E-03           0.000000E+00           1.000000E+00           0.000000E+00           3.490090E-01           0.000000E+00
      2.545000E-01           5.050000E-04           0.000000E+00           0.000000E+00           1.000000E+00           5.587370E-01           0.000000E+00
      1.019000E-01           3.000000E-05           0.000000E+00           0.000000E+00           0.000000E+00           2.281020E-01           1.000000E+00
C    P
      1.018000E+02           0.000000E+00           0.000000E+00           8.910000E-04           0.000000E+00           0.000000E+00
      2.404000E+01           0.000000E+00           0.000000E+00           6.976000E-03           0.000000E+00           0.000000E+00
      7.571000E+00           0.000000E+00           0.000000E+00           3.166900E-02           0.000000E+00           0.000000E+00
      2.732000E+00           0.000000E+00           0.000000E+00           1.040060E-01           0.000000E+00           0.000000E+00
      1.085000E+00           1.000000E+00           0.000000E+00           2.416330E-01           0.000000E+00           0.000000E+00
      4.496000E-01           0.000000E+00           1.000000E+00           3.719460E-01           0.000000E+00           0.000000E+00
      1.876000E-01           0.000000E+00           0.000000E+00           3.542000E-01           1.000000E+00           0.000000E+00
      7.606000E-02           0.000000E+00           0.000000E+00           1.315680E-01           0.000000E+00           1.000000E+00
C    D
      3.134000E+00           1.000000E+00           0.000000E+00           0.000000E+00           0.000000E+00
      1.233000E+00           0.000000E+00           1.000000E+00           0.000000E+00           0.000000E+00
      4.850000E-01           0.000000E+00           0.000000E+00           1.000000E+00           0.000000E+00
      1.910000E-01           0.000000E+00           0.000000E+00           0.000000E+00           1.000000E+00
C    F
      2.006000E+00           1.000000E+00           0.000000E+00           0.000000E+00
      8.380000E-01           0.000000E+00           1.000000E+00           0.000000E+00
      3.500000E-01           0.000000E+00           0.000000E+00           1.000000E+00
C    G
      1.753000E+00           1.000000E+00           0.000000E+00
      6.780000E-01           0.000000E+00           1.000000E+00
C    H
      1.259000E+00           1.0000000

"""
}

benzene.basis = basis
benzene.symmetry = True
benzene.spin = 0   # singlet
benzene.charge = 0
benzene.build()

print("\nRHF Calculation w/ ccpv5z")
rhf = scf.RHF(benzene)
rhf.kernel()