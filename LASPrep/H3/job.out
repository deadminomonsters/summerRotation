#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:25 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.387298334621   0.100000000000 AA    0.000000000000   0.731887780933   0.188972612457 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.200000000000 AA    0.000000000000   0.000000000000   0.377945224913 Bohr   0.0

nuclear repulsion = 5.2917721092
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:         1.40


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpmt8a5qtf
max_memory 40000 MB (current use 101 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.0439251108952359
  HOMO = 0.151839357513315  LUMO = 0.195230810824303
cycle= 1 E= 0.432205310340292  delta_E= 0.476  |g|= 0.327  |ddm|= 16.2
  HOMO = 0.0399031507894616  LUMO = 0.184431708957802
cycle= 2 E= 0.397868054117898  delta_E= -0.0343  |g|= 0.0488  |ddm|= 0.968
  HOMO = 0.0561215361825165  LUMO = 0.197740028618263
cycle= 3 E= 0.39691682275568  delta_E= -0.000951  |g|= 0.00506  |ddm|= 0.184
  HOMO = 0.0551853370251731  LUMO = 0.196073818833265
cycle= 4 E= 0.396880912008021  delta_E= -3.59e-05  |g|= 0.00139  |ddm|= 0.0545
  HOMO = 0.055346514647033  LUMO = 0.195670066377884
cycle= 5 E= 0.396871242333365  delta_E= -9.67e-06  |g|= 0.000715  |ddm|= 0.0712
  HOMO = 0.0557938119816131  LUMO = 0.195488015633709
cycle= 6 E= 0.396868366879509  delta_E= -2.88e-06  |g|= 3.09e-05  |ddm|= 0.0842
  HOMO = 0.0557898194252833  LUMO = 0.195494631128454
cycle= 7 E= 0.396868364800911  delta_E= -2.08e-09  |g|= 3.11e-06  |ddm|= 0.00214
  HOMO = 0.0557864720889729  LUMO = 0.195495220399694
cycle= 8 E= 0.396868364752976  delta_E= -4.79e-11  |g|= 1e-07  |ddm|= 0.000315
  HOMO = 0.0557864369581433  LUMO = 0.195495215308141
Extra cycle  E= 0.396868364752949  delta_E= -2.66e-14  |g|= 4.16e-08  |ddm|= 3.4e-06
converged SCF energy = 0.396868364752949

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpmt8a5qtf
max_memory 40000 MB (current use 110 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = 1.84511739875572  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = 1.79887330271836  dE = -4.62440960e-02  S^2 = 0.7500000
               |grad[o]|=0.231  |ddm|=1.87e-16  |maxRot[o]|=0.0957
macro iter   2 ( 16 JK    4 micro), CASSCF E = 1.77990223398843  dE = -1.89710687e-02  S^2 = 0.7500000
               |grad[o]|= 0.13  |ddm|=5.09e-16  |maxRot[o]|=0.113
macro iter   3 (  5 JK    2 micro), CASSCF E = 1.77982849213546  dE = -7.37418530e-05  S^2 = 0.7500000
               |grad[o]|=0.0081  |ddm|=6e-16  |maxRot[o]|=0.00672
macro iter   4 (  3 JK    1 micro), CASSCF E = 1.77982849072298  dE = -1.41247947e-09  S^2 = 0.7500000
               |grad[o]|=3.58e-05  |ddm|=3.25e-16  |maxRot[o]|=2.92e-05
1-step CASSCF converged in   4 macro ( 45 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = 1.77982849072298
CASCI E = 1.77982849072298  E(CI) = -3.51194361847702  S^2 = 0.7500000
CASCI state-averaged energy = 1.77982849072298
CASCI energy for each state
  State 0 weight 0.125  E = 0.431054340242898 S^2 = 0.7500000
  State 1 weight 0.125  E = 0.454803750228591 S^2 = 0.7500000
  State 2 weight 0.125  E = 1.636917734451 S^2 = 0.7500000
  State 3 weight 0.125  E = 1.65226396811164 S^2 = 0.7500000
  State 4 weight 0.125  E = 1.72670431594516 S^2 = 0.7500000
  State 5 weight 0.125  E = 1.74985963755955 S^2 = 0.7500000
  State 6 weight 0.125  E = 3.25378202050493 S^2 = 0.7500000
  State 7 weight 0.125  E = 3.33324215874006 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpmt8a5qtf
max_memory 40000 MB (current use 119 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = 1.64543683358558  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = 1.59871333464296  dE = -4.67234989e-02  S^2 = 3.7500000
               |grad[o]|=0.264  |ddm|=    0  |maxRot[o]|=0.0958
macro iter   2 ( 19 JK    4 micro), CASSCF E = 1.57020207910619  dE = -2.85112555e-02  S^2 = 3.7500000
               |grad[o]|=0.167  |ddm|=    0  |maxRot[o]|=0.153
macro iter   3 (  7 JK    3 micro), CASSCF E = 1.57015738601397  dE = -4.46930922e-05  S^2 = 3.7500000
               |grad[o]|=0.00547  |ddm|=    0  |maxRot[o]|=0.0122
macro iter   4 (  1 JK    1 micro), CASSCF E = 1.57015738601397  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.58e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 48 JK  12 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = 1.57015738601397
CASCI E = 1.57015738601397  E(CI) = -3.72161472318603  S^2 = 3.7500000
CASCI state-averaged energy = 1.57015738601397
CASCI energy for each state
  State 0 weight 1  E = 1.57015738601397 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:30 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.474341649025   0.150000000000 AA    0.000000000000   0.896375806132   0.283458918685 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.300000000000 AA    0.000000000000   0.000000000000   0.566917837370 Bohr   0.0

nuclear repulsion = 3.891296468192
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        12.80


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpkn423me7
max_memory 40000 MB (current use 119 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.988081964460688
  HOMO = 0.135689775486679  LUMO = 0.188833284636699
cycle= 1 E= -0.608783431508391  delta_E= 0.379  |g|= 0.287  |ddm|=   11
  HOMO = 0.0196120360257192  LUMO = 0.181494552387631
cycle= 2 E= -0.637470806513373  delta_E= -0.0287  |g|= 0.0418  |ddm|= 1.04
  HOMO = 0.041952903323171  LUMO = 0.197027568952366
cycle= 3 E= -0.638324304427635  delta_E= -0.000853  |g|= 0.00602  |ddm|= 0.112
  HOMO = 0.0408225622182831  LUMO = 0.195300524818139
cycle= 4 E= -0.638383777403678  delta_E= -5.95e-05  |g|= 0.00173  |ddm|= 0.059
  HOMO = 0.0408129848241618  LUMO = 0.194765008694439
cycle= 5 E= -0.638395521118262  delta_E= -1.17e-05  |g|= 0.000493  |ddm|= 0.0433
  HOMO = 0.0410784245232025  LUMO = 0.194736685839805
cycle= 6 E= -0.638396208706243  delta_E= -6.88e-07  |g|= 4.43e-05  |ddm|= 0.0196
  HOMO = 0.0410716803477262  LUMO = 0.194754364160068
cycle= 7 E= -0.638396212163373  delta_E= -3.46e-09  |g|= 2.09e-06  |ddm|= 0.000887
  HOMO = 0.0410722262617899  LUMO = 0.194754089294585
cycle= 8 E= -0.638396212176445  delta_E= -1.31e-11  |g|= 1.31e-07  |ddm|= 7.95e-05
  HOMO = 0.041072236274052  LUMO = 0.194754090398352
Extra cycle  E= -0.638396212176485  delta_E= -4e-14  |g|= 6.05e-08  |ddm|= 2.59e-06
converged SCF energy = -0.638396212176485

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpkn423me7
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = 0.625468038783525  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = 0.581478604197692  dE = -4.39894346e-02  S^2 = 0.7500000
               |grad[o]|=0.225  |ddm|=4.6e-16  |maxRot[o]|=0.0959
macro iter   2 ( 15 JK    4 micro), CASSCF E = 0.566334661284822  dE = -1.51439429e-02  S^2 = 0.7500000
               |grad[o]|=0.118  |ddm|=1.31e-16  |maxRot[o]|=0.0986
macro iter   3 (  3 JK    1 micro), CASSCF E = 0.566288078803574  dE = -4.65824812e-05  S^2 = 0.7500000
               |grad[o]|=0.0065  |ddm|=3.51e-16  |maxRot[o]|=0.00528
macro iter   4 (  1 JK    1 micro), CASSCF E = 0.566288078803574  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.34e-05  |ddm|=1.79e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 40 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = 0.566288078803574
CASCI E = 0.566288078803574  E(CI) = -3.32500838938843  S^2 = 0.7500000
CASCI state-averaged energy = 0.566288078803574
CASCI energy for each state
  State 0 weight 0.125  E = -0.609818311063545 S^2 = 0.7500000
  State 1 weight 0.125  E = -0.573710264763589 S^2 = 0.7500000
  State 2 weight 0.125  E = 0.425917064191123 S^2 = 0.7500000
  State 3 weight 0.125  E = 0.447297046744032 S^2 = 0.7500000
  State 4 weight 0.125  E = 0.537336130237861 S^2 = 0.7500000
  State 5 weight 0.125  E = 0.558725128398966 S^2 = 0.7500000
  State 6 weight 0.125  E = 1.82894518032127 S^2 = 0.7500000
  State 7 weight 0.125  E = 1.91561265636248 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpkn423me7
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = 0.435166059778360  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = 0.387300036908341  dE = -4.78660229e-02  S^2 = 3.7500000
               |grad[o]|=0.261  |ddm|=    0  |maxRot[o]|=0.0959
macro iter   2 ( 19 JK    4 micro), CASSCF E = 0.358572111253546  dE = -2.87279257e-02  S^2 = 3.7500000
               |grad[o]|=0.164  |ddm|=    0  |maxRot[o]|=0.153
macro iter   3 (  5 JK    2 micro), CASSCF E = 0.358521161158954  dE = -5.09500946e-05  S^2 = 3.7500000
               |grad[o]|=0.00668  |ddm|=    0  |maxRot[o]|=0.00607
macro iter   4 (  3 JK    1 micro), CASSCF E = 0.358521160261637  dE = -8.97316887e-10  S^2 = 3.7500000
               |grad[o]|=3.27e-05  |ddm|=    0  |maxRot[o]|=4.55e-05
1-step CASSCF converged in   4 macro ( 48 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = 0.358521160261637
CASCI E = 0.358521160261637  E(CI) = -3.53277530793036  S^2 = 3.7500000
CASCI state-averaged energy = 0.358521160261637
CASCI energy for each state
  State 0 weight 1  E = 0.358521160261637 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:33 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.547722557505   0.200000000000 AA    0.000000000000   1.035045625931   0.377945224913 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.400000000000 AA    0.000000000000   0.000000000000   0.755890449826 Bohr   0.0

nuclear repulsion = 3.13800588654878
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        23.00


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp67h7hpu_
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.3331307981746
  HOMO = 0.121222369246413  LUMO = 0.178923028260758
cycle= 1 E= -1.05826499360821  delta_E= 0.275  |g|= 0.25  |ddm|= 8.09
  HOMO = 0.00522323151562024  LUMO = 0.174289869816196
cycle= 2 E= -1.0821437225219  delta_E= -0.0239  |g|= 0.0346  |ddm|= 0.947
  HOMO = 0.0303155186453155  LUMO = 0.191632967276138
cycle= 3 E= -1.08278894455047  delta_E= -0.000645  |g|= 0.00564  |ddm|= 0.0732
  HOMO = 0.0293633044084726  LUMO = 0.190277570226607
cycle= 4 E= -1.08283601492452  delta_E= -4.71e-05  |g|= 0.00132  |ddm|= 0.048
  HOMO = 0.0291545805491766  LUMO = 0.189858097169552
cycle= 5 E= -1.08284151850798  delta_E= -5.5e-06  |g|= 0.000265  |ddm|= 0.0204
  HOMO = 0.0292772146593323  LUMO = 0.189854320918494
cycle= 6 E= -1.08284166768834  delta_E= -1.49e-07  |g|= 4.41e-05  |ddm|= 0.00523
  HOMO = 0.0292896371192935  LUMO = 0.189869978153831
cycle= 7 E= -1.08284166911715  delta_E= -1.43e-09  |g|= 2.67e-06  |ddm|= 0.000625
  HOMO = 0.0292906306003558  LUMO = 0.189869973380876
cycle= 8 E= -1.08284166913128  delta_E= -1.41e-11  |g|= 2.23e-07  |ddm|= 4.8e-05
  HOMO = 0.0292905851608334  LUMO = 0.189869975777775
Extra cycle  E= -1.08284166913133  delta_E= -4.62e-14  |g|= 6.59e-08  |ddm|= 1.25e-06
converged SCF energy = -1.08284166913133

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp67h7hpu_
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = 0.0280955080321381  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -0.0108672179114351  dE = -3.89627259e-02  S^2 = 0.7500000
               |grad[o]|=0.215  |ddm|=4.16e-16  |maxRot[o]|=0.0959
macro iter   2 ( 15 JK    4 micro), CASSCF E = -0.0255420893128705  dE = -1.46748714e-02  S^2 = 0.7500000
               |grad[o]|=0.116  |ddm|=2.36e-16  |maxRot[o]|=0.104
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.0255822791083505  dE = -4.01897955e-05  S^2 = 0.7500000
               |grad[o]|=0.00605  |ddm|=2.26e-16  |maxRot[o]|=0.00526
macro iter   4 (  1 JK    1 micro), CASSCF E = -0.0255822791083505  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=1.03e-05  |ddm|=3.23e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 40 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.0255822791083505
CASCI E = -0.0255822791083505  E(CI) = -3.16358816565713  S^2 = 0.7500000
CASCI state-averaged energy = -0.0255822791083505
CASCI energy for each state
  State 0 weight 0.125  E = -1.0601975294442 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.01602280315736 S^2 = 0.7500000
  State 2 weight 0.125  E = -0.157225446519255 S^2 = 0.7500000
  State 3 weight 0.125  E = -0.13369235502656 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.0338967850996799 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.0205434308964811 S^2 = 0.7500000
  State 6 weight 0.125  E = 1.06778937293737 S^2 = 0.7500000
  State 7 weight 0.125  E = 1.14913074433936 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp67h7hpu_
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -0.156802606490262  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -0.231462696624919  dE = -7.46600901e-02  S^2 = 3.7500000
               |grad[o]|=0.253  |ddm|=    0  |maxRot[o]|=0.244
macro iter   2 (  7 JK    3 micro), CASSCF E = -0.232021243598999  dE = -5.58546974e-04  S^2 = 3.7500000
               |grad[o]|=0.0234  |ddm|=    0  |maxRot[o]|=0.0199
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.232021289373140  dE = -4.57741414e-08  S^2 = 3.7500000
               |grad[o]|=0.000193  |ddm|=    0  |maxRot[o]|=0.000185
1-step CASSCF converged in   3 macro ( 28 JK   8 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.232021289373140
CASCI E = -0.232021289373140  E(CI) = -3.37002717592192  S^2 = 3.7500000
CASCI state-averaged energy = -0.23202128937314
CASCI energy for each state
  State 0 weight 1  E = -0.23202128937314 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:35 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.612372435696   0.250000000000 AA    0.000000000000   1.157216189698   0.472431531141 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.500000000000 AA    0.000000000000   0.000000000000   0.944863062283 Bohr   0.0

nuclear repulsion = 2.65843590707096
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        31.93


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpoojey0xx
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.45100587695697
  HOMO = 0.108682266682621  LUMO = 0.165627141330846
cycle= 1 E= -1.27921187725207  delta_E= 0.172  |g|= 0.219  |ddm|= 6.36
  HOMO = -0.00665374623709154  LUMO = 0.163789047802949
cycle= 2 E= -1.29930561536851  delta_E= -0.0201  |g|= 0.0286  |ddm|= 0.86
  HOMO = 0.0195994812273378  LUMO = 0.18257084548697
cycle= 3 E= -1.29977771353466  delta_E= -0.000472  |g|= 0.00502  |ddm|= 0.0474
  HOMO = 0.0190643092157889  LUMO = 0.18167469283006
cycle= 4 E= -1.2998124038741  delta_E= -3.47e-05  |g|= 0.000991  |ddm|= 0.0347
  HOMO = 0.0188061019894999  LUMO = 0.181371928124919
cycle= 5 E= -1.29981515428849  delta_E= -2.75e-06  |g|= 0.000147  |ddm|= 0.0121
  HOMO = 0.0188685338672694  LUMO = 0.181366997157265
cycle= 6 E= -1.29981519469142  delta_E= -4.04e-08  |g|= 3.43e-05  |ddm|= 0.00175
  HOMO = 0.0188822828811922  LUMO = 0.181377656966871
cycle= 7 E= -1.29981519572671  delta_E= -1.04e-09  |g|= 2.71e-06  |ddm|= 0.000462
  HOMO = 0.0188834812043562  LUMO = 0.181378095681503
cycle= 8 E= -1.29981519573633  delta_E= -9.61e-12  |g|= 2.71e-07  |ddm|= 3.32e-05
  HOMO = 0.0188834481952846  LUMO = 0.181378110781312
Extra cycle  E= -1.29981519573639  delta_E= -5.82e-14  |g|= 7.37e-08  |ddm|= 9.62e-07
converged SCF energy = -1.29981519573639

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpoojey0xx
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -0.317733766385737  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -0.365871811471696  dE = -4.81380451e-02  S^2 = 0.7500000
               |grad[o]|=0.203  |ddm|=1.57e-16  |maxRot[o]|=0.216
macro iter   2 (  7 JK    3 micro), CASSCF E = -0.366297072477449  dE = -4.25261006e-04  S^2 = 0.7500000
               |grad[o]|=0.0198  |ddm|=2.29e-16  |maxRot[o]|=0.0178
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.366297109154644  dE = -3.66771948e-08  S^2 = 0.7500000
               |grad[o]|=0.000181  |ddm|=3.28e-16  |maxRot[o]|=0.000166
1-step CASSCF converged in   3 macro ( 27 JK   8 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.366297109154644
CASCI E = -0.366297109154644  E(CI) = -3.02473301622561  S^2 = 0.7500000
CASCI state-averaged energy = -0.366297109154644
CASCI energy for each state
  State 0 weight 0.125  E = -1.2827634886087 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.2360319715154 S^2 = 0.7500000
  State 2 weight 0.125  E = -0.484862326315075 S^2 = 0.7500000
  State 3 weight 0.125  E = -0.462917572904861 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.356838455705732 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.356070049643212 S^2 = 0.7500000
  State 6 weight 0.125  E = 0.589849356674758 S^2 = 0.7500000
  State 7 weight 0.125  E = 0.659257634781066 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpoojey0xx
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -0.499595098084249  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -0.572018726421021  dE = -7.24236283e-02  S^2 = 3.7500000
               |grad[o]|=0.243  |ddm|=    0  |maxRot[o]|=0.248
macro iter   2 (  7 JK    3 micro), CASSCF E = -0.572510221948255  dE = -4.91495527e-04  S^2 = 3.7500000
               |grad[o]|=0.0218  |ddm|=    0  |maxRot[o]|=0.0182
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.572510252405352  dE = -3.04570973e-08  S^2 = 3.7500000
               |grad[o]|=0.000164  |ddm|=    0  |maxRot[o]|=0.000138
1-step CASSCF converged in   3 macro ( 28 JK   8 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.572510252405352
CASCI E = -0.572510252405352  E(CI) = -3.23094615947632  S^2 = 3.7500000
CASCI state-averaged energy = -0.572510252405352
CASCI energy for each state
  State 0 weight 1  E = -0.572510252405352 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:38 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.670820393250   0.300000000000 AA    0.000000000000   1.267666822015   0.566917837370 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.600000000000 AA    0.000000000000   0.000000000000   1.133835674739 Bohr   0.0

nuclear repulsion = 2.32219996293683
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        40.14


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpk6pmn1gl
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.47047773233872
  HOMO = 0.0976570549874873  LUMO = 0.149121460691026
cycle= 1 E= -1.39376418718752  delta_E= 0.0767  |g|= 0.194  |ddm|= 5.24
  HOMO = -0.016604255516912  LUMO = 0.150442639627478
cycle= 2 E= -1.41090702868397  delta_E= -0.0171  |g|= 0.0239  |ddm|= 0.78
  HOMO = 0.00963334367042636  LUMO = 0.170285806238056
cycle= 3 E= -1.41126231933959  delta_E= -0.000355  |g|= 0.00447  |ddm|= 0.0405
  HOMO = 0.0095545478069679  LUMO = 0.169825876790186
cycle= 4 E= -1.41128889966749  delta_E= -2.66e-05  |g|= 0.000767  |ddm|= 0.023
  HOMO = 0.00932218970650248  LUMO = 0.169631177355346
cycle= 5 E= -1.41129043411983  delta_E= -1.53e-06  |g|= 9.25e-05  |ddm|= 0.00751
  HOMO = 0.00936320119283623  LUMO = 0.169625911080868
cycle= 6 E= -1.41129044929795  delta_E= -1.52e-08  |g|= 2.02e-05  |ddm|= 0.000803
  HOMO = 0.0093715117765931  LUMO = 0.169631283680374
cycle= 7 E= -1.41129044964805  delta_E= -3.5e-10  |g|= 2.11e-06  |ddm|= 0.000214
  HOMO = 0.0093724449339431  LUMO = 0.16963178684596
Extra cycle  E= -1.41129044965199  delta_E= -3.94e-12  |g|= 7.46e-07  |ddm|= 1.6e-05
converged SCF energy = -1.41129044965199

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpk6pmn1gl
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -0.539501662718145  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -0.582749240248341  dE = -4.32475775e-02  S^2 = 0.7500000
               |grad[o]|=0.191  |ddm|=3.94e-16  |maxRot[o]|=0.217
macro iter   2 (  5 JK    2 micro), CASSCF E = -0.583080011384283  dE = -3.30771136e-04  S^2 = 0.7500000
               |grad[o]|=0.0174  |ddm|=5.31e-16  |maxRot[o]|=0.0165
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.583080033457703  dE = -2.20734198e-08  S^2 = 0.7500000
               |grad[o]|=0.000149  |ddm|=4.44e-16  |maxRot[o]|=0.000133
1-step CASSCF converged in   3 macro ( 25 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.583080033457703
CASCI E = -0.583080033457703  E(CI) = -2.90527999639454  S^2 = 0.7500000
CASCI state-averaged energy = -0.583080033457703
CASCI energy for each state
  State 0 weight 0.125  E = -1.39933374057764 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.35541344406507 S^2 = 0.7500000
  State 2 weight 0.125  E = -0.685934557354525 S^2 = 0.7500000
  State 3 weight 0.125  E = -0.668752685212322 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.572696537281 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.558265709983657 S^2 = 0.7500000
  State 6 weight 0.125  E = 0.260535218484808 S^2 = 0.7500000
  State 7 weight 0.125  E = 0.315221188327779 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpk6pmn1gl
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -0.720209990639882  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -0.790279253997131  dE = -7.00692634e-02  S^2 = 3.7500000
               |grad[o]|=0.232  |ddm|=    0  |maxRot[o]|=0.256
macro iter   2 (  5 JK    2 micro), CASSCF E = -0.790428536177893  dE = -1.49282181e-04  S^2 = 3.7500000
               |grad[o]|=0.0124  |ddm|=    0  |maxRot[o]|=0.0102
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.790428538677081  dE = -2.49918797e-09  S^2 = 3.7500000
               |grad[o]|=5.17e-05  |ddm|=    0  |maxRot[o]|=4.15e-05
1-step CASSCF converged in   3 macro ( 26 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.790428538677081
CASCI E = -0.790428538677081  E(CI) = -3.11262850161391  S^2 = 3.7500000
CASCI state-averaged energy = -0.790428538677081
CASCI energy for each state
  State 0 weight 1  E = -0.790428538677081 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.724568837309   0.350000000000 AA    0.000000000000   1.369236660909   0.661404143598 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.700000000000 AA    0.000000000000   0.000000000000   1.322808287196 Bohr   0.0

nuclear repulsion = 2.07122632306154
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        47.48


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpsuaddwmb
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.44623503333176
  HOMO = 0.0877099531588699  LUMO = 0.129741284927725
cycle= 1 E= -1.4531016969017  delta_E= -0.00687  |g|= 0.173  |ddm|= 4.45
  HOMO = -0.0249322104411473  LUMO = 0.134711552911513
cycle= 2 E= -1.46792656071788  delta_E= -0.0148  |g|= 0.0205  |ddm|= 0.704
  HOMO = 0.000394233267066863  LUMO = 0.155249942484519
cycle= 3 E= -1.46821692781444  delta_E= -0.00029  |g|= 0.00419  |ddm|= 0.0455
  HOMO = 0.000714839866943372  LUMO = 0.155170250050317
cycle= 4 E= -1.46824035533969  delta_E= -2.34e-05  |g|= 0.000644  |ddm|= 0.0155
  HOMO = 0.000523811727786891  LUMO = 0.155069583221413
cycle= 5 E= -1.46824135113494  delta_E= -9.96e-07  |g|= 6.66e-05  |ddm|= 0.00481
  HOMO = 0.000561580708932481  LUMO = 0.155068982171899
cycle= 6 E= -1.46824135875402  delta_E= -7.62e-09  |g|= 1.31e-05  |ddm|= 0.000484
  HOMO = 0.000566883748195049  LUMO = 0.155072074142921
cycle= 7 E= -1.46824135889978  delta_E= -1.46e-10  |g|= 1.52e-06  |ddm|= 0.000116
  HOMO = 0.000567618777047443  LUMO = 0.155072504136639
Extra cycle  E= -1.46824135890168  delta_E= -1.9e-12  |g|= 5.21e-07  |ddm|= 1.05e-05
converged SCF energy = -1.46824135890168

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpsuaddwmb
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -0.692448702223734  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 16 JK    4 micro), CASSCF E = -0.730652897551487  dE = -3.82041953e-02  S^2 = 0.7500000
               |grad[o]|=0.178  |ddm|=2.35e-16  |maxRot[o]|=0.213
macro iter   2 (  3 JK    1 micro), CASSCF E = -0.730900987057401  dE = -2.48089506e-04  S^2 = 0.7500000
               |grad[o]|=0.0149  |ddm|=6.37e-16  |maxRot[o]|=0.0156
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.730900988469592  dE = -1.41219014e-09  S^2 = 0.7500000
               |grad[o]|=4.52e-05  |ddm|=8.02e-16  |maxRot[o]|=3.18e-05
1-step CASSCF converged in   3 macro ( 22 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.730900988469592
CASCI E = -0.730900988469592  E(CI) = -2.80212731153113  S^2 = 0.7500000
CASCI state-averaged energy = -0.730900988469591
CASCI energy for each state
  State 0 weight 0.125  E = -1.46099304012697 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.42437874197356 S^2 = 0.7500000
  State 2 weight 0.125  E = -0.817022967290182 S^2 = 0.7500000
  State 3 weight 0.125  E = -0.8066724523621 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.723218458710813 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.692849925857515 S^2 = 0.7500000
  State 6 weight 0.125  E = 0.0193194256861493 S^2 = 0.7500000
  State 7 weight 0.125  E = 0.0586082528782561 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpsuaddwmb
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -0.873667987164923  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -0.940304565033325  dE = -6.66365779e-02  S^2 = 3.7500000
               |grad[o]|=0.221  |ddm|=    0  |maxRot[o]|=0.271
macro iter   2 (  5 JK    2 micro), CASSCF E = -0.940634078614425  dE = -3.29513581e-04  S^2 = 3.7500000
               |grad[o]|=0.0176  |ddm|=    0  |maxRot[o]|=0.015
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.940634089823525  dE = -1.12090999e-08  S^2 = 3.7500000
               |grad[o]|=0.000104  |ddm|=    0  |maxRot[o]|=8.97e-05
1-step CASSCF converged in   3 macro ( 27 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.940634089823525
CASCI E = -0.940634089823525  E(CI) = -3.01186041288507  S^2 = 3.7500000
CASCI state-averaged energy = -0.940634089823525
CASCI energy for each state
  State 0 weight 1  E = -0.940634089823525 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:41 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.774596669241   0.400000000000 AA    0.000000000000   1.463775561867   0.755890449826 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.800000000000 AA    0.000000000000   0.000000000000   1.511780899652 Bohr   0.0

nuclear repulsion = 1.87548729555789
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        54.27


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpovmnbr0u
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.40352188178962
  HOMO = 0.0784944213472565  LUMO = 0.108097857839078
cycle= 1 E= -1.48166785706501  delta_E= -0.0781  |g|= 0.156  |ddm|= 3.86
  HOMO = -0.0318914504337023  LUMO = 0.117182450476877
cycle= 2 E= -1.49467233585544  delta_E= -0.013  |g|= 0.0182  |ddm|= 0.63
  HOMO = -0.00814022212002364  LUMO = 0.138066715623348
cycle= 3 E= -1.49494193815697  delta_E= -0.00027  |g|= 0.00426  |ddm|= 0.0529
  HOMO = -0.0074973125499561  LUMO = 0.138316540082599
cycle= 4 E= -1.49496767875051  delta_E= -2.57e-05  |g|= 0.000638  |ddm|= 0.0145
  HOMO = -0.00767114240522757  LUMO = 0.138290707586282
cycle= 5 E= -1.49496851817332  delta_E= -8.39e-07  |g|= 6e-05  |ddm|= 0.00399
  HOMO = -0.00762668129460776  LUMO = 0.138297727173131
cycle= 6 E= -1.49496852346949  delta_E= -5.3e-09  |g|= 1.29e-05  |ddm|= 0.00042
  HOMO = -0.00762171201556151  LUMO = 0.138301455083885
cycle= 7 E= -1.49496852364764  delta_E= -1.78e-10  |g|= 1.65e-06  |ddm|= 0.000119
  HOMO = -0.00762108284880737  LUMO = 0.138301946353164
Extra cycle  E= -1.49496852365078  delta_E= -3.13e-12  |g|= 5.95e-07  |ddm|= 1.03e-05
converged SCF energy = -1.49496852365078

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpovmnbr0u
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -0.803747106112580  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 16 JK    4 micro), CASSCF E = -0.836756706080294  dE = -3.30096000e-02  S^2 = 0.7500000
               |grad[o]|=0.165  |ddm|=8.71e-16  |maxRot[o]|=0.202
macro iter   2 (  5 JK    2 micro), CASSCF E = -0.836925682555778  dE = -1.68976475e-04  S^2 = 0.7500000
               |grad[o]|=0.0124  |ddm|=4.93e-16  |maxRot[o]|=0.0126
macro iter   3 (  3 JK    1 micro), CASSCF E = -0.836925687747944  dE = -5.19216603e-09  S^2 = 0.7500000
               |grad[o]|=7.58e-05  |ddm|=7.59e-16  |maxRot[o]|=6.52e-05
1-step CASSCF converged in   3 macro ( 24 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.836925687747944
CASCI E = -0.836925687747944  E(CI) = -2.71241298330583  S^2 = 0.7500000
CASCI state-averaged energy = -0.836925687747944
CASCI energy for each state
  State 0 weight 0.125  E = -1.49224312169075 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46624196503353 S^2 = 0.7500000
  State 2 weight 0.125  E = -0.907231146612434 S^2 = 0.7500000
  State 3 weight 0.125  E = -0.903904377559588 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.832362521442451 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.787658253758896 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.165128037427626 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.140636078458272 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpovmnbr0u
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -0.986998429297022  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -1.04979085620933  dE = -6.27924269e-02  S^2 = 3.7500000
               |grad[o]|=0.211  |ddm|=    0  |maxRot[o]|=0.271
macro iter   2 (  5 JK    2 micro), CASSCF E = -1.05002468029812  dE = -2.33824089e-04  S^2 = 3.7500000
               |grad[o]|=0.0148  |ddm|=    0  |maxRot[o]|=0.0123
macro iter   3 (  3 JK    1 micro), CASSCF E = -1.05002468537926  dE = -5.08114484e-09  S^2 = 3.7500000
               |grad[o]|=7.05e-05  |ddm|=    0  |maxRot[o]|=5.89e-05
1-step CASSCF converged in   3 macro ( 27 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.05002468537926
CASCI E = -1.05002468537926  E(CI) = -2.92551198093715  S^2 = 3.7500000
CASCI state-averaged energy = -1.05002468537926
CASCI energy for each state
  State 0 weight 1  E = -1.05002468537926 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:43 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.821583836258   0.450000000000 AA    0.000000000000   1.552568438897   0.850376756054 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.900000000000 AA    0.000000000000   0.000000000000   1.700753512109 Bohr   0.0

nuclear repulsion = 1.7177902764046
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        61.42


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpcrduaoro
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.35466156043094
  HOMO = 0.0697658472318664  LUMO = 0.0850130240200292
cycle= 1 E= -1.49227498872458  delta_E= -0.138  |g|= 0.142  |ddm|=  3.4
  HOMO = -0.0377082339934243  LUMO = 0.0985210084385227
cycle= 2 E= -1.50387546836524  delta_E= -0.0116  |g|= 0.017  |ddm|= 0.561
  HOMO = -0.0160115581451023  LUMO = 0.119404034144997
cycle= 3 E= -1.50416216280237  delta_E= -0.000287  |g|= 0.00469  |ddm|= 0.0599
  HOMO = -0.0151096450304512  LUMO = 0.119952428397276
cycle= 4 E= -1.50419646131043  delta_E= -3.43e-05  |g|= 0.000711  |ddm|= 0.0189
  HOMO = -0.0153106278551867  LUMO = 0.119979817321598
cycle= 5 E= -1.50419737535596  delta_E= -9.14e-07  |g|= 7.41e-05  |ddm|= 0.00448
  HOMO = -0.0152556678628362  LUMO = 0.1199941624449
cycle= 6 E= -1.50419738268348  delta_E= -7.33e-09  |g|= 1.69e-05  |ddm|= 0.000508
  HOMO = -0.0152505431492168  LUMO = 0.119999084389189
cycle= 7 E= -1.50419738308278  delta_E= -3.99e-10  |g|= 1.38e-06  |ddm|= 0.000151
  HOMO = -0.015250067417667  LUMO = 0.119999468437048
Extra cycle  E= -1.5041973830851  delta_E= -2.33e-12  |g|= 4.54e-07  |ddm|= 6.76e-06
converged SCF energy = -1.5041973830851

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpcrduaoro
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -0.887725184894663  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -0.915607155930627  dE = -2.78819710e-02  S^2 = 0.7500000
               |grad[o]|=0.152  |ddm|=4.55e-16  |maxRot[o]|=0.188
macro iter   2 (  3 JK    1 micro), CASSCF E = -0.915716399189538  dE = -1.09243259e-04  S^2 = 0.7500000
               |grad[o]|=0.00995  |ddm|=1.12e-15  |maxRot[o]|=0.0105
macro iter   3 (  1 JK    1 micro), CASSCF E = -0.915716399189538  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=1.75e-05  |ddm|=4.2e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.915716399189538
CASCI E = -0.915716399189538  E(CI) = -2.63350667559414  S^2 = 0.7500000
CASCI state-averaged energy = -0.915716399189538
CASCI energy for each state
  State 0 weight 0.125  E = -1.50598965741877 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.49261544419743 S^2 = 0.7500000
  State 2 weight 0.125  E = -0.97486875575243 S^2 = 0.7500000
  State 3 weight 0.125  E = -0.973854515819317 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.911599575053956 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.857314353304427 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.310365461867689 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.29912343010229 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpcrduaoro
max_memory 40000 MB (current use 120 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.07431412336659  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -1.13280393326560  dE = -5.84898099e-02  S^2 = 3.7500000
               |grad[o]|=0.201  |ddm|=    0  |maxRot[o]|=0.257
macro iter   2 (  5 JK    2 micro), CASSCF E = -1.13283281033781  dE = -2.88770722e-05  S^2 = 3.7500000
               |grad[o]|=0.00629  |ddm|=    0  |maxRot[o]|=0.00346
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.13283281033781  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=9.62e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 24 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.13283281033781
CASCI E = -1.13283281033781  E(CI) = -2.85062308674241  S^2 = 3.7500000
CASCI state-averaged energy = -1.13283281033781
CASCI energy for each state
  State 0 weight 1  E = -1.13283281033781 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:45 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.866025403784   0.500000000000 AA    0.000000000000   1.636550830068   0.944863062283 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr   0.0

nuclear repulsion = 1.58753163276
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        67.56


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpic6rbq3f
max_memory 40000 MB (current use 120 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.30593623663247

WARN: HOMO 0.0613483888764395 >= LUMO 0.0613483888764405

cycle= 1 E= -1.49216638801529  delta_E= -0.186  |g|= 0.131  |ddm|= 3.03
  HOMO = -0.0432672578225341  LUMO = 0.0794244792145179
cycle= 2 E= -1.50218162767324  delta_E= -0.01  |g|= 0.0147  |ddm|= 0.497
  HOMO = -0.0230200392064976  LUMO = 0.100062882337891
cycle= 3 E= -1.50242644833409  delta_E= -0.000245  |g|= 0.00473  |ddm|= 0.0636
  HOMO = -0.0222584772866319  LUMO = 0.100662016677289
cycle= 4 E= -1.50252184001018  delta_E= -9.54e-05  |g|= 0.00272  |ddm|= 0.065
  HOMO = -0.0225318128922287  LUMO = 0.100749356982888
cycle= 5 E= -1.50263467649308  delta_E= -0.000113  |g|= 0.00249  |ddm|= 0.104
  HOMO = -0.0224992719692116  LUMO = 0.100788237611623
cycle= 6 E= -1.5027109471335  delta_E= -7.63e-05  |g|= 0.00237  |ddm|= 0.0747
  HOMO = -0.0263976942815012  LUMO = 0.10436967500373
cycle= 7 E= -1.50306826208556  delta_E= -0.000357  |g|= 0.00527  |ddm|= 0.684
  HOMO = -0.0245084947048292  LUMO = 0.102705208173709
cycle= 8 E= -1.50308059732277  delta_E= -1.23e-05  |g|= 0.00285  |ddm|= 0.125
  HOMO = -0.020094878909395  LUMO = 0.098812390742324
cycle= 9 E= -1.50307935011546  delta_E= 1.25e-06  |g|= 0.00268  |ddm|= 0.035
  HOMO = -0.0232528147447906  LUMO = 0.1015980451261
cycle= 10 E= -1.50310897521753  delta_E= -2.96e-05  |g|= 0.0012  |ddm|= 0.183
  HOMO = -0.0239001806719292  LUMO = 0.102218329942158
cycle= 11 E= -1.50309882374864  delta_E= 1.02e-05  |g|= 0.00209  |ddm|= 0.0635
  HOMO = -0.0215502396154514  LUMO = 0.100158524172056
cycle= 12 E= -1.50310914282217  delta_E= -1.03e-05  |g|= 0.00105  |ddm|= 0.116
  HOMO = -0.0221300911373234  LUMO = 0.100625615645443
cycle= 13 E= -1.50311146713778  delta_E= -2.32e-06  |g|= 0.000321  |ddm|= 0.0156
  HOMO = -0.0223676987600927  LUMO = 0.100834162467409
cycle= 14 E= -1.5031118629917  delta_E= -3.96e-07  |g|= 7.9e-06  |ddm|= 0.0167
  HOMO = -0.0223734813181745  LUMO = 0.100836996688645
cycle= 15 E= -1.50311186314615  delta_E= -1.54e-10  |g|= 2.37e-06  |ddm|= 0.000264
  HOMO = -0.0223716301812948  LUMO = 0.100835928409413
Extra cycle  E= -1.50311186315538  delta_E= -9.23e-12  |g|= 9.66e-07  |ddm|= 1.19e-05
converged SCF energy = -1.50311186315538

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpic6rbq3f
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -0.952503468427197  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    3 micro), CASSCF E = -0.975617828988935  dE = -2.31143606e-02  S^2 = 0.7500000
               |grad[o]|=0.139  |ddm|=4.01e-16  |maxRot[o]|=0.171
macro iter   2 (  3 JK    1 micro), CASSCF E = -0.975682937320158  dE = -6.51083312e-05  S^2 = 0.7500000
               |grad[o]|=0.00767  |ddm|=2.99e-16  |maxRot[o]|=0.00824
macro iter   3 (  1 JK    1 micro), CASSCF E = -0.975682937320158  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=1.31e-05  |ddm|=6.68e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -0.975682937320158
CASCI E = -0.975682937320158  E(CI) = -2.56321457008016  S^2 = 0.7500000
CASCI state-averaged energy = -0.975682937320158
CASCI energy for each state
  State 0 weight 0.125  E = -1.50956352937047 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.50956335047021 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.02774038030463 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.02773789839471 S^2 = 0.7500000
  State 4 weight 0.125  E = -0.966708016695518 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.910237033193974 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.426957396948897 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.426955893182855 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpic6rbq3f
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.14340998781138  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -1.19702372560775  dE = -5.36137378e-02  S^2 = 3.7500000
               |grad[o]|=0.191  |ddm|=    0  |maxRot[o]|=0.253
macro iter   2 (  5 JK    2 micro), CASSCF E = -1.19712512655021  dE = -1.01400942e-04  S^2 = 3.7500000
               |grad[o]|=0.00997  |ddm|=    0  |maxRot[o]|=0.00816
macro iter   3 (  3 JK    1 micro), CASSCF E = -1.19712512735290  dE = -8.02685474e-10  S^2 = 3.7500000
               |grad[o]|=2.92e-05  |ddm|=    0  |maxRot[o]|=2.04e-05
1-step CASSCF converged in   3 macro ( 26 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19712512735290
CASCI E = -1.19712512735290  E(CI) = -2.78465676011290  S^2 = 3.7500000
CASCI state-averaged energy = -1.1971251273529
CASCI energy for each state
  State 0 weight 1  E = -1.1971251273529 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:47 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.908295106229   0.550000000000 AA    0.000000000000   1.716428991056   1.039349368511 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.100000000000 AA    0.000000000000   0.000000000000   2.078698737022 Bohr   0.0

nuclear repulsion = 1.47778945857866
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        73.66


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp82nmwe1m
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.26047526126428
  HOMO = 0.0378871555339983  LUMO = 0.0531129232657591
cycle= 1 E= -1.50025399084901  delta_E= -0.24  |g|= 0.118  |ddm|=  2.4
  HOMO = -0.0591114736842794  LUMO = 0.0750411087709053
cycle= 2 E= -1.508465667492  delta_E= -0.00821  |g|= 0.0111  |ddm|= 0.404
  HOMO = -0.0394396744510693  LUMO = 0.0943856772670117
cycle= 3 E= -1.5085628481209  delta_E= -9.72e-05  |g|= 0.00215  |ddm|= 0.0403
  HOMO = -0.0389231831450813  LUMO = 0.0948313691090327
cycle= 4 E= -1.50856679850608  delta_E= -3.95e-06  |g|= 0.000181  |ddm|= 0.0062
  HOMO = -0.038998621076989  LUMO = 0.094839300818525
cycle= 5 E= -1.50856682702327  delta_E= -2.85e-08  |g|= 1.85e-05  |ddm|= 0.000664
  HOMO = -0.0389804062770313  LUMO = 0.0948432909151507
cycle= 6 E= -1.50856682734858  delta_E= -3.25e-10  |g|= 2.28e-06  |ddm|= 9.47e-05
  HOMO = -0.038980209653873  LUMO = 0.0948438023394691
Extra cycle  E= -1.50856682735305  delta_E= -4.47e-12  |g|= 7.11e-07  |ddm|= 1.03e-05
converged SCF energy = -1.50856682735305

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp82nmwe1m
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.00237317987769  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -1.02204534055535  dE = -1.96721607e-02  S^2 = 0.7500000
               |grad[o]|=0.128  |ddm|=5.88e-16  |maxRot[o]|=0.157
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.02208775472381  dE = -4.24141685e-05  S^2 = 0.7500000
               |grad[o]|=0.00616  |ddm|=6.09e-16  |maxRot[o]|=0.00672
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.02208775472381  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=9.55e-06  |ddm|=5.2e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.02208775472381
CASCI E = -1.02208775472381  E(CI) = -2.49987721330247  S^2 = 0.7500000
CASCI state-averaged energy = -1.02208775472381
CASCI energy for each state
  State 0 weight 0.125  E = -1.52041519707249 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.50738465152643 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.07344075525435 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.06752687481538 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.00351969871536 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.951527203822975 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.531047870199604 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.521839786383906 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp82nmwe1m
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.19753027647346  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -1.24783784784890  dE = -5.03075714e-02  S^2 = 3.7500000
               |grad[o]|=0.185  |ddm|=    0  |maxRot[o]|=0.241
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.24791006563156  dE = -7.22177827e-05  S^2 = 3.7500000
               |grad[o]|=0.0086  |ddm|=    0  |maxRot[o]|=0.00695
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.24791006563156  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.9e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 22 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.24791006563156
CASCI E = -1.24791006563156  E(CI) = -2.72569952421022  S^2 = 3.7500000
CASCI state-averaged energy = -1.24791006563156
CASCI energy for each state
  State 0 weight 1  E = -1.24791006563156 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:48 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.948683298051   0.600000000000 AA    0.000000000000   1.792751612265   1.133835674739 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.200000000000 AA    0.000000000000   0.000000000000   2.267671349478 Bohr   0.0

nuclear repulsion = 1.38383806631488
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        78.78


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpfhwnvec1
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.21964687833255
  HOMO = 0.01526199253561  LUMO = 0.044968281734833
cycle= 1 E= -1.5037645586153  delta_E= -0.284  |g|= 0.109  |ddm|= 1.96
  HOMO = -0.0735103028540861  LUMO = 0.0702974636925508
cycle= 2 E= -1.51100008602772  delta_E= -0.00724  |g|= 0.0104  |ddm|= 0.331
  HOMO = -0.0555548523934723  LUMO = 0.0883544961839095
cycle= 3 E= -1.51109845437675  delta_E= -9.84e-05  |g|= 0.00221  |ddm|= 0.0383
  HOMO = -0.0549104079785899  LUMO = 0.0888283441665363
cycle= 4 E= -1.51110313022127  delta_E= -4.68e-06  |g|= 0.00018  |ddm|= 0.007
  HOMO = -0.0550078301127288  LUMO = 0.088833966434572
cycle= 5 E= -1.51110315843199  delta_E= -2.82e-08  |g|= 2.12e-05  |ddm|= 0.000599
  HOMO = -0.0549891183233821  LUMO = 0.0888379969525901
cycle= 6 E= -1.51110315884662  delta_E= -4.15e-10  |g|= 1.84e-06  |ddm|= 9.16e-05
  HOMO = -0.0549888371239965  LUMO = 0.0888383206927052
Extra cycle  E= -1.51110315884936  delta_E= -2.74e-12  |g|= 5.31e-07  |ddm|= 6.56e-06
converged SCF energy = -1.51110315884936

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpfhwnvec1
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.04177017521185  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -1.05840312114357  dE = -1.66329459e-02  S^2 = 0.7500000
               |grad[o]|=0.118  |ddm|=1.64e-16  |maxRot[o]|=0.144
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.05843238051507  dE = -2.92593715e-05  S^2 = 0.7500000
               |grad[o]|=0.00513  |ddm|=3.22e-16  |maxRot[o]|=0.00536
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.05843238051507  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=8.05e-06  |ddm|=7.24e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.05843238051507
CASCI E = -1.05843238051507  E(CI) = -2.44227044682995  S^2 = 0.7500000
CASCI state-averaged energy = -1.05843238051507
CASCI energy for each state
  State 0 weight 0.125  E = -1.52711363488207 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.50220752580789 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.11153550054589 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.09754846955422 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.028300160059 S^2 = 0.7500000
  State 5 weight 0.125  E = -0.984408295932071 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.616456143027013 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.599889314312424 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpfhwnvec1
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.24185808255823  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -1.28850921186856  dE = -4.66511293e-02  S^2 = 3.7500000
               |grad[o]|=0.177  |ddm|=    0  |maxRot[o]|=0.233
macro iter   2 (  5 JK    2 micro), CASSCF E = -1.28855746313195  dE = -4.82512634e-05  S^2 = 3.7500000
               |grad[o]|=0.00696  |ddm|=    0  |maxRot[o]|=0.00512
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.28855746313195  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.35e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 23 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.28855746313195
CASCI E = -1.28855746313195  E(CI) = -2.67239552944683  S^2 = 3.7500000
CASCI state-averaged energy = -1.28855746313195
CASCI energy for each state
  State 0 weight 1  E = -1.28855746313195 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:49 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.987420882907   0.650000000000 AA    0.000000000000   1.865955038370   1.228321980967 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.300000000000 AA    0.000000000000   0.000000000000   2.456643961935 Bohr   0.0

nuclear repulsion = 1.302331843218
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        84.45


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp6z1m50pz
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.18383339130806
  HOMO = -0.006077868488508  LUMO = 0.0368551530847052
cycle= 1 E= -1.50397177961168  delta_E= -0.32  |g|= 0.101  |ddm|= 1.64
  HOMO = -0.0870335002221142  LUMO = 0.0651954889796834
cycle= 2 E= -1.51045283401387  delta_E= -0.00648  |g|= 0.00997  |ddm|= 0.276
  HOMO = -0.0707972678487619  LUMO = 0.0820859535214466
cycle= 3 E= -1.5105528575575  delta_E= -0.0001  |g|= 0.00223  |ddm|= 0.0355
  HOMO = -0.0700659418288879  LUMO = 0.0825511850335363
cycle= 4 E= -1.51055797139708  delta_E= -5.11e-06  |g|= 0.000172  |ddm|= 0.00702
  HOMO = -0.0701871166533793  LUMO = 0.0825536286880134
cycle= 5 E= -1.51055799635253  delta_E= -2.5e-08  |g|= 2.19e-05  |ddm|= 0.000487
  HOMO = -0.0701716299489448  LUMO = 0.0825568851798297
cycle= 6 E= -1.51055799674994  delta_E= -3.97e-10  |g|= 1.27e-06  |ddm|= 7.46e-05
  HOMO = -0.0701715320583775  LUMO = 0.0825570170218196
Extra cycle  E= -1.51055799675115  delta_E= -1.22e-12  |g|= 3.33e-07  |ddm|= 3.55e-06
converged SCF energy = -1.51055799675115

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp6z1m50pz
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.07298403355116  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 11 JK    3 micro), CASSCF E = -1.08712522753897  dE = -1.41411940e-02  S^2 = 0.7500000
               |grad[o]|=0.109  |ddm|=2.35e-16  |maxRot[o]|=0.132
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.08714401310401  dE = -1.87855650e-05  S^2 = 0.7500000
               |grad[o]|=0.00407  |ddm|=3.42e-16  |maxRot[o]|=0.00438
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.08714401310401  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=6.31e-06  |ddm|=2.34e-17  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 15 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.08714401310401
CASCI E = -1.08714401310401  E(CI) = -2.38947585632201  S^2 = 0.7500000
CASCI state-averaged energy = -1.08714401310401
CASCI energy for each state
  State 0 weight 0.125  E = -1.53086525837568 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.49577786209814 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.14228521016849 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.1201158326381 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.04545960289993 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.010982052993 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.686986724479129 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.664679561179613 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp6z1m50pz
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.27786214951051  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -1.32141639248065  dE = -4.35542430e-02  S^2 = 3.7500000
               |grad[o]|=0.171  |ddm|=    0  |maxRot[o]|=0.225
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.32145140842030  dE = -3.50159397e-05  S^2 = 3.7500000
               |grad[o]|=0.00598  |ddm|=    0  |maxRot[o]|=0.00435
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.32145140842030  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.57e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 21 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.32145140842030
CASCI E = -1.32145140842030  E(CI) = -2.62378325163830  S^2 = 3.7500000
CASCI state-averaged energy = -1.3214514084203
CASCI energy for each state
  State 0 weight 1  E = -1.3214514084203 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:51 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.024695076596   0.700000000000 AA    0.000000000000   1.936393055957   1.322808287196 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.400000000000 AA    0.000000000000   0.000000000000   2.645616574391 Bohr   0.0

nuclear repulsion = 1.23083001928219
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        89.81


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpsemrhbe3
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.1528879085895
  HOMO = -0.0258583549520889  LUMO = 0.0287395309408357
cycle= 1 E= -1.501721601455  delta_E= -0.349  |g|= 0.0946  |ddm|= 1.41
  HOMO = -0.099622567328335  LUMO = 0.059746575670141
cycle= 2 E= -1.50760718904663  delta_E= -0.00589  |g|= 0.00968  |ddm|= 0.234
  HOMO = -0.0850236302846201  LUMO = 0.0755941335067937
cycle= 3 E= -1.50770809368432  delta_E= -0.000101  |g|= 0.0022  |ddm|= 0.0328
  HOMO = -0.0842376460272373  LUMO = 0.0760282012641643
cycle= 4 E= -1.50771333998606  delta_E= -5.25e-06  |g|= 0.000167  |ddm|= 0.00665
  HOMO = -0.0843769024103913  LUMO = 0.0760305813840865
cycle= 5 E= -1.50771336353631  delta_E= -2.36e-08  |g|= 2.07e-05  |ddm|= 0.000423
  HOMO = -0.0843654602165767  LUMO = 0.0760330459172345
cycle= 6 E= -1.50771336384469  delta_E= -3.08e-10  |g|= 8.68e-07  |ddm|= 5.41e-05
  HOMO = -0.0843655755412798  LUMO = 0.0760330473629942
Extra cycle  E= -1.50771336384516  delta_E= -4.78e-13  |g|= 1.91e-07  |ddm|= 1.63e-06
converged SCF energy = -1.50771336384516

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpsemrhbe3
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.09785965851287  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 11 JK    3 micro), CASSCF E = -1.10994502760811  dE = -1.20853691e-02  S^2 = 0.7500000
               |grad[o]|=0.101  |ddm|=3.25e-16  |maxRot[o]|=0.121
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.10995855506809  dE = -1.35274600e-05  S^2 = 0.7500000
               |grad[o]|=0.00346  |ddm|=7.14e-17  |maxRot[o]|=0.00353
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.10995855506809  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=6.94e-06  |ddm|=3.24e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 15 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.10995855506809
CASCI E = -1.10995855506809  E(CI) = -2.34078857435028  S^2 = 0.7500000
CASCI state-averaged energy = -1.10995855506809
CASCI energy for each state
  State 0 weight 0.125  E = -1.53246640577839 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.48919799441074 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.16635349923665 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.13690725501053 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.05764028798168 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.03267455605961 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.745537311059778 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.718891131007355 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpsemrhbe3
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.30735171437231  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -1.34830171317460  dE = -4.09499988e-02  S^2 = 3.7500000
               |grad[o]|=0.166  |ddm|=    0  |maxRot[o]|=0.217
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.34832854798881  dE = -2.68348142e-05  S^2 = 3.7500000
               |grad[o]|=0.00526  |ddm|=    0  |maxRot[o]|=0.00375
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.34832854798881  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.01e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 21 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.34832854798881
CASCI E = -1.34832854798881  E(CI) = -2.57915856727100  S^2 = 3.7500000
CASCI state-averaged energy = -1.34832854798881
CASCI energy for each state
  State 0 weight 1  E = -1.34832854798881 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:52 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.060660171780   0.750000000000 AA    0.000000000000   2.004357235898   1.417294593424 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.500000000000 AA    0.000000000000   0.000000000000   2.834589186848 Bohr   0.0

nuclear repulsion = 1.16750642107647
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        95.10


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp72eltl38
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.12640466737354
  HOMO = -0.0439479945324684  LUMO = 0.0206065711987492
cycle= 1 E= -1.49760812097565  delta_E= -0.371  |g|= 0.0893  |ddm|= 1.24
  HOMO = -0.111260174621274  LUMO = 0.053986684942016
cycle= 2 E= -1.50301062219111  delta_E= -0.0054  |g|= 0.00949  |ddm|= 0.201
  HOMO = -0.0981765289788168  LUMO = 0.0688992943663272
cycle= 3 E= -1.50311147473691  delta_E= -0.000101  |g|= 0.00214  |ddm|= 0.0303
  HOMO = -0.0973580664728185  LUMO = 0.0692909889762852
cycle= 4 E= -1.50311662727236  delta_E= -5.15e-06  |g|= 0.000171  |ddm|= 0.00616
  HOMO = -0.0975081394121681  LUMO = 0.0692962269201576
cycle= 5 E= -1.50311665211836  delta_E= -2.48e-08  |g|= 1.88e-05  |ddm|= 0.000404
  HOMO = -0.0974998713174823  LUMO = 0.0692982837985043
cycle= 6 E= -1.50311665234439  delta_E= -2.26e-10  |g|= 6.71e-07  |ddm|= 3.89e-05
  HOMO = -0.0975001303391294  LUMO = 0.069298219931275
Extra cycle  E= -1.50311665234461  delta_E= -2.26e-13  |g|= 1.23e-07  |ddm|= 6.53e-07
converged SCF energy = -1.50311665234461

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp72eltl38
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.11776059647706  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -1.12814560961361  dE = -1.03850131e-02  S^2 = 0.7500000
               |grad[o]|=0.094  |ddm|=3.18e-16  |maxRot[o]|= 0.11
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.12815323828635  dE = -7.62867274e-06  S^2 = 0.7500000
               |grad[o]|=0.00254  |ddm|=3.26e-16  |maxRot[o]|=0.00281
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.12815323828635  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=3.57e-06  |ddm|=2.25e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.12815323828635
CASCI E = -1.12815323828635  E(CI) = -2.29565965936283  S^2 = 0.7500000
CASCI state-averaged energy = -1.12815323828635
CASCI energy for each state
  State 0 weight 0.125  E = -1.53247501140858 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.48315226954159 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.18454299021522 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.14917942412793 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.06647544861149 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.05049221599299 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.794337725318714 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.764570821074318 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp72eltl38
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.33169993909639  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 16 JK    4 micro), CASSCF E = -1.37046124910916  dE = -3.87613100e-02  S^2 = 3.7500000
               |grad[o]|=0.161  |ddm|=    0  |maxRot[o]|= 0.21
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.37047864989240  dE = -1.74007832e-05  S^2 = 3.7500000
               |grad[o]|=0.00416  |ddm|=    0  |maxRot[o]|=0.00275
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.37047864989240  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.84e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 20 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.37047864989240
CASCI E = -1.37047864989240  E(CI) = -2.53798507096888  S^2 = 3.7500000
CASCI state-averaged energy = -1.3704786498924
CASCI energy for each state
  State 0 weight 1  E = -1.3704786498924 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:54 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.095445115010   0.800000000000 AA    0.000000000000   2.070091251862   1.511780899652 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.600000000000 AA    0.000000000000   0.000000000000   3.023561799304 Bohr   0.0

nuclear repulsion = 1.11096498813137
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        99.96


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpszb35lev
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.10387576696962
  HOMO = -0.0603200636867034  LUMO = 0.0124559269202515
cycle= 1 E= -1.49207226218457  delta_E= -0.388  |g|= 0.0849  |ddm|= 1.12
  HOMO = -0.121953844683791  LUMO = 0.0479625378711084
cycle= 2 E= -1.49707089387121  delta_E= -0.005  |g|= 0.00937  |ddm|= 0.177
  HOMO = -0.110251394058784  LUMO = 0.0620262935673472
cycle= 3 E= -1.49717095954733  delta_E= -0.0001  |g|= 0.00208  |ddm|= 0.0282
  HOMO = -0.109414539374182  LUMO = 0.062371563099076
cycle= 4 E= -1.4971758806904  delta_E= -4.92e-06  |g|= 0.000179  |ddm|= 0.00567
  HOMO = -0.109569059212891  LUMO = 0.0623813403534654
cycle= 5 E= -1.49717590856187  delta_E= -2.79e-08  |g|= 1.72e-05  |ddm|= 0.000408
  HOMO = -0.109562922153457  LUMO = 0.0623833095257536
cycle= 6 E= -1.49717590873521  delta_E= -1.73e-10  |g|= 6.09e-07  |ddm|= 3.02e-05
  HOMO = -0.109563242109918  LUMO = 0.0623832280476265
Extra cycle  E= -1.49717590873539  delta_E= -1.77e-13  |g|= 1.12e-07  |ddm|= 6.23e-07
converged SCF energy = -1.49717590873539

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpszb35lev
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.13371735297049  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 10 JK    3 micro), CASSCF E = -1.14268778611271  dE = -8.97043314e-03  S^2 = 0.7500000
               |grad[o]|=0.0876  |ddm|=2.61e-16  |maxRot[o]|=0.0998
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.14269412231059  dE = -6.33619788e-06  S^2 = 0.7500000
               |grad[o]|=0.00234  |ddm|=1.03e-16  |maxRot[o]|=0.00225
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.14269412231059  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=8.04e-06  |ddm|=3.17e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 14 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.14269412231059
CASCI E = -1.14269412231059  E(CI) = -2.25365911044197  S^2 = 0.7500000
CASCI state-averaged energy = -1.14269412231059
CASCI energy for each state
  State 0 weight 0.125  E = -1.53129891564932 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47802187084222 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.19766319989563 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.15790666620891 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.07304397515259 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.0651936132218 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.835129040213484 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.803295697300801 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpszb35lev
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.35195942855058  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 16 JK    4 micro), CASSCF E = -1.38886158847349  dE = -3.69021599e-02  S^2 = 3.7500000
               |grad[o]|=0.157  |ddm|=    0  |maxRot[o]|=0.202
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.38887524846852  dE = -1.36599950e-05  S^2 = 3.7500000
               |grad[o]|=0.00373  |ddm|=    0  |maxRot[o]|=0.00245
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.38887524846852  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.32e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 20 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.38887524846852
CASCI E = -1.38887524846852  E(CI) = -2.49984023659990  S^2 = 3.7500000
CASCI state-averaged energy = -1.38887524846852
CASCI energy for each state
  State 0 weight 1  E = -1.38887524846852 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:55 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.129158979064   0.850000000000 AA    0.000000000000   2.133801221524   1.606267205880 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.700000000000 AA    0.000000000000   0.000000000000   3.212534411761 Bohr   0.0

nuclear repulsion = 1.06011847083565
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       105.29


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpofrfem0b
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.08477852102995
  HOMO = -0.0750191634505201  LUMO = 0.00429864349122726
cycle= 1 E= -1.48545822705469  delta_E= -0.401  |g|= 0.081  |ddm|= 1.02
  HOMO = -0.131723547511419  LUMO = 0.0417276859730085
cycle= 2 E= -1.49010947517038  delta_E= -0.00465  |g|= 0.00929  |ddm|= 0.157
  HOMO = -0.121269863152407  LUMO = 0.055008171610504
cycle= 3 E= -1.49020825934289  delta_E= -9.88e-05  |g|= 0.002  |ddm|= 0.0265
  HOMO = -0.120423461989661  LUMO = 0.0553065484493254
cycle= 4 E= -1.49021287944845  delta_E= -4.62e-06  |g|= 0.000189  |ddm|= 0.00524
  HOMO = -0.12057776338521  LUMO = 0.055321495178139
cycle= 5 E= -1.4902129106685  delta_E= -3.12e-08  |g|= 1.6e-05  |ddm|= 0.000418
  HOMO = -0.120573043669783  LUMO = 0.0553235170018102
cycle= 6 E= -1.49021291081116  delta_E= -1.43e-10  |g|= 5.9e-07  |ddm|= 2.57e-05
  HOMO = -0.120573358779808  LUMO = 0.0553234456791152
Extra cycle  E= -1.49021291081134  delta_E= -1.83e-13  |g|= 1.16e-07  |ddm|= 7.95e-07
converged SCF energy = -1.49021291081134

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpofrfem0b
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.14652606653874  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.15432550991306  dE = -7.79944337e-03  S^2 = 0.7500000
               |grad[o]|=0.0818  |ddm|=4.11e-16  |maxRot[o]|=0.0889
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.15432939185449  dE = -3.88194142e-06  S^2 = 0.7500000
               |grad[o]|=0.00181  |ddm|=3.15e-16  |maxRot[o]|=0.00166
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.15432939185449  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=1.89e-06  |ddm|=3.18e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.15432939185449
CASCI E = -1.15432939185449  E(CI) = -2.21444786269014  S^2 = 0.7500000
CASCI state-averaged energy = -1.15432939185449
CASCI energy for each state
  State 0 weight 0.125  E = -1.52925091867971 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47396766301746 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.20649982012368 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16386048029392 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.07809647470111 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.07737060357629 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.869288462432962 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.836300712010767 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpofrfem0b
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.36894456308362  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    3 micro), CASSCF E = -1.40425336185311  dE = -3.53087988e-02  S^2 = 3.7500000
               |grad[o]|=0.154  |ddm|=    0  |maxRot[o]|=0.193
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.40426452365998  dE = -1.11618069e-05  S^2 = 3.7500000
               |grad[o]|=0.00302  |ddm|=    0  |maxRot[o]|=0.00316
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.40426452365998  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=4.29e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.40426452365998
CASCI E = -1.40426452365998  E(CI) = -2.46438299449563  S^2 = 3.7500000
CASCI state-averaged energy = -1.40426452365998
CASCI energy for each state
  State 0 weight 1  E = -1.40426452365998 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:56 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.161895003862   0.900000000000 AA    0.000000000000   2.195663342800   1.700753512109 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.800000000000 AA    0.000000000000   0.000000000000   3.401507024217 Bohr   0.0

nuclear repulsion = 1.01410631176842
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       110.22


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp7pzb6nw3
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.06862069591233
  HOMO = -0.0881346537540422  LUMO = -0.00384507044002571
cycle= 1 E= -1.47804389816951  delta_E= -0.409  |g|= 0.0776  |ddm|= 0.952
  HOMO = -0.140597206015416  LUMO = 0.0353397970335897
cycle= 2 E= -1.48238931152533  delta_E= -0.00435  |g|= 0.00924  |ddm|= 0.142
  HOMO = -0.131266185992114  LUMO = 0.047887150176528
cycle= 3 E= -1.48248651089517  delta_E= -9.72e-05  |g|= 0.00193  |ddm|= 0.025
  HOMO = -0.130416018906201  LUMO = 0.0481395126714202
cycle= 4 E= -1.48249080499289  delta_E= -4.29e-06  |g|= 0.000196  |ddm|= 0.00486
  HOMO = -0.130567155163016  LUMO = 0.0481596000172552
cycle= 5 E= -1.4824908388067  delta_E= -3.38e-08  |g|= 1.51e-05  |ddm|= 0.000425
  HOMO = -0.130563439502944  LUMO = 0.048161688649994
cycle= 6 E= -1.48249083893039  delta_E= -1.24e-10  |g|= 5.72e-07  |ddm|= 2.32e-05
  HOMO = -0.130563707677445  LUMO = 0.0481616403023269
Extra cycle  E= -1.48249083893058  delta_E= -1.84e-13  |g|= 1.15e-07  |ddm|= 8.46e-07
converged SCF energy = -1.48249083893058

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp7pzb6nw3
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.15681164687133  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.16364334122698  dE = -6.83169436e-03  S^2 = 0.7500000
               |grad[o]|=0.0767  |ddm|=4.05e-16  |maxRot[o]|=0.0759
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.16364633114233  dE = -2.98991535e-06  S^2 = 0.7500000
               |grad[o]|=0.00159  |ddm|=4.07e-16  |maxRot[o]|=0.00138
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.16364633114233  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=3e-06  |ddm|=2.5e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.16364633114233
CASCI E = -1.16364633114233  E(CI) = -2.17775264291075  S^2 = 0.7500000
CASCI state-averaged energy = -1.16364633114233
CASCI energy for each state
  State 0 weight 0.125  E = -1.52657774806904 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47098293742146 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.21180763941564 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16765485535622 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.08750397130028 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.08216140075293 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.897920809262537 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.864561287560533 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp7pzb6nw3
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.38329031197564  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -1.41721774311918  dE = -3.39274311e-02  S^2 = 3.7500000
               |grad[o]|=0.151  |ddm|=    0  |maxRot[o]|=0.174
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.41722581960297  dE = -8.07648379e-06  S^2 = 3.7500000
               |grad[o]|=0.0029  |ddm|=    0  |maxRot[o]|=0.00177
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.41722581960297  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.61e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.41722581960297
CASCI E = -1.41722581960297  E(CI) = -2.43133213137139  S^2 = 3.7500000
CASCI state-averaged energy = -1.41722581960297
CASCI energy for each state
  State 0 weight 1  E = -1.41722581960297 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:58 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.193733638631   0.950000000000 AA    0.000000000000   2.255829642694   1.795239818337 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr   0.0

nuclear repulsion = 0.972237625484207
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       115.49


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp4p6uhl1d
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.05496044024044
  HOMO = -0.09978071773168  LUMO = -0.0119480015993864
cycle= 1 E= -1.47005540096077  delta_E= -0.415  |g|= 0.0744  |ddm|= 0.898
  HOMO = -0.148612318914568  LUMO = 0.0288558797478352
cycle= 2 E= -1.47412715050117  delta_E= -0.00407  |g|= 0.00921  |ddm|= 0.13
  HOMO = -0.140284845551113  LUMO = 0.0407105730164361
cycle= 3 E= -1.47422260072933  delta_E= -9.55e-05  |g|= 0.00186  |ddm|= 0.0238
  HOMO = -0.139434791113361  LUMO = 0.0409180425744869
cycle= 4 E= -1.47422657062076  delta_E= -3.97e-06  |g|= 0.0002  |ddm|= 0.00454
  HOMO = -0.139581218433645  LUMO = 0.0409428850517307
cycle= 5 E= -1.47422660580242  delta_E= -3.52e-08  |g|= 1.43e-05  |ddm|= 0.000428
  HOMO = -0.139578270045767  LUMO = 0.0409449987373769
cycle= 6 E= -1.47422660591268  delta_E= -1.1e-10  |g|= 5.5e-07  |ddm|= 2.15e-05
  HOMO = -0.139578470328354  LUMO = 0.0409449771349484
Extra cycle  E= -1.47422660591286  delta_E= -1.74e-13  |g|= 1.11e-07  |ddm|= 8.16e-07
converged SCF energy = -1.47422660591286

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp4p6uhl1d
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.16506731399392  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.17110425418445  dE = -6.03694019e-03  S^2 = 0.7500000
               |grad[o]|=0.0721  |ddm|=1.25e-16  |maxRot[o]|=0.062
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.17110633613830  dE = -2.08195385e-06  S^2 = 0.7500000
               |grad[o]|=0.00132  |ddm|=2.72e-16  |maxRot[o]|=0.00139
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.17110633613830  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=3.45e-06  |ddm|=2.31e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.17110633613830
CASCI E = -1.17110633613830  E(CI) = -2.14334396162251  S^2 = 0.7500000
CASCI state-averaged energy = -1.1711063361383
CASCI energy for each state
  State 0 weight 0.125  E = -1.52347727761702 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46895226385544 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.21429055258029 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16977898856188 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.09596970421438 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.0856069097218 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.921918203736568 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.888856788819015 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp4p6uhl1d
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.39549373344143  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    4 micro), CASSCF E = -1.42820647899209  dE = -3.27127456e-02  S^2 = 3.7500000
               |grad[o]|=0.148  |ddm|=    0  |maxRot[o]|=0.142
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.42821251417017  dE = -6.03517808e-06  S^2 = 3.7500000
               |grad[o]|=0.00251  |ddm|=    0  |maxRot[o]|=0.00148
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.42821251417017  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.69e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.42821251417017
CASCI E = -1.42821251417017  E(CI) = -2.40045013965438  S^2 = 3.7500000
CASCI state-averaged energy = -1.42821251417017
CASCI energy for each state
  State 0 weight 1  E = -1.42821251417017 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:29:59 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.224744871392   1.000000000000 AA    0.000000000000   2.314432379396   1.889726124565 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr   0.0

nuclear repulsion = 0.933950714405011
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       120.77


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp_dsdzdy0
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.04341168165523
  HOMO = -0.110082334627162  LUMO = -0.0199784250887804
cycle= 1 E= -1.46167439585876  delta_E= -0.418  |g|= 0.0715  |ddm|= 0.857
  HOMO = -0.155818224287942  LUMO = 0.0223270748321488
cycle= 2 E= -1.46549894865716  delta_E= -0.00382  |g|= 0.00919  |ddm|= 0.12
  HOMO = -0.148382146274751  LUMO = 0.0335245764589444
cycle= 3 E= -1.46559258625248  delta_E= -9.36e-05  |g|= 0.0018  |ddm|= 0.0228
  HOMO = -0.14753466835735  LUMO = 0.0336880891171859
cycle= 4 E= -1.46559624848929  delta_E= -3.66e-06  |g|= 0.000202  |ddm|= 0.00427
  HOMO = -0.147675848904309  LUMO = 0.0337171460665873
cycle= 5 E= -1.4655962838429  delta_E= -3.54e-08  |g|= 1.36e-05  |ddm|= 0.000425
  HOMO = -0.147673519780093  LUMO = 0.0337192324124567
cycle= 6 E= -1.46559628394244  delta_E= -9.95e-11  |g|= 5.27e-07  |ddm|= 2.01e-05
  HOMO = -0.147673646474717  LUMO = 0.0337192365240266
Extra cycle  E= -1.4655962839426  delta_E= -1.62e-13  |g|= 1.06e-07  |ddm|= 7.56e-07
converged SCF energy = -1.4655962839426

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp_dsdzdy0
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.17168131955928  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.17706804862049  dE = -5.38672906e-03  S^2 = 0.7500000
               |grad[o]|=0.0682  |ddm|=1.29e-16  |maxRot[o]|=0.0714
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.17706949502653  dE = -1.44640605e-06  S^2 = 0.7500000
               |grad[o]|=0.00109  |ddm|=2.66e-16  |maxRot[o]|=0.00127
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.17706949502653  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=3.49e-06  |ddm|=3.6e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.17706949502653
CASCI E = -1.17706949502653  E(CI) = -2.11102020943154  S^2 = 0.7500000
CASCI state-averaged energy = -1.17706949502653
CASCI energy for each state
  State 0 weight 0.125  E = -1.52010781787709 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46770333961787 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.21457621511281 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.17061523041515 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.10305777358608 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.08867622147344 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.942007017083072 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.909812345046751 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp_dsdzdy0
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.40594397457307  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -1.43757589542850  dE = -3.16319209e-02  S^2 = 3.7500000
               |grad[o]|=0.146  |ddm|=    0  |maxRot[o]|=0.165
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.43758043099373  dE = -4.53556524e-06  S^2 = 3.7500000
               |grad[o]|=0.0022  |ddm|=    0  |maxRot[o]|=0.00125
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.43758043099373  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.29e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.43758043099373
CASCI E = -1.43758043099373  E(CI) = -2.37153114539874  S^2 = 3.7500000
CASCI state-averaged energy = -1.43758043099373
CASCI energy for each state
  State 0 weight 1  E = -1.43758043099373 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:01 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.254990039801   1.050000000000 AA    0.000000000000   2.371587464281   1.984212430793 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.100000000000 AA    0.000000000000   0.000000000000   3.968424861587 Bohr   0.0

nuclear repulsion = 0.898783753273069
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       126.05


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpj10s15ih
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.03364221091248
  HOMO = -0.119166225121278  LUMO = -0.0279027994131711
cycle= 1 E= -1.4530438936441  delta_E= -0.419  |g|= 0.0688  |ddm|= 0.826
  HOMO = -0.16227521101369  LUMO = 0.0157956393461143
cycle= 2 E= -1.45664420173314  delta_E= -0.0036  |g|= 0.00919  |ddm|= 0.112
  HOMO = -0.155625839126112  LUMO = 0.0263693727228025
cycle= 3 E= -1.45673603665108  delta_E= -9.18e-05  |g|= 0.00174  |ddm|= 0.022
  HOMO = -0.154782194397209  LUMO = 0.026489574473108
cycle= 4 E= -1.45673941496921  delta_E= -3.38e-06  |g|= 0.000202  |ddm|= 0.00403
  HOMO = -0.154918236107299  LUMO = 0.0265222869269376
cycle= 5 E= -1.45673944959239  delta_E= -3.46e-08  |g|= 1.3e-05  |ddm|= 0.00042
  HOMO = -0.154916422269837  LUMO = 0.0265243032875642
cycle= 6 E= -1.45673944968283  delta_E= -9.04e-11  |g|= 5.08e-07  |ddm|= 1.88e-05
  HOMO = -0.15491647885054  LUMO = 0.0265243299653055
Extra cycle  E= -1.45673944968298  delta_E= -1.51e-13  |g|= 1.02e-07  |ddm|= 6.99e-07
converged SCF energy = -1.45673944968298

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpj10s15ih
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.17695802599723  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.18181417842952  dE = -4.85615243e-03  S^2 = 0.7500000
               |grad[o]|=0.0647  |ddm|=1.64e-16  |maxRot[o]|=0.0719
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18181519675323  dE = -1.01832371e-06  S^2 = 0.7500000
               |grad[o]|=0.000916  |ddm|=2.29e-16  |maxRot[o]|=0.00105
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18181519675323  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.04e-06  |ddm|=3.42e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18181519675323
CASCI E = -1.18181519675323  E(CI) = -2.08059895002630  S^2 = 0.7500000
CASCI state-averaged energy = -1.18181519675323
CASCI energy for each state
  State 0 weight 0.125  E = -1.51659447807429 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46705114103347 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.21319773535371 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.17046042829932 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.10898414976343 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.09151714529949 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.958785228992474 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.927931267209627 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpj10s15ih
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.41494546449467  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -1.44560572606030  dE = -3.06602616e-02  S^2 = 3.7500000
               |grad[o]|=0.144  |ddm|=    0  |maxRot[o]|=0.177
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.44560916559969  dE = -3.43953938e-06  S^2 = 3.7500000
               |grad[o]|=0.00194  |ddm|=    0  |maxRot[o]|=0.00106
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.44560916559969  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=1.08e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.44560916559969
CASCI E = -1.44560916559969  E(CI) = -2.34439291887276  S^2 = 3.7500000
CASCI state-averaged energy = -1.44560916559969
CASCI energy for each state
  State 0 weight 1  E = -1.44560916559969 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:02 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.284523257867   1.100000000000 AA    0.000000000000   2.427397158002   2.078698737022 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.200000000000 AA    0.000000000000   0.000000000000   4.157397474043 Bohr   0.0

nuclear repulsion = 0.866353184856578
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       131.35


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpa23ykicu
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.02536898877527
  HOMO = -0.127155567681798  LUMO = -0.0356882254348357
cycle= 1 E= -1.44427471922649  delta_E= -0.419  |g|= 0.0664  |ddm|= 0.802
  HOMO = -0.16805055458616  LUMO = 0.00929487384398837
cycle= 2 E= -1.44767138055989  delta_E= -0.0034  |g|= 0.00919  |ddm|= 0.105
  HOMO = -0.162091490761281  LUMO = 0.0192777331970407
cycle= 3 E= -1.44776147500103  delta_E= -9.01e-05  |g|= 0.00169  |ddm|= 0.0213
  HOMO = -0.161251879785772  LUMO = 0.0193550111772095
cycle= 4 E= -1.44776459580157  delta_E= -3.12e-06  |g|= 0.000201  |ddm|= 0.00382
  HOMO = -0.161383259076458  LUMO = 0.0193908942139147
cycle= 5 E= -1.44776462915397  delta_E= -3.34e-08  |g|= 1.24e-05  |ddm|= 0.000411
  HOMO = -0.161381881137973  LUMO = 0.0193928124762061
cycle= 6 E= -1.44776462923654  delta_E= -8.26e-11  |g|= 4.95e-07  |ddm|= 1.77e-05
  HOMO = -0.16138187553907  LUMO = 0.0193928581032494
Extra cycle  E= -1.44776462923669  delta_E= -1.48e-13  |g|= 9.97e-08  |ddm|= 6.6e-07
converged SCF energy = -1.44776462923669

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpa23ykicu
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18113613833656  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.18555973515886  dE = -4.42359682e-03  S^2 = 0.7500000
               |grad[o]|=0.0618  |ddm|=3.16e-16  |maxRot[o]|=0.0684
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18556046227863  dE = -7.27119773e-07  S^2 = 0.7500000
               |grad[o]|=0.000774  |ddm|=3.93e-16  |maxRot[o]|=0.000835
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18556046227863  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=1.96e-06  |ddm|=4.3e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18556046227863
CASCI E = -1.18556046227863  E(CI) = -2.05191364713521  S^2 = 0.7500000
CASCI state-averaged energy = -1.18556046227863
CASCI energy for each state
  State 0 weight 0.125  E = -1.51303449890527 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46682564323876 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.21058951052048 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16954243488435 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.11391055100507 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.09420669648733 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.972753366469011 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.943620996718753 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpa23ykicu
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.42273694113857  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -1.45251665379880  dE = -2.97797127e-02  S^2 = 3.7500000
               |grad[o]|=0.142  |ddm|=    0  |maxRot[o]|=0.178
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.45251927988306  dE = -2.62608425e-06  S^2 = 3.7500000
               |grad[o]|=0.00171  |ddm|=    0  |maxRot[o]|=0.00089
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.45251927988306  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=8.73e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.45251927988306
CASCI E = -1.45251927988306  E(CI) = -2.31887246473963  S^2 = 3.7500000
CASCI state-averaged energy = -1.45251927988306
CASCI energy for each state
  State 0 weight 1  E = -1.45251927988306 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:03 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.313392553656   1.150000000000 AA    0.000000000000   2.481952220454   2.173185043250 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.300000000000 AA    0.000000000000   0.000000000000   4.346370086500 Bohr   0.0

nuclear repulsion = 0.836337545638693
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       136.70


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpdz03twmo
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.01835291332796
  HOMO = -0.134167201087569  LUMO = -0.0433042765446253
cycle= 1 E= -1.43545231357516  delta_E= -0.417  |g|= 0.064  |ddm|= 0.784
  HOMO = -0.173213560960289  LUMO = 0.00285093026288154
cycle= 2 E= -1.43866412952322  delta_E= -0.00321  |g|= 0.0092  |ddm|= 0.0996
  HOMO = -0.167857317997854  LUMO = 0.0122758750016115
cycle= 3 E= -1.43875258113377  delta_E= -8.85e-05  |g|= 0.00164  |ddm|= 0.0207
  HOMO = -0.167021055450668  LUMO = 0.0123104365705775
cycle= 4 E= -1.43875547095111  delta_E= -2.89e-06  |g|= 0.0002  |ddm|= 0.00364
  HOMO = -0.167148427296561  LUMO = 0.0123491348193113
cycle= 5 E= -1.43875550281594  delta_E= -3.19e-08  |g|= 1.18e-05  |ddm|= 0.000402
  HOMO = -0.167147422702254  LUMO = 0.0123509390781675
cycle= 6 E= -1.43875550289174  delta_E= -7.58e-11  |g|= 4.9e-07  |ddm|= 1.67e-05
  HOMO = -0.167147364349585  LUMO = 0.0123510005025766
Extra cycle  E= -1.43875550289189  delta_E= -1.48e-13  |g|= 1e-07  |ddm|= 6.46e-07
converged SCF energy = -1.43875550289189

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpdz03twmo
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18440422977573  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -1.18847495156943  dE = -4.07072179e-03  S^2 = 0.7500000
               |grad[o]|=0.0593  |ddm|=3.15e-16  |maxRot[o]|=0.0639
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18847548152931  dE = -5.29959877e-07  S^2 = 0.7500000
               |grad[o]|=0.000661  |ddm|=2.67e-16  |maxRot[o]|=0.000662
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18847548152931  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=1.78e-06  |ddm|=4.08e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18847548152931
CASCI E = -1.18847548152931  E(CI) = -2.02481302716800  S^2 = 0.7500000
CASCI state-averaged energy = -1.18847548152931
CASCI energy for each state
  State 0 weight 0.125  E = -1.50950264113809 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46688592954859 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.20709447759986 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16803705527128 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.11796017177259 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.09677172596391 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.984337972707406 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.957213878232752 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpdz03twmo
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.42950718637792  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -1.45848437853532  dE = -2.89771922e-02  S^2 = 3.7500000
               |grad[o]|= 0.14  |ddm|=    0  |maxRot[o]|=0.175
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.45848640521691  dE = -2.02668159e-06  S^2 = 3.7500000
               |grad[o]|=0.00152  |ddm|=    0  |maxRot[o]|=0.000747
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.45848640521691  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=7.62e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.45848640521691
CASCI E = -1.45848640521691  E(CI) = -2.29482395085560  S^2 = 3.7500000
CASCI state-averaged energy = -1.45848640521691
CASCI energy for each state
  State 0 weight 1  E = -1.45848640521691 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:05 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.341640786500   1.200000000000 AA    0.000000000000   2.535333644031   2.267671349478 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.400000000000 AA    0.000000000000   0.000000000000   4.535342698956 Bohr   0.0

nuclear repulsion = 0.80846518335
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       141.94


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpag_kox6u
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.01239367578413
  HOMO = -0.140310223412922  LUMO = -0.050724064029782
cycle= 1 E= -1.42664289608622  delta_E= -0.414  |g|= 0.0619  |ddm|= 0.771
  HOMO = -0.177831380045838  LUMO = -0.00351496737193923
cycle= 2 E= -1.42968713315568  delta_E= -0.00304  |g|= 0.00921  |ddm|= 0.095
  HOMO = -0.172999480794485  LUMO = 0.00538518304918521
cycle= 3 E= -1.42977406195977  delta_E= -8.69e-05  |g|= 0.00159  |ddm|= 0.0202
  HOMO = -0.172165193495595  LUMO = 0.00537714169402083
cycle= 4 E= -1.42977674617301  delta_E= -2.68e-06  |g|= 0.000199  |ddm|= 0.00348
  HOMO = -0.172289272443265  LUMO = 0.00541845331766216
cycle= 5 E= -1.42977677658137  delta_E= -3.04e-08  |g|= 1.13e-05  |ddm|= 0.000393
  HOMO = -0.172288592599184  LUMO = 0.00542013574766632
cycle= 6 E= -1.42977677665138  delta_E= -7e-11  |g|= 4.93e-07  |ddm|= 1.59e-05
  HOMO = -0.172288490812673  LUMO = 0.00542021071163534
Extra cycle  E= -1.42977677665154  delta_E= -1.57e-13  |g|= 1.02e-07  |ddm|= 6.56e-07
converged SCF energy = -1.42977677665154

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpag_kox6u
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18691310772894  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19069537240922  dE = -3.78226468e-03  S^2 = 0.7500000
               |grad[o]|=0.0572  |ddm|=2.68e-16  |maxRot[o]|=0.0594
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19069575929199  dE = -3.86882766e-07  S^2 = 0.7500000
               |grad[o]|=0.000566  |ddm|=3.89e-16  |maxRot[o]|=0.000521
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19069575929199  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=8.76e-07  |ddm|=2.81e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19069575929199
CASCI E = -1.19069575929199  E(CI) = -1.99916094264199  S^2 = 0.7500000
CASCI state-averaged energy = -1.19069575929199
CASCI energy for each state
  State 0 weight 0.125  E = -1.50605537821821 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.4671226187865 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.20297793325646 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.1660820523383 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12123017125374 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.09920456837997 S^2 = 0.7500000
  State 6 weight 0.125  E = -0.993909142822487 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.968984209280256 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpag_kox6u
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.43540755149109  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -1.46365082606988  dE = -2.82432746e-02  S^2 = 3.7500000
               |grad[o]|=0.139  |ddm|=    0  |maxRot[o]|= 0.17
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.46365241186252  dE = -1.58579264e-06  S^2 = 3.7500000
               |grad[o]|=0.00136  |ddm|=    0  |maxRot[o]|=0.000627
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.46365241186252  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=6.79e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.46365241186252
CASCI E = -1.46365241186252  E(CI) = -2.27211759521252  S^2 = 3.7500000
CASCI state-averaged energy = -1.46365241186252
CASCI energy for each state
  State 0 weight 1  E = -1.46365241186252 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:06 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.369306393763   1.250000000000 AA    0.000000000000   2.587614064828   2.362157655706 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.500000000000 AA    0.000000000000   0.000000000000   4.724315311413 Bohr   0.0

nuclear repulsion = 0.782504808881514
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       147.29


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpjnvav4ls
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.00732463824182
  HOMO = -0.145685268093255  LUMO = -0.0579246543343706
cycle= 1 E= -1.4178983462619  delta_E= -0.411  |g|= 0.0598  |ddm|= 0.761
  HOMO = -0.181966265487081  LUMO = -0.00978480895731178
cycle= 2 E= -1.42079087539421  delta_E= -0.00289  |g|= 0.00923  |ddm|= 0.0912
  HOMO = -0.177588842464295  LUMO = -0.00137634244643576
cycle= 3 E= -1.42087641369583  delta_E= -8.55e-05  |g|= 0.00154  |ddm|= 0.0198
  HOMO = -0.176754685131996  LUMO = -0.0014268914354619
cycle= 4 E= -1.42087891600634  delta_E= -2.5e-06  |g|= 0.000198  |ddm|= 0.00333
  HOMO = -0.176876175678169  LUMO = -0.00138301585511376
cycle= 5 E= -1.42087894516286  delta_E= -2.92e-08  |g|= 1.08e-05  |ddm|= 0.000385
  HOMO = -0.176875785123411  LUMO = -0.00138145843287153
cycle= 6 E= -1.42087894522795  delta_E= -6.51e-11  |g|= 5.04e-07  |ddm|= 1.51e-05
  HOMO = -0.176875648356231  LUMO = -0.00138137121045101
Extra cycle  E= -1.42087894522812  delta_E= -1.7e-13  |g|= 1.07e-07  |ddm|= 6.84e-07
converged SCF energy = -1.42087894522812

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpjnvav4ls
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18878500291326  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19233065359353  dE = -3.54565068e-03  S^2 = 0.7500000
               |grad[o]|=0.0555  |ddm|=3.9e-16  |maxRot[o]|=0.0551
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19233094747021  dE = -2.93876681e-07  S^2 = 0.7500000
               |grad[o]|=0.000495  |ddm|=1.33e-16  |maxRot[o]|=0.000411
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19233094747021  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=6.76e-07  |ddm|=1.86e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19233094747021
CASCI E = -1.19233094747021  E(CI) = -1.97483575635173  S^2 = 0.7500000
CASCI state-averaged energy = -1.19233094747021
CASCI energy for each state
  State 0 weight 0.125  E = -1.50273542299703 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46745608758459 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.19844193243422 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16378464142152 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12380141824823 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10147850769658 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.00178820296166 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.979161366417873 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpjnvav4ls
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.44056136786927  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    4 micro), CASSCF E = -1.46813236717709  dE = -2.75709993e-02  S^2 = 3.7500000
               |grad[o]|=0.137  |ddm|=    0  |maxRot[o]|=0.165
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.46813374544641  dE = -1.37826932e-06  S^2 = 3.7500000
               |grad[o]|=0.00121  |ddm|=    0  |maxRot[o]|=0.00074
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.46813374544641  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=4.03e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.46813374544641
CASCI E = -1.46813374544641  E(CI) = -2.25063855432793  S^2 = 3.7500000
CASCI state-averaged energy = -1.46813374544641
CASCI energy for each state
  State 0 weight 1  E = -1.46813374544641 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:08 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.396424004377   1.300000000000 AA    0.000000000000   2.638858922041   2.456643961935 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.600000000000 AA    0.000000000000   0.000000000000   4.913287923869 Bohr   0.0

nuclear repulsion = 0.758258142653925
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       152.64


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpq1hz62bg
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -1.00300766976888
  HOMO = -0.150384114636957  LUMO = -0.0648870782561056
cycle= 1 E= -1.40925970711218  delta_E= -0.406  |g|= 0.058  |ddm|= 0.754
  HOMO = -0.185674196862082  LUMO = -0.0159428273587049
cycle= 2 E= -1.41201509588411  delta_E= -0.00276  |g|= 0.00925  |ddm|= 0.088
  HOMO = -0.181689289134413  LUMO = -0.00799327535976608
cycle= 3 E= -1.41209938024835  delta_E= -8.43e-05  |g|= 0.0015  |ddm|= 0.0194
  HOMO = -0.180853163022873  LUMO = -0.00808619179245143
cycle= 4 E= -1.41210172265123  delta_E= -2.34e-06  |g|= 0.000199  |ddm|= 0.00319
  HOMO = -0.180972721243295  LUMO = -0.00803966808786473
cycle= 5 E= -1.41210175087678  delta_E= -2.82e-08  |g|= 1.04e-05  |ddm|= 0.000378
  HOMO = -0.180972597631805  LUMO = -0.00803823616348011
cycle= 6 E= -1.41210175093776  delta_E= -6.1e-11  |g|= 5.23e-07  |ddm|= 1.45e-05
  HOMO = -0.180972433149657  LUMO = -0.00803813713868088
Extra cycle  E= -1.41210175093795  delta_E= -1.91e-13  |g|= 1.13e-07  |ddm|= 7.26e-07
converged SCF energy = -1.41210175093795

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpq1hz62bg
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19012009701069  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19347076069326  dE = -3.35066368e-03  S^2 = 0.7500000
               |grad[o]|=0.054  |ddm|=3.28e-16  |maxRot[o]|=0.0508
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19347099079213  dE = -2.30098866e-07  S^2 = 0.7500000
               |grad[o]|=0.000439  |ddm|=2.43e-16  |maxRot[o]|=0.000322
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19347099079213  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=6.65e-07  |ddm|=3.15e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19347099079213
CASCI E = -1.19347099079213  E(CI) = -1.95172913344606  S^2 = 0.7500000
CASCI state-averaged energy = -1.19347099079213
CASCI energy for each state
  State 0 weight 0.125  E = -1.49957434808297 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46783097358033 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.19363846213888 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.16122927573888 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12574388154992 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10355885772549 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.00825229239385 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.987939835126733 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpq1hz62bg
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.44507066113757  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    4 micro), CASSCF E = -1.47202629725871  dE = -2.69556361e-02  S^2 = 3.7500000
               |grad[o]|=0.136  |ddm|=    0  |maxRot[o]|=0.159
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.47202731529660  dE = -1.01803790e-06  S^2 = 3.7500000
               |grad[o]|=0.00112  |ddm|=    0  |maxRot[o]|=0.000442
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.47202731529660  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.25e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.47202731529660
CASCI E = -1.47202731529660  E(CI) = -2.23028545795053  S^2 = 3.7500000
CASCI state-averaged energy = -1.4720273152966
CASCI energy for each state
  State 0 weight 1  E = -1.4720273152966 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:09 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.423024947076   1.350000000000 AA    0.000000000000   2.689127418397   2.551130268163 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.700000000000 AA    0.000000000000   0.000000000000   5.102260536326 Bohr   0.0

nuclear repulsion = 0.735554129336839
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       157.79


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpj90n8o7i
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.999328128338781
  HOMO = -0.154489547045275  LUMO = -0.0715961612117207
cycle= 1 E= -1.40075957160287  delta_E= -0.401  |g|= 0.0562  |ddm|= 0.749
  HOMO = -0.189004501078197  LUMO = -0.021975104397358
cycle= 2 E= -1.40339115547399  delta_E= -0.00263  |g|= 0.00927  |ddm|= 0.0853
  HOMO = -0.185357249009406  LUMO = -0.0144524645175476
cycle= 3 E= -1.40347432008972  delta_E= -8.32e-05  |g|= 0.00145  |ddm|= 0.0191
  HOMO = -0.184517006725032  LUMO = -0.014587508105202
cycle= 4 E= -1.40347652318972  delta_E= -2.2e-06  |g|= 0.000201  |ddm|= 0.00306
  HOMO = -0.184635220969934  LUMO = -0.0145381476656308
cycle= 5 E= -1.40347655088466  delta_E= -2.77e-08  |g|= 1.01e-05  |ddm|= 0.000374
  HOMO = -0.184635355111147  LUMO = -0.0145368396021681
cycle= 6 E= -1.40347655094228  delta_E= -5.76e-11  |g|= 5.49e-07  |ddm|= 1.39e-05
  HOMO = -0.184635168904836  LUMO = -0.0145367287061802
Extra cycle  E= -1.40347655094249  delta_E= -2.12e-13  |g|= 1.19e-07  |ddm|= 7.75e-07
converged SCF energy = -1.40347655094249

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpj90n8o7i
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19100113826721  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19419020367727  dE = -3.18906541e-03  S^2 = 0.7500000
               |grad[o]|=0.0527  |ddm|=4.64e-16  |maxRot[o]|=0.0467
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19419039034790  dE = -1.86670633e-07  S^2 = 0.7500000
               |grad[o]|=0.000397  |ddm|=3.62e-16  |maxRot[o]|=0.000282
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19419039034790  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=6.89e-07  |ddm|=2.36e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19419039034790
CASCI E = -1.19419039034790  E(CI) = -1.92974451968474  S^2 = 0.7500000
CASCI state-averaged energy = -1.1941903903479
CASCI energy for each state
  State 0 weight 0.125  E = -1.49659446090121 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46821045679314 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.18868075935752 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.15848215711229 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12712013204286 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10541121346217 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.01353754440182 S^2 = 0.7500000
  State 7 weight 0.125  E = -0.995486398712217 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpj90n8o7i
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.44902082722217  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    4 micro), CASSCF E = -1.47541371140016  dE = -2.63928842e-02  S^2 = 3.7500000
               |grad[o]|=0.135  |ddm|=    0  |maxRot[o]|=0.153
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.47541455249575  dE = -8.41095594e-07  S^2 = 3.7500000
               |grad[o]|=0.00103  |ddm|=    0  |maxRot[o]|=0.000376
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.47541455249575  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=4.86e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.47541455249575
CASCI E = -1.47541455249575  E(CI) = -2.21096868183259  S^2 = 3.7500000
CASCI state-averaged energy = -1.47541455249575
CASCI energy for each state
  State 0 weight 1  E = -1.47541455249575 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:10 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.449137674619   1.400000000000 AA    0.000000000000   2.738473321819   2.645616574391 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.800000000000 AA    0.000000000000   0.000000000000   5.291233148782 Bohr   0.0

nuclear repulsion = 0.714244341319269
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       163.05


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp9_2w8wgm
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.996190325688576
  HOMO = -0.15807547145324  LUMO = -0.0780403188574327
cycle= 1 E= -1.39242371698751  delta_E= -0.396  |g|= 0.0546  |ddm|= 0.746
  HOMO = -0.192000101612048  LUMO = -0.0278694871971697
cycle= 2 E= -1.39494365996444  delta_E= -0.00252  |g|= 0.0093  |ddm|= 0.083
  HOMO = -0.188641962605995  LUMO = -0.020742978221605
cycle= 3 E= -1.39502583100053  delta_E= -8.22e-05  |g|= 0.00141  |ddm|= 0.0189
  HOMO = -0.187795584074897  LUMO = -0.0209197567406763
cycle= 4 E= -1.39502791457301  delta_E= -2.08e-06  |g|= 0.000205  |ddm|= 0.00295
  HOMO = -0.187912967623468  LUMO = -0.0208672993873289
cycle= 5 E= -1.39502794219873  delta_E= -2.76e-08  |g|= 9.8e-06  |ddm|= 0.000372
  HOMO = -0.187913362976413  LUMO = -0.0208661110613651
cycle= 6 E= -1.39502794225365  delta_E= -5.49e-11  |g|= 5.8e-07  |ddm|= 1.35e-05
  HOMO = -0.187913159824569  LUMO = -0.0208659880586703
Extra cycle  E= -1.39502794225388  delta_E= -2.35e-13  |g|= 1.26e-07  |ddm|= 8.26e-07
converged SCF energy = -1.39502794225388

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp9_2w8wgm
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19149682634890  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19455111834239  dE = -3.05429199e-03  S^2 = 0.7500000
               |grad[o]|=0.0517  |ddm|=2.73e-16  |maxRot[o]|=0.0425
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19455127580721  dE = -1.57464813e-07  S^2 = 0.7500000
               |grad[o]|=0.000366  |ddm|=4.95e-16  |maxRot[o]|=0.000256
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19455127580721  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=6.68e-07  |ddm|=4.6e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19455127580721
CASCI E = -1.19455127580721  E(CI) = -1.90879561712648  S^2 = 0.7500000
CASCI state-averaged energy = -1.19455127580721
CASCI energy for each state
  State 0 weight 0.125  E = -1.49381016612408 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46857119835953 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.18365229184855 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.15559502446564 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12798711435018 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10700677657719 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.01784207305485 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.00194556167764 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp9_2w8wgm
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.45248394364760  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    4 micro), CASSCF E = -1.47836355902085  dE = -2.58796154e-02  S^2 = 3.7500000
               |grad[o]|=0.134  |ddm|=    0  |maxRot[o]|=0.146
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.47836427605004  dE = -7.17029188e-07  S^2 = 3.7500000
               |grad[o]|=0.000965  |ddm|=    0  |maxRot[o]|=0.00038
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.47836427605004  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=4.12e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.47836427605004
CASCI E = -1.47836427605004  E(CI) = -2.19260861736930  S^2 = 3.7500000
CASCI state-averaged energy = -1.47836427605004
CASCI energy for each state
  State 0 weight 1  E = -1.47836427605004 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:12 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.474788120375   1.450000000000 AA    0.000000000000   2.786945639271   2.740102880619 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.900000000000 AA    0.000000000000   0.000000000000   5.480205761239 Bohr   0.0

nuclear repulsion = 0.694199293333196
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       168.30


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpgdwvueq0
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.993513753709764
  HOMO = -0.161207293031826  LUMO = -0.0842113691510269
cycle= 1 E= -1.3842722882993  delta_E= -0.391  |g|= 0.0531  |ddm|= 0.745
  HOMO = -0.194698105584146  LUMO = -0.0336156104979867
cycle= 2 E= -1.38669164100447  delta_E= -0.00242  |g|= 0.00932  |ddm|= 0.0812
  HOMO = -0.191586137245183  LUMO = -0.0268560868689042
cycle= 3 E= -1.38677293179215  delta_E= -8.13e-05  |g|= 0.00136  |ddm|= 0.0187
  HOMO = -0.190731867385636  LUMO = -0.027074007067981
cycle= 4 E= -1.38677491549734  delta_E= -1.98e-06  |g|= 0.00021  |ddm|= 0.00284
  HOMO = -0.190848859137105  LUMO = -0.0270181525240903
cycle= 5 E= -1.3867749435725  delta_E= -2.81e-08  |g|= 9.56e-06  |ddm|= 0.000372
  HOMO = -0.19084953033686  LUMO = -0.0270170766700826
cycle= 6 E= -1.38677494362535  delta_E= -5.29e-11  |g|= 6.13e-07  |ddm|= 1.32e-05
  HOMO = -0.190849313976608  LUMO = -0.0270169414710383
Extra cycle  E= -1.38677494362561  delta_E= -2.61e-13  |g|= 1.33e-07  |ddm|= 8.76e-07
converged SCF energy = -1.38677494362561

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpgdwvueq0
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19166443557048  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -1.19460567936991  dE = -2.94124380e-03  S^2 = 0.7500000
               |grad[o]|=0.0507  |ddm|=4.4e-16  |maxRot[o]|=0.0394
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19460574788947  dE = -6.85195642e-08  S^2 = 0.7500000
               |grad[o]|=0.000235  |ddm|=4.47e-16  |maxRot[o]|=0.000227
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19460574788947
CASCI E = -1.19460574788947  E(CI) = -1.88880504122267  S^2 = 0.7500000
CASCI state-averaged energy = -1.19460574788947
CASCI energy for each state
  State 0 weight 0.125  E = -1.49122922614063 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46889945094334 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.17861383217216 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.15260802550647 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12839713823225 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10832508226032 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.02132966738334 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.00744356047725 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpgdwvueq0
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.45552123513864  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    4 micro), CASSCF E = -1.48093422919846  dE = -2.54129941e-02  S^2 = 3.7500000
               |grad[o]|=0.133  |ddm|=    0  |maxRot[o]|=0.139
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.48093485551314  dE = -6.26314675e-07  S^2 = 3.7500000
               |grad[o]|=0.00091  |ddm|=    0  |maxRot[o]|=0.00038
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.48093485551314  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=5.52e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.48093485551314
CASCI E = -1.48093485551314  E(CI) = -2.17513414884634  S^2 = 3.7500000
CASCI state-averaged energy = -1.48093485551314
CASCI energy for each state
  State 0 weight 1  E = -1.48093485551314 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:13 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.500000000000   1.500000000000 AA    0.000000000000   2.834589186848   2.834589186848 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.000000000000 AA    0.000000000000   0.000000000000   5.669178373695 Bohr   0.0

nuclear repulsion = 0.675305462694555
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       172.33


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpdjh0b3n3
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.991230164373339
  HOMO = -0.163942505192329  LUMO = -0.0901043500227482
cycle= 1 E= -1.37632071886667  delta_E= -0.385  |g|= 0.0517  |ddm|= 0.744
  HOMO = -0.197130528951  LUMO = -0.0392049165133903
cycle= 2 E= -1.37864948096989  delta_E= -0.00233  |g|= 0.00934  |ddm|= 0.0796
  HOMO = -0.194226742893615  LUMO = -0.0327851897872109
cycle= 3 E= -1.3787299879441  delta_E= -8.05e-05  |g|= 0.00132  |ddm|= 0.0186
  HOMO = -0.193363188544965  LUMO = -0.0330434140470496
cycle= 4 E= -1.37873189209826  delta_E= -1.9e-06  |g|= 0.000218  |ddm|= 0.00275
  HOMO = -0.193480159312361  LUMO = -0.0329838486066825
cycle= 5 E= -1.37873192120633  delta_E= -2.91e-08  |g|= 9.36e-06  |ddm|= 0.000375
  HOMO = -0.19348112963849  LUMO = -0.0329828744438817
cycle= 6 E= -1.37873192125767  delta_E= -5.13e-11  |g|= 6.46e-07  |ddm|= 1.3e-05
  HOMO = -0.193480902992584  LUMO = -0.0329827272848162
Extra cycle  E= -1.37873192125795  delta_E= -2.82e-13  |g|= 1.39e-07  |ddm|= 9.2e-07
converged SCF energy = -1.37873192125795

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpdjh0b3n3
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19155193728513  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19439761856024  dE = -2.84568128e-03  S^2 = 0.7500000
               |grad[o]|= 0.05  |ddm|=4.92e-16  |maxRot[o]|=0.0402
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19439774517176  dE = -1.26611522e-07  S^2 = 0.7500000
               |grad[o]|=0.000331  |ddm|=4.24e-16  |maxRot[o]|=0.000273
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19439774517176  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=4.74e-07  |ddm|=6.33e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19439774517176
CASCI E = -1.19439774517176  E(CI) = -1.86970320786632  S^2 = 0.7500000
CASCI state-averaged energy = -1.19439774517176
CASCI energy for each state
  State 0 weight 0.125  E = -1.48885350502996 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46918775916329 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.17360908245892 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.14955255581278 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12839826149831 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10935453914468 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.02413463734227 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.01209162092388 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpdjh0b3n3
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.45818501318256  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -1.48317540546993  dE = -2.49903923e-02  S^2 = 3.7500000
               |grad[o]|=0.132  |ddm|=    0  |maxRot[o]|=0.129
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.48317595901595  dE = -5.53546015e-07  S^2 = 3.7500000
               |grad[o]|=0.000873  |ddm|=    0  |maxRot[o]|=0.000386
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.48317595901595  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=3.22e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.48317595901595
CASCI E = -1.48317595901595  E(CI) = -2.15848142171050  S^2 = 3.7500000
CASCI state-averaged energy = -1.48317595901595
CASCI energy for each state
  State 0 weight 1  E = -1.48317595901595 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:14 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.524795068198   1.550000000000 AA    0.000000000000   2.881445074981   2.929075493076 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.100000000000 AA    0.000000000000   0.000000000000   5.858150986152 Bohr   0.0

nuclear repulsion = 0.657462861230113
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       177.52


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp2v523yds
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.989281411214888
  HOMO = -0.166331412650855  LUMO = -0.0957173103740861
cycle= 1 E= -1.36858048511179  delta_E= -0.379  |g|= 0.0504  |ddm|= 0.745
  HOMO = -0.199325035918584  LUMO = -0.0446306328292866
cycle= 2 E= -1.37082767600122  delta_E= -0.00225  |g|= 0.00936  |ddm|= 0.0783
  HOMO = -0.19659581209541  LUMO = -0.0385256725230093
cycle= 3 E= -1.37090747537609  delta_E= -7.98e-05  |g|= 0.00128  |ddm|= 0.0184
  HOMO = -0.195722001452706  LUMO = -0.0388230854932428
cycle= 4 E= -1.3709093216819  delta_E= -1.85e-06  |g|= 0.000227  |ddm|= 0.00267
  HOMO = -0.195839263877692  LUMO = -0.0387595022406079
cycle= 5 E= -1.37090935248681  delta_E= -3.08e-08  |g|= 9.22e-06  |ddm|= 0.000381
  HOMO = -0.195840561958478  LUMO = -0.0387586157343162
cycle= 6 E= -1.37090935253713  delta_E= -5.03e-11  |g|= 6.76e-07  |ddm|= 1.29e-05
  HOMO = -0.195840327355937  LUMO = -0.0387584571977494
Extra cycle  E= -1.37090935253743  delta_E= -3.04e-13  |g|= 1.43e-07  |ddm|= 9.57e-07
converged SCF energy = -1.37090935253743

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp2v523yds
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19119974626513  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19396443864958  dE = -2.76469238e-03  S^2 = 0.7500000
               |grad[o]|=0.0493  |ddm|=4.11e-16  |maxRot[o]|=0.0412
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19396455911047  dE = -1.20460890e-07  S^2 = 0.7500000
               |grad[o]|=0.000323  |ddm|=2.85e-16  |maxRot[o]|=0.000287
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19396455911047  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=3.77e-07  |ddm|=5.51e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19396455911047
CASCI E = -1.19396455911047  E(CI) = -1.85142742034058  S^2 = 0.7500000
CASCI state-averaged energy = -1.19396455911047
CASCI energy for each state
  State 0 weight 0.125  E = -1.48668073625661 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46943357192438 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.16866881735927 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.14645257785708 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12803489275426 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.11009221820424 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.02636577290706 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.01598788562086 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp2v523yds
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46052025319685  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -1.48512950780441  dE = -2.46092546e-02  S^2 = 3.7500000
               |grad[o]|=0.131  |ddm|=    0  |maxRot[o]|=0.117
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.48513001868551  dE = -5.10881097e-07  S^2 = 3.7500000
               |grad[o]|=0.000843  |ddm|=    0  |maxRot[o]|=0.000388
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.48513001868551  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=3.99e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.48513001868551
CASCI E = -1.48513001868551  E(CI) = -2.14259287991562  S^2 = 3.7500000
CASCI state-averaged energy = -1.48513001868551
CASCI energy for each state
  State 0 weight 1  E = -1.48513001868551 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:16 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.549193338483   1.600000000000 AA    0.000000000000   2.927551123733   3.023561799304 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.200000000000 AA    0.000000000000   0.000000000000   6.047123598608 Bohr   0.0

nuclear repulsion = 0.640583042377365
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       182.79


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpecgi6bn2
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.987617860706265
  HOMO = -0.168417907705989  LUMO = -0.101051050120233
cycle= 1 E= -1.36105974292903  delta_E= -0.373  |g|= 0.0493  |ddm|= 0.746
  HOMO = -0.201305625302625  LUMO = -0.0498877031454382
cycle= 2 E= -1.36323348043418  delta_E= -0.00217  |g|= 0.00937  |ddm|= 0.0773
  HOMO = -0.198721178165413  LUMO = -0.0440747157740803
cycle= 3 E= -1.36331262562501  delta_E= -7.91e-05  |g|= 0.00125  |ddm|= 0.0184
  HOMO = -0.197836589232742  LUMO = -0.044409904105779
cycle= 4 E= -1.36331443776853  delta_E= -1.81e-06  |g|= 0.000238  |ddm|= 0.00261
  HOMO = -0.197954409423063  LUMO = -0.0443420165317987
cycle= 5 E= -1.36331447103629  delta_E= -3.33e-08  |g|= 9.11e-06  |ddm|= 0.00039
  HOMO = -0.197956065732633  LUMO = -0.0443412013245704
cycle= 6 E= -1.36331447108603  delta_E= -4.97e-11  |g|= 7.01e-07  |ddm|= 1.28e-05
  HOMO = -0.197955825075763  LUMO = -0.0443410322423235
Extra cycle  E= -1.36331447108635  delta_E= -3.18e-13  |g|= 1.46e-07  |ddm|= 9.83e-07
converged SCF energy = -1.36331447108635

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpecgi6bn2
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.19064215228917  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19333794322111  dE = -2.69579093e-03  S^2 = 0.7500000
               |grad[o]|=0.0487  |ddm|=3.47e-16  |maxRot[o]|=0.0422
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19333806142512  dE = -1.18204009e-07  S^2 = 0.7500000
               |grad[o]|=0.00032  |ddm|=4.83e-16  |maxRot[o]|=0.000302
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19333806142512  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=3.18e-07  |ddm|=2.79e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19333806142512
CASCI E = -1.19333806142512  E(CI) = -1.83392110380248  S^2 = 0.7500000
CASCI state-averaged energy = -1.19333806142512
CASCI energy for each state
  State 0 weight 0.125  E = -1.48470483739693 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46963704616381 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.16381430799692 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.143327084755 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12734773323729 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.11054221201403 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.02811165036537 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.0192196194716 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpecgi6bn2
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46256588579828  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    4 micro), CASSCF E = -1.48683300236973  dE = -2.42671166e-02  S^2 = 3.7500000
               |grad[o]|= 0.13  |ddm|=    0  |maxRot[o]|=0.101
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.48683346295822  dE = -4.60588482e-07  S^2 = 3.7500000
               |grad[o]|=0.00081  |ddm|=    0  |maxRot[o]|=0.000388
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.48683346295822  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.94e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.48683346295822
CASCI E = -1.48683346295822  E(CI) = -2.12741650533558  S^2 = 3.7500000
CASCI state-averaged energy = -1.48683346295822
CASCI energy for each state
  State 0 weight 1  E = -1.48683346295822 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:17 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.573213272255   1.650000000000 AA    0.000000000000   2.972942220093   3.118048105532 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.300000000000 AA    0.000000000000   0.000000000000   6.236096211065 Bohr   0.0

nuclear repulsion = 0.624587454393681
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       188.18


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpe_zjiv6d
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.986197174723235
  HOMO = -0.170240236665154  LUMO = -0.10610880497991
cycle= 1 E= -1.35376387165064  delta_E= -0.368  |g|= 0.0482  |ddm|= 0.748
  HOMO = -0.20309323433716  LUMO = -0.0549726782229404
cycle= 2 E= -1.35587145544405  delta_E= -0.00211  |g|= 0.00938  |ddm|= 0.0764
  HOMO = -0.200627126870117  LUMO = -0.0494310826805876
cycle= 3 E= -1.3559499752897  delta_E= -7.85e-05  |g|= 0.00122  |ddm|= 0.0183
  HOMO = -0.199731692524245  LUMO = -0.0498023287237969
cycle= 4 E= -1.35595177932157  delta_E= -1.8e-06  |g|= 0.000252  |ddm|= 0.00256
  HOMO = -0.199850301669956  LUMO = -0.0497298786398287
cycle= 5 E= -1.35595181594619  delta_E= -3.66e-08  |g|= 9.05e-06  |ddm|= 0.000401
  HOMO = -0.199852345407798  LUMO = -0.0497291174262328
cycle= 6 E= -1.35595181599571  delta_E= -4.95e-11  |g|= 7.21e-07  |ddm|= 1.29e-05
  HOMO = -0.199852100274305  LUMO = -0.0497289387432703
Extra cycle  E= -1.35595181599604  delta_E= -3.31e-13  |g|= 1.48e-07  |ddm|= 1e-06
converged SCF energy = -1.35595181599604

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpe_zjiv6d
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18990847848427  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19254557010290  dE = -2.63709162e-03  S^2 = 0.7500000
               |grad[o]|=0.0481  |ddm|=1.73e-15  |maxRot[o]|=0.0432
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19254568892948  dE = -1.18826576e-07  S^2 = 0.7500000
               |grad[o]|=0.00032  |ddm|=6.31e-16  |maxRot[o]|=0.000317
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19254568892948  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.91e-07  |ddm|=4.09e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19254568892948
CASCI E = -1.19254568892948  E(CI) = -1.81713314332316  S^2 = 0.7500000
CASCI state-averaged energy = -1.19254568892948
CASCI energy for each state
  State 0 weight 0.125  E = -1.48291718782913 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.4698003564508 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.15905974473498 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.14019104646436 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12637417872913 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.1107142981146 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.02944428520235 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02186441391048 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpe_zjiv6d
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46435584452204  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    4 micro), CASSCF E = -1.48831729971105  dE = -2.39614552e-02  S^2 = 3.7500000
               |grad[o]|= 0.13  |ddm|=    0  |maxRot[o]|=0.104
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.48831773682524  dE = -4.37114191e-07  S^2 = 3.7500000
               |grad[o]|=0.000795  |ddm|=    0  |maxRot[o]|=0.000391
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.48831773682524  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.51e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.48831773682524
CASCI E = -1.48831773682524  E(CI) = -2.11290519121892  S^2 = 3.7500000
CASCI state-averaged energy = -1.48831773682524
CASCI energy for each state
  State 0 weight 1  E = -1.48831773682524 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:18 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.596871942267   1.700000000000 AA    0.000000000000   3.017650626887   3.212534411761 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.400000000000 AA    0.000000000000   0.000000000000   6.425068823521 Bohr   0.0

nuclear repulsion = 0.609406070965136
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       193.49


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp0pxax3bw
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.984983314196614
  HOMO = -0.171831716511757  LUMO = -0.110895889824371
cycle= 1 E= -1.34669594281438  delta_E= -0.362  |g|= 0.0472  |ddm|= 0.751
  HOMO = -0.204706252401688  LUMO = -0.0598835776573659
cycle= 2 E= -1.34874393776666  delta_E= -0.00205  |g|= 0.00938  |ddm|= 0.0757
  HOMO = -0.202334957137646  LUMO = -0.0545949048198243
cycle= 3 E= -1.34882183563739  delta_E= -7.79e-05  |g|= 0.0012  |ddm|= 0.0182
  HOMO = -0.20142905403258  LUMO = -0.0550001929248672
cycle= 4 E= -1.34882366006988  delta_E= -1.82e-06  |g|= 0.000268  |ddm|= 0.00254
  HOMO = -0.201548658635254  LUMO = -0.0549229541089836
cycle= 5 E= -1.34882370110211  delta_E= -4.1e-08  |g|= 9.03e-06  |ddm|= 0.000415
  HOMO = -0.201551115402443  LUMO = -0.054922230116859
cycle= 6 E= -1.34882370115174  delta_E= -4.96e-11  |g|= 7.35e-07  |ddm|= 1.3e-05
  HOMO = -0.201550867101022  LUMO = -0.054922042780635
Extra cycle  E= -1.34882370115207  delta_E= -3.34e-13  |g|= 1.48e-07  |ddm|= 1.01e-06
converged SCF energy = -1.34882370115207

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp0pxax3bw
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18902400547858  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19161110500331  dE = -2.58709952e-03  S^2 = 0.7500000
               |grad[o]|=0.0476  |ddm|=1.26e-15  |maxRot[o]|=0.044
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19161122667959  dE = -1.21676278e-07  S^2 = 0.7500000
               |grad[o]|=0.000323  |ddm|=4.76e-16  |maxRot[o]|=0.000332
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19161122667959  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.72e-07  |ddm|=1.13e-15  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19161122667959
CASCI E = -1.19161122667959  E(CI) = -1.80101729764472  S^2 = 0.7500000
CASCI state-averaged energy = -1.19161122667959
CASCI energy for each state
  State 0 weight 0.125  E = -1.48130736058581 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.46992686951788 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.15441414655246 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.13705650453721 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12514852726255 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.11062241543668 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.03042262942301 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.0239913601211 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp0pxax3bw
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46591990479698  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -1.48960970003533  dE = -2.36897952e-02  S^2 = 3.7500000
               |grad[o]|=0.129  |ddm|=    0  |maxRot[o]|=0.112
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.48961013160160  dE = -4.31566269e-07  S^2 = 3.7500000
               |grad[o]|=0.000795  |ddm|=    0  |maxRot[o]|=0.000398
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.48961013160160  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.72e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.48961013160160
CASCI E = -1.48961013160160  E(CI) = -2.09901620256674  S^2 = 3.7500000
CASCI state-averaged energy = -1.4896101316016
CASCI energy for each state
  State 0 weight 1  E = -1.4896101316016 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:20 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.620185174602   1.750000000000 AA    0.000000000000   3.061706251078   3.307020717989 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.500000000000 AA    0.000000000000   0.000000000000   6.614041435978 Bohr   0.0

nuclear repulsion = 0.594976245751272
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       198.76


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpswp8_z13
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.983945676049559
  HOMO = -0.173221381590571  LUMO = -0.115419324088687
cycle= 1 E= -1.3398571255048  delta_E= -0.356  |g|= 0.0463  |ddm|= 0.754
  HOMO = -0.206160948026001  LUMO = -0.0646197334035429
cycle= 2 E= -1.34185144063961  delta_E= -0.00199  |g|= 0.00938  |ddm|= 0.0752
  HOMO = -0.20386345495036  LUMO = -0.0595674791371555
cycle= 3 E= -1.34192869451876  delta_E= -7.73e-05  |g|= 0.00119  |ddm|= 0.0182
  HOMO = -0.202947882360168  LUMO = -0.0600045116748519
cycle= 4 E= -1.34193057008661  delta_E= -1.88e-06  |g|= 0.000285  |ddm|= 0.00254
  HOMO = -0.203068672244519  LUMO = -0.0599222907600583
cycle= 5 E= -1.34193061676459  delta_E= -4.67e-08  |g|= 9.04e-06  |ddm|= 0.000432
  HOMO = -0.203071562663879  LUMO = -0.0599215890403235
cycle= 6 E= -1.34193061681459  delta_E= -5e-11  |g|= 7.43e-07  |ddm|= 1.31e-05
  HOMO = -0.203071312270068  LUMO = -0.0599213939431206
Extra cycle  E= -1.34193061681493  delta_E= -3.33e-13  |g|= 1.46e-07  |ddm|= 1.01e-06
converged SCF energy = -1.34193061681493

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpswp8_z13
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18801070036174  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.19055530151941  dE = -2.54460116e-03  S^2 = 0.7500000
               |grad[o]|=0.0472  |ddm|=1.81e-15  |maxRot[o]|=0.0449
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.19055542770696  dE = -1.26187546e-07  S^2 = 0.7500000
               |grad[o]|=0.000328  |ddm|=3.65e-16  |maxRot[o]|=0.000347
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.19055542770696  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.58e-07  |ddm|=5.77e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.19055542770696
CASCI E = -1.19055542770696  E(CI) = -1.78553167345823  S^2 = 0.7500000
CASCI state-averaged energy = -1.19055542770696
CASCI energy for each state
  State 0 weight 0.125  E = -1.47986379550706 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47002060355398 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.14988278746774 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.13393333253573 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12370220288248 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.11028334110059 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.03109536176144 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02566199684665 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpswp8_z13
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46728434884852  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -1.49073403237230  dE = -2.34496835e-02  S^2 = 3.7500000
               |grad[o]|=0.128  |ddm|=    0  |maxRot[o]|=0.116
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.49073445097310  dE = -4.18600800e-07  S^2 = 3.7500000
               |grad[o]|=0.000785  |ddm|=    0  |maxRot[o]|=0.000399
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.49073445097310  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.25e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.49073445097310
CASCI E = -1.49073445097310  E(CI) = -2.08571069672437  S^2 = 3.7500000
CASCI state-averaged energy = -1.4907344509731
CASCI energy for each state
  State 0 weight 1  E = -1.4907344509731 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:21 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.643167672515   1.800000000000 AA    0.000000000000   3.105136877793   3.401507024217 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.600000000000 AA    0.000000000000   0.000000000000   6.803014048434 Bohr   0.0

nuclear repulsion = 0.581241748929518
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       204.14


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpz1qeax70
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.983058323928752
  HOMO = -0.174434553553905  LUMO = -0.119687463711137
cycle= 1 E= -1.33324703560126  delta_E= -0.35  |g|= 0.0455  |ddm|= 0.757
  HOMO = -0.207471817110005  LUMO = -0.0691816252978946
cycle= 2 E= -1.33519299569432  delta_E= -0.00195  |g|= 0.00937  |ddm|= 0.0747
  HOMO = -0.205229287817585  LUMO = -0.0643510818461721
cycle= 3 E= -1.33526955929529  delta_E= -7.66e-05  |g|= 0.00119  |ddm|= 0.0182
  HOMO = -0.204305241052763  LUMO = -0.0648173014464324
cycle= 4 E= -1.33527151834691  delta_E= -1.96e-06  |g|= 0.000305  |ddm|= 0.00256
  HOMO = -0.204427394870801  LUMO = -0.0647299373246355
cycle= 5 E= -1.33527157212768  delta_E= -5.38e-08  |g|= 9.09e-06  |ddm|= 0.000452
  HOMO = -0.204430734062061  LUMO = -0.0647292456730477
cycle= 6 E= -1.33527157217832  delta_E= -5.06e-11  |g|= 7.45e-07  |ddm|= 1.33e-05
  HOMO = -0.204430482453194  LUMO = -0.0647290436430033
Extra cycle  E= -1.33527157217865  delta_E= -3.29e-13  |g|= 1.43e-07  |ddm|= 9.98e-07
converged SCF energy = -1.33527157217865

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpz1qeax70
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18688778715074  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.18939637109814  dE = -2.50858395e-03  S^2 = 0.7500000
               |grad[o]|=0.0468  |ddm|=2.84e-16  |maxRot[o]|=0.0456
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18939650300718  dE = -1.31909035e-07  S^2 = 0.7500000
               |grad[o]|=0.000334  |ddm|=8.53e-16  |maxRot[o]|=0.000362
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18939650300718  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.55e-07  |ddm|=6.47e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18939650300718
CASCI E = -1.18939650300718  E(CI) = -1.77063825193670  S^2 = 0.7500000
CASCI state-averaged energy = -1.18939650300718
CASCI energy for each state
  State 0 weight 0.125  E = -1.47857434694345 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47008584618817 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.14546826220192 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.13082978928006 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12206395794588 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10971558858322 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.0315031030949 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02693112981983 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpz1qeax70
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46847248996853  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 11 JK    3 micro), CASSCF E = -1.49171113186577  dE = -2.32386419e-02  S^2 = 3.7500000
               |grad[o]|=0.128  |ddm|=    0  |maxRot[o]|=0.117
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.49171154288779  dE = -4.11022018e-07  S^2 = 3.7500000
               |grad[o]|=0.000779  |ddm|=    0  |maxRot[o]|=0.0004
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.49171154288779  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.63e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 15 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.49171154288779
CASCI E = -1.49171154288779  E(CI) = -2.07295329181731  S^2 = 3.7500000
CASCI state-averaged energy = -1.49171154288779
CASCI energy for each state
  State 0 weight 1  E = -1.49171154288779 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:23 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.665833124896   1.850000000000 AA    0.000000000000   3.147968375281   3.495993330445 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.700000000000 AA    0.000000000000   0.000000000000   6.991986660891 Bohr   0.0

nuclear repulsion = 0.568151952596185
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       209.04


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmp9a9d1zxi
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.982299300422112
  HOMO = -0.175493335911372  LUMO = -0.123709659227678
cycle= 1 E= -1.32686403335619  delta_E= -0.345  |g|= 0.0448  |ddm|= 0.761
  HOMO = -0.208651862041136  LUMO = -0.073570717468022
cycle= 2 E= -1.32876644187865  delta_E= -0.0019  |g|= 0.00935  |ddm|= 0.0744
  HOMO = -0.206447328610644  LUMO = -0.0689488014497736
cycle= 3 E= -1.32884224680925  delta_E= -7.58e-05  |g|= 0.0012  |ddm|= 0.0182
  HOMO = -0.205516370125211  LUMO = -0.069441416137986
cycle= 4 E= -1.32884432231601  delta_E= -2.08e-06  |g|= 0.000327  |ddm|= 0.00261
  HOMO = -0.205640058486449  LUMO = -0.0693487787860658
cycle= 5 E= -1.32884438490706  delta_E= -6.26e-08  |g|= 9.17e-06  |ddm|= 0.000475
  HOMO = -0.205643856170794  LUMO = -0.0693480882498851
cycle= 6 E= -1.32884438495855  delta_E= -5.15e-11  |g|= 7.44e-07  |ddm|= 1.35e-05
  HOMO = -0.205643604067135  LUMO = -0.0693478800723905
Extra cycle  E= -1.32884438495888  delta_E= -3.22e-13  |g|= 1.4e-07  |ddm|= 9.84e-07
converged SCF energy = -1.32884438495888

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp9a9d1zxi
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18567219116994  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.18815037114470  dE = -2.47817997e-03  S^2 = 0.7500000
               |grad[o]|=0.0464  |ddm|=5.73e-16  |maxRot[o]|=0.0464
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18815050965161  dE = -1.38506912e-07  S^2 = 0.7500000
               |grad[o]|=0.000341  |ddm|=1.79e-15  |maxRot[o]|=0.000377
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18815050965161  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.64e-07  |ddm|=5.91e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18815050965161
CASCI E = -1.18815050965161  E(CI) = -1.75630246224780  S^2 = 0.7500000
CASCI state-averaged energy = -1.18815050965161
CASCI energy for each state
  State 0 weight 0.125  E = -1.47742671378075 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47012689093705 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.14117128240278 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.12775290561243 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.12026005749534 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10893854118974 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.03168013649128 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02784754930354 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmp9a9d1zxi
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46950508588823  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 11 JK    3 micro), CASSCF E = -1.49255930816636  dE = -2.30542223e-02  S^2 = 3.7500000
               |grad[o]|=0.127  |ddm|=    0  |maxRot[o]|=0.117
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.49255972505127  dE = -4.16884902e-07  S^2 = 3.7500000
               |grad[o]|=0.000781  |ddm|=    0  |maxRot[o]|=0.0004
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.49255972505127  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.57e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 15 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.49255972505127
CASCI E = -1.49255972505127  E(CI) = -2.06071167764745  S^2 = 3.7500000
CASCI state-averaged energy = -1.49255972505127
CASCI energy for each state
  State 0 weight 1  E = -1.49255972505127 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:24 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.688194301613   1.900000000000 AA    0.000000000000   3.190224875101   3.590479636674 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.800000000000 AA    0.000000000000   0.000000000000   7.180959273347 Bohr   0.0

nuclear repulsion = 0.55566113864418
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       213.95


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpq24vzf7d
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.981650018614307
  HOMO = -0.176417039037495  LUMO = -0.127495952483884
cycle= 1 E= -1.32070547282329  delta_E= -0.339  |g|= 0.0441  |ddm|= 0.765
  HOMO = -0.209712812112435  LUMO = -0.0777893025916235
cycle= 2 E= -1.32256866630729  delta_E= -0.00186  |g|= 0.00932  |ddm|= 0.0742
  HOMO = -0.20753091844423  LUMO = -0.0733643908523565
cycle= 3 E= -1.32264362523626  delta_E= -7.5e-05  |g|= 0.00122  |ddm|= 0.0182
  HOMO = -0.206594948348654  LUMO = -0.0738803994864507
cycle= 4 E= -1.32264584943066  delta_E= -2.22e-06  |g|= 0.000351  |ddm|= 0.00269
  HOMO = -0.206720334968083  LUMO = -0.0737823887618449
cycle= 5 E= -1.32264592282043  delta_E= -7.34e-08  |g|= 9.28e-06  |ddm|= 0.0005
  HOMO = -0.206724595945219  LUMO = -0.0737816937782524
cycle= 6 E= -1.32264592287301  delta_E= -5.26e-11  |g|= 7.38e-07  |ddm|= 1.37e-05
  HOMO = -0.206724343956319  LUMO = -0.0737814802294077
Extra cycle  E= -1.32264592287332  delta_E= -3.12e-13  |g|= 1.35e-07  |ddm|= 9.65e-07
converged SCF energy = -1.32264592287332

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpq24vzf7d
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18437888482517  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.18683151361749  dE = -2.45262879e-03  S^2 = 0.7500000
               |grad[o]|=0.0461  |ddm|=4.02e-16  |maxRot[o]|=0.0471
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18683165933698  dE = -1.45719484e-07  S^2 = 0.7500000
               |grad[o]|=0.000349  |ddm|=1.36e-15  |maxRot[o]|=0.000392
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18683165933698  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.77e-07  |ddm|=3.08e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18683165933698
CASCI E = -1.18683165933698  E(CI) = -1.74249279798116  S^2 = 0.7500000
CASCI state-averaged energy = -1.18683165933698
CASCI energy for each state
  State 0 weight 0.125  E = -1.47640876237616 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47014785979089 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.13699126991639 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.12470874363983 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.11831444811688 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10797179824978 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.03165572615567 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02845466645023 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpq24vzf7d
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.47040066611637  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -1.49329274935308  dE = -2.28920832e-02  S^2 = 3.7500000
               |grad[o]|=0.127  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.49329512753643  dE = -2.37818335e-06  S^2 = 3.7500000
               |grad[o]|=0.00143  |ddm|=    0  |maxRot[o]|=0.00139
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.49329512753643  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.91e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.49329512753643
CASCI E = -1.49329512753643  E(CI) = -2.04895626618061  S^2 = 3.7500000
CASCI state-averaged energy = -1.49329512753643
CASCI energy for each state
  State 0 weight 1  E = -1.49329512753643 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:25 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.710263137649   1.950000000000 AA    0.000000000000   3.231928931095   3.684965942902 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.900000000000 AA    0.000000000000   0.000000000000   7.369931885804 Bohr   0.0

nuclear repulsion = 0.543727907980174
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       218.29


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpe4nz078h
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.981094731638606
  HOMO = -0.177222543790908  LUMO = -0.131056817523404
cycle= 1 E= -1.3147679073254  delta_E= -0.334  |g|= 0.0435  |ddm|= 0.769
  HOMO = -0.210665295894399  LUMO = -0.0818403587466177
cycle= 2 E= -1.31659580209506  delta_E= -0.00183  |g|= 0.00928  |ddm|= 0.074
  HOMO = -0.208492078872545  LUMO = -0.0776021374014644
cycle= 3 E= -1.31666981282162  delta_E= -7.4e-05  |g|= 0.00126  |ddm|= 0.0182
  HOMO = -0.207553305394323  LUMO = -0.0781383538048486
cycle= 4 E= -1.31667221550047  delta_E= -2.4e-06  |g|= 0.000377  |ddm|= 0.00278
  HOMO = -0.207680546757062  LUMO = -0.0780348984848762
cycle= 5 E= -1.31667230198692  delta_E= -8.65e-08  |g|= 9.42e-06  |ddm|= 0.000529
  HOMO = -0.207685271537638  LUMO = -0.0780341967451153
cycle= 6 E= -1.31667230204081  delta_E= -5.39e-11  |g|= 7.29e-07  |ddm|= 1.39e-05
  HOMO = -0.20768502020999  LUMO = -0.0780339786248398
Extra cycle  E= -1.31667230204111  delta_E= -2.98e-13  |g|= 1.31e-07  |ddm|= 9.42e-07
converged SCF energy = -1.31667230204111

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpe4nz078h
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18302115757542  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.18545241182024  dE = -2.43125424e-03  S^2 = 0.7500000
               |grad[o]|=0.0457  |ddm|=7.46e-16  |maxRot[o]|=0.0477
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18545256512831  dE = -1.53308069e-07  S^2 = 0.7500000
               |grad[o]|=0.000356  |ddm|=9.49e-16  |maxRot[o]|=0.000405
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18545256512831  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.84e-07  |ddm|=2.18e-15  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18545256512831
CASCI E = -1.18545256512831  E(CI) = -1.72918047310849  S^2 = 0.7500000
CASCI state-averaged energy = -1.18545256512831
CASCI energy for each state
  State 0 weight 0.125  E = -1.47550875710042 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47015258798022 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.13292679545264 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.12170255759091 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.11624891883554 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10683469896617 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.03145512219285 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02879108290776 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpe4nz078h
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.47117579340665  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -1.49392967517180  dE = -2.27538818e-02  S^2 = 3.7500000
               |grad[o]|=0.127  |ddm|=    0  |maxRot[o]|= 0.12
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.49393197159572  dE = -2.29642392e-06  S^2 = 3.7500000
               |grad[o]|=0.0014  |ddm|=    0  |maxRot[o]|=0.00135
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.49393197159572  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.95e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.49393197159572
CASCI E = -1.49393197159572  E(CI) = -2.03765987957589  S^2 = 3.7500000
CASCI state-averaged energy = -1.49393197159572
CASCI energy for each state
  State 0 weight 1  E = -1.49393197159572 S^2 = 3.7500000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/H3/H3.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 0; H 0 {(3 * b / 4)**(1/2)} {b/2}; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 1,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 3     # Number of active orbitals
    nelecas = 3   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=2)
    solvers.nroots = count_all_csfs(3, 2, 1, 2)
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=4)
    solvers.nroots = count_all_csfs(3, 3, 0, 4)
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(2, 41, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Doublet and Quartet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Doublet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Quartet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0050.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 16:30:26 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 3
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   1.732050807569   2.000000000000 AA    0.000000000000   3.273101660137   3.779452249130 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   4.000000000000 AA    0.000000000000   0.000000000000   7.558904498260 Bohr   0.0

nuclear repulsion = 0.532314674037741
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       222.74


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33374004/tmpm92qf1bs
max_memory 40000 MB (current use 122 MB)
num. doubly occ = 1  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -0.98062007651565
  HOMO = -0.177924612749336  LUMO = -0.134402945897635
cycle= 1 E= -1.30904725641736  delta_E= -0.328  |g|= 0.043  |ddm|= 0.773
  HOMO = -0.211518975959318  LUMO = -0.0857274214298456
cycle= 2 E= -1.31084338898575  delta_E= -0.0018  |g|= 0.00923  |ddm|= 0.0739
  HOMO = -0.209341683682191  LUMO = -0.0816667491738013
cycle= 3 E= -1.31091633926676  delta_E= -7.3e-05  |g|= 0.0013  |ddm|= 0.0182
  HOMO = -0.208402593240539  LUMO = -0.0822198243822594
cycle= 4 E= -1.31091894582333  delta_E= -2.61e-06  |g|= 0.000405  |ddm|= 0.0029
  HOMO = -0.208531837279866  LUMO = -0.0821108815558022
cycle= 5 E= -1.31091904803933  delta_E= -1.02e-07  |g|= 9.57e-06  |ddm|= 0.00056
  HOMO = -0.208537022725102  LUMO = -0.082110173698818
cycle= 6 E= -1.31091904809478  delta_E= -5.55e-11  |g|= 7.18e-07  |ddm|= 1.41e-05
  HOMO = -0.208536772587281  LUMO = -0.0821099518572679
Extra cycle  E= -1.31091904809507  delta_E= -2.85e-13  |g|= 1.25e-07  |ddm|= 9.17e-07
converged SCF energy = -1.31091904809507

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpm92qf1bs
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 8
pspace_size = 200
spin = None
State-average over 8 states with weights [0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125]
CASCI E = -1.18161082873338  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 (  8 JK    3 micro), CASSCF E = -1.18402427956797  dE = -2.41345083e-03  S^2 = 0.7500000
               |grad[o]|=0.0454  |ddm|=1.02e-15  |maxRot[o]|=0.0483
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.18402444059116  dE = -1.61023192e-07  S^2 = 0.7500000
               |grad[o]|=0.000364  |ddm|=2.29e-16  |maxRot[o]|=0.000419
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.18402444059116  dE =  0.00000000e+00  S^2 = 0.7500000
               |grad[o]|=2.76e-07  |ddm|=1.06e-15  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 12 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.18402444059116
CASCI E = -1.18402444059116  E(CI) = -1.71633911462890  S^2 = 0.7500000
CASCI state-averaged energy = -1.18402444059116
CASCI energy for each state
  State 0 weight 0.125  E = -1.47471551316998 S^2 = 0.7500000
  State 1 weight 0.125  E = -1.47014455196041 S^2 = 0.7500000
  State 2 weight 0.125  E = -1.12897589932408 S^2 = 0.7500000
  State 3 weight 0.125  E = -1.1187388742013 S^2 = 0.7500000
  State 4 weight 0.125  E = -1.11408327011305 S^2 = 0.7500000
  State 5 weight 0.125  E = -1.10554598841392 S^2 = 0.7500000
  State 6 weight 0.125  E = -1.03110032415984 S^2 = 0.7500000
  State 7 weight 0.125  E = -1.02889110338671 S^2 = 0.7500000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons -1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+1e, 3o), ncore = 0, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33374004/tmpm92qf1bs
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.47184527555952  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 11 JK    3 micro), CASSCF E = -1.49448240218510  dE = -2.26371266e-02  S^2 = 3.7500000
               |grad[o]|=0.126  |ddm|=    0  |maxRot[o]|= 0.12
macro iter   2 (  3 JK    1 micro), CASSCF E = -1.49448279961038  dE = -3.97425274e-07  S^2 = 3.7500000
               |grad[o]|=0.000753  |ddm|=    0  |maxRot[o]|=0.000386
macro iter   3 (  1 JK    1 micro), CASSCF E = -1.49448279961038  dE =  0.00000000e+00  S^2 = 3.7500000
               |grad[o]|=2.31e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 15 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1. 1.]
CASSCF energy = -1.49448279961038
CASCI E = -1.49448279961038  E(CI) = -2.02679747364812  S^2 = 3.7500000
CASCI state-averaged energy = -1.49448279961038
CASCI energy for each state
  State 0 weight 1  E = -1.49448279961038 S^2 = 3.7500000
