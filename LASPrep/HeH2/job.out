#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:23 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.500000000000 AA    0.000000000000   0.000000000000  -0.944863062283 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.500000000000 AA    0.000000000000   0.000000000000   0.944863062283 Bohr   0.0

nuclear repulsion = 4.76259489828
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:         1.31


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpnzftca14
max_memory 40000 MB (current use 102 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.39717882526388
  HOMO = -0.00793897006449035  LUMO = 0.147752810315064
cycle= 1 E= -3.04496349315036  delta_E= 1.35  |g|= 0.444  |ddm|= 4.35
  HOMO = -0.330563699805954  LUMO = 0.121675618170204
cycle= 2 E= -3.09409471579041  delta_E= -0.0491  |g|= 0.0454  |ddm|= 1.28
  HOMO = -0.285511077186398  LUMO = 0.148493425203049
cycle= 3 E= -3.0944308868931  delta_E= -0.000336  |g|= 0.00614  |ddm|= 0.0643
  HOMO = -0.285198454246891  LUMO = 0.148295512277873
cycle= 4 E= -3.09444053643837  delta_E= -9.65e-06  |g|= 0.000578  |ddm|= 0.00989
  HOMO = -0.285406716790751  LUMO = 0.148038095243886
cycle= 5 E= -3.09444065701485  delta_E= -1.21e-07  |g|= 6.82e-05  |ddm|= 0.00231
  HOMO = -0.28542617265767  LUMO = 0.148020010826853
cycle= 6 E= -3.09444065871491  delta_E= -1.7e-09  |g|= 1.87e-06  |ddm|= 0.000305
  HOMO = -0.285425083930753  LUMO = 0.148019543778129
cycle= 7 E= -3.09444065871602  delta_E= -1.11e-12  |g|= 2.05e-07  |ddm|= 7.08e-06
  HOMO = -0.285425137732426  LUMO = 0.148019643351634
Extra cycle  E= -3.09444065871603  delta_E= -8.88e-15  |g|= 2.06e-08  |ddm|= 6.79e-07
converged SCF energy = -3.09444065871603

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpnzftca14
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -2.89463770331976  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 11 JK    4 micro), CASSCF E = -2.90482595843750  dE = -1.01882551e-02  S^2 = 0.0000000
               |grad[o]|=0.128  |ddm|=3.21e-30  |maxRot[o]|=0.0692
macro iter   2 (  3 JK    1 micro), CASSCF E = -2.90483087790509  dE = -4.91946759e-06  S^2 = 0.0000000
               |grad[o]|=0.00226  |ddm|=2.22e-16  |maxRot[o]|=0.0016
macro iter   3 (  1 JK    1 micro), CASSCF E = -2.90483087790509  dE =  4.44089210e-16  S^2 = 0.0000000
               |grad[o]|=2.79e-05  |ddm|=5.02e-17  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 15 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -2.90483087790509
CASCI E = -2.90483087790509  E(CI) = -0.871995911624526  S^2 = 0.0000000
CASCI state-averaged energy = -2.90483087790509
CASCI energy for each state
  State 0 weight 0.333333  E = -3.09434809658811 S^2 = 0.0000000
  State 1 weight 0.333333  E = -2.91244315048139 S^2 = 0.0000000
  State 2 weight 0.333333  E = -2.70770138664578 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpnzftca14
max_memory 40000 MB (current use 137 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.99811424982848  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    4 micro), CASSCF E = -3.01417412683286  dE = -1.60598770e-02  S^2 = 2.0000000
               |grad[o]|=0.148  |ddm|=    0  |maxRot[o]|=0.098
macro iter   2 (  5 JK    2 micro), CASSCF E = -3.01417910845035  dE = -4.98161748e-06  S^2 = 2.0000000
               |grad[o]|=0.00208  |ddm|=    0  |maxRot[o]|=0.00229
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.01417910845035  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=4.79e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.01417910845035
CASCI E = -3.01417910845035  E(CI) = -0.969858080810474  S^2 = 2.0000000
CASCI state-averaged energy = -3.01417910845035
CASCI energy for each state
  State 0 weight 1  E = -3.01417910845035 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:25 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.600000000000 AA    0.000000000000   0.000000000000  -1.133835674739 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.600000000000 AA    0.000000000000   0.000000000000   1.133835674739 Bohr   0.0

nuclear repulsion = 3.9688290819
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:         7.45


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp0yknhchb
max_memory 40000 MB (current use 137 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.32830217784651
  HOMO = -0.0517773741862618  LUMO = 0.146620752613783
cycle= 1 E= -3.35032567907051  delta_E= 0.978  |g|= 0.37  |ddm|= 2.94
  HOMO = -0.342986985438553  LUMO = 0.127147470716538
cycle= 2 E= -3.3860461984517  delta_E= -0.0357  |g|= 0.0358  |ddm|= 0.739
  HOMO = -0.305566696834909  LUMO = 0.150198649511076
cycle= 3 E= -3.38627000040446  delta_E= -0.000224  |g|= 0.00497  |ddm|= 0.0355
  HOMO = -0.305004317243645  LUMO = 0.150289697440777
cycle= 4 E= -3.38627644909066  delta_E= -6.45e-06  |g|= 0.00033  |ddm|= 0.00581
  HOMO = -0.305128174131683  LUMO = 0.150136347214111
cycle= 5 E= -3.3862764904501  delta_E= -4.14e-08  |g|= 4.64e-05  |ddm|= 0.000992
  HOMO = -0.305141880817301  LUMO = 0.150121877269329
cycle= 6 E= -3.38627649135192  delta_E= -9.02e-10  |g|= 1.66e-06  |ddm|= 0.000168
  HOMO = -0.305141320816769  LUMO = 0.150121390758466
Extra cycle  E= -3.38627649135281  delta_E= -8.88e-13  |g|= 2.81e-07  |ddm|= 2.8e-06
converged SCF energy = -3.38627649135281

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp0yknhchb
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.16221867290717  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 10 JK    4 micro), CASSCF E = -3.17138074524836  dE = -9.16207234e-03  S^2 = 0.0000000
               |grad[o]|=0.119  |ddm|=2.22e-16  |maxRot[o]|=0.0572
macro iter   2 (  5 JK    2 micro), CASSCF E = -3.17138571055717  dE = -4.96530881e-06  S^2 = 0.0000000
               |grad[o]|=0.00226  |ddm|=3.14e-16  |maxRot[o]|=0.00151
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.17138571055717  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=3.1e-06  |ddm|=5.58e-31  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.17138571055717
CASCI E = -3.17138571055717  E(CI) = -0.885476402107154  S^2 = 0.0000000
CASCI state-averaged energy = -3.17138571055717
CASCI energy for each state
  State 0 weight 0.333333  E = -3.38666889841412 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.17479362813005 S^2 = 0.0000000
  State 2 weight 0.333333  E = -2.95269460512733 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp0yknhchb
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.26858503220665  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -3.28571624032849  dE = -1.71312081e-02  S^2 = 2.0000000
               |grad[o]|=0.144  |ddm|=    0  |maxRot[o]|=0.115
macro iter   2 (  5 JK    2 micro), CASSCF E = -3.28572014459825  dE = -3.90426976e-06  S^2 = 2.0000000
               |grad[o]|=0.0019  |ddm|=    0  |maxRot[o]|=0.00213
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.28572014459825  dE = -4.44089210e-16  S^2 = 2.0000000
               |grad[o]|=4.41e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.28572014459825
CASCI E = -3.28572014459825  E(CI) = -0.984976150948948  S^2 = 2.0000000
CASCI state-averaged energy = -3.28572014459825
CASCI energy for each state
  State 0 weight 1  E = -3.28572014459825 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:26 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.700000000000 AA    0.000000000000   0.000000000000  -1.322808287196 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.700000000000 AA    0.000000000000   0.000000000000   1.322808287196 Bohr   0.0

nuclear repulsion = 3.40185349877143
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        13.60


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpnjjh61sr
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.19594876144273
  HOMO = -0.0857311635457768  LUMO = 0.134310362625963
cycle= 1 E= -3.51198283533049  delta_E= 0.684  |g|= 0.315  |ddm|= 2.23
  HOMO = -0.347371278264358  LUMO = 0.120774030940874
cycle= 2 E= -3.5389065473082  delta_E= -0.0269  |g|= 0.0286  |ddm|= 0.474
  HOMO = -0.316969468902656  LUMO = 0.14161967171397
cycle= 3 E= -3.5390622150447  delta_E= -0.000156  |g|= 0.00412  |ddm|= 0.0229
  HOMO = -0.316340052660109  LUMO = 0.141888113740888
cycle= 4 E= -3.5390668524699  delta_E= -4.64e-06  |g|= 0.000199  |ddm|= 0.00413
  HOMO = -0.316419338304695  LUMO = 0.141791842951708
cycle= 5 E= -3.5390668660384  delta_E= -1.36e-08  |g|= 2.27e-05  |ddm|= 0.000458
  HOMO = -0.316427016960662  LUMO = 0.141784250385483
cycle= 6 E= -3.539066866268  delta_E= -2.3e-10  |g|= 1.46e-06  |ddm|= 7.04e-05
  HOMO = -0.316426722482156  LUMO = 0.141783744499127
Extra cycle  E= -3.53906686626877  delta_E= -7.64e-13  |g|= 3.23e-07  |ddm|= 1.32e-06
converged SCF energy = -3.53906686626877

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpnjjh61sr
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.30863565186656  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 10 JK    4 micro), CASSCF E = -3.31599255420293  dE = -7.35690234e-03  S^2 = 0.0000000
               |grad[o]|=0.104  |ddm|=2.22e-16  |maxRot[o]|=0.0532
macro iter   2 (  5 JK    2 micro), CASSCF E = -3.31599726648014  dE = -4.71227721e-06  S^2 = 0.0000000
               |grad[o]|=0.00218  |ddm|=1.67e-30  |maxRot[o]|=0.00142
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.31599726648014  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=3.53e-06  |ddm|=1.67e-30  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   7 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.31599726648014
CASCI E = -3.31599726648014  E(CI) = -0.892061301046443  S^2 = 0.0000000
CASCI state-averaged energy = -3.31599726648014
CASCI energy for each state
  State 0 weight 0.333333  E = -3.54218141016658 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.30880040374273 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.0970099855311 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpnjjh61sr
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.42181182254773  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -3.44082811841527  dE = -1.90162959e-02  S^2 = 2.0000000
               |grad[o]|=0.137  |ddm|=    0  |maxRot[o]|=0.141
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.44083130962864  dE = -3.19121337e-06  S^2 = 2.0000000
               |grad[o]|=0.00185  |ddm|=    0  |maxRot[o]|=0.00175
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.44083130962864  dE =  8.88178420e-16  S^2 = 2.0000000
               |grad[o]|=1.82e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.44083130962864
CASCI E = -3.44083130962864  E(CI) = -0.998928015559014  S^2 = 2.0000000
CASCI state-averaged energy = -3.44083130962864
CASCI energy for each state
  State 0 weight 1  E = -3.44083130962864 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:28 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.800000000000 AA    0.000000000000   0.000000000000  -1.511780899652 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.800000000000 AA    0.000000000000   0.000000000000   1.511780899652 Bohr   0.0

nuclear repulsion = 2.976621811425
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        19.18


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpi3i_88mh
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.05769170429674
  HOMO = -0.111400024028798  LUMO = 0.110709973317698
cycle= 1 E= -3.5964015598456  delta_E= 0.461  |g|= 0.272  |ddm|= 1.83
  HOMO = -0.346342369520009  LUMO = 0.104314908596695
cycle= 2 E= -3.617041789259  delta_E= -0.0206  |g|= 0.0232  |ddm|= 0.325
  HOMO = -0.322165389204071  LUMO = 0.123465438223848
cycle= 3 E= -3.61715337321225  delta_E= -0.000112  |g|= 0.00346  |ddm|= 0.0173
  HOMO = -0.321565295780191  LUMO = 0.123839254011507
cycle= 4 E= -3.61715682700976  delta_E= -3.45e-06  |g|= 0.000141  |ddm|= 0.0034
  HOMO = -0.321619642735784  LUMO = 0.123775093366601
cycle= 5 E= -3.61715683265171  delta_E= -5.64e-09  |g|= 9.58e-06  |ddm|= 0.000242
  HOMO = -0.321623569432808  LUMO = 0.123772486875306
cycle= 6 E= -3.61715683268613  delta_E= -3.44e-11  |g|= 7.95e-07  |ddm|= 2.45e-05
  HOMO = -0.321623494231444  LUMO = 0.123772110451066
Extra cycle  E= -3.61715683268638  delta_E= -2.52e-13  |g|= 1.97e-07  |ddm|= 7.26e-07
converged SCF energy = -3.61715683268638

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpi3i_88mh
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.39361943302323  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 10 JK    4 micro), CASSCF E = -3.39893792637767  dE = -5.31849335e-03  S^2 = 0.0000000
               |grad[o]|=0.086  |ddm|=1.11e-16  |maxRot[o]|=0.0471
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.39894187342306  dE = -3.94704540e-06  S^2 = 0.0000000
               |grad[o]|=0.00199  |ddm|=1.67e-30  |maxRot[o]|=0.00132
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.39894187342306  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=2.81e-05  |ddm|=5.58e-31  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 14 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.39894187342306
CASCI E = -3.39894187342306  E(CI) = -0.895974929491879  S^2 = 0.0000000
CASCI state-averaged energy = -3.39894187342306
CASCI energy for each state
  State 0 weight 0.333333  E = -3.62559617172529 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.37658562470023 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.19464382384368 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpi3i_88mh
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.51918461621412  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    3 micro), CASSCF E = -3.54098638920141  dE = -2.18017730e-02  S^2 = 2.0000000
               |grad[o]|=0.132  |ddm|=    0  |maxRot[o]|=0.169
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54098854475837  dE = -2.15555696e-06  S^2 = 2.0000000
               |grad[o]|=0.0017  |ddm|=    0  |maxRot[o]|=0.000815
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.54098854475837  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=6.7e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54098854475837
CASCI E = -3.54098854475837  E(CI) = -1.01761276737516  S^2 = 2.0000000
CASCI state-averaged energy = -3.54098854475837
CASCI energy for each state
  State 0 weight 1  E = -3.54098854475837 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:29 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.900000000000 AA    0.000000000000   0.000000000000  -1.700753512109 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.900000000000 AA    0.000000000000   0.000000000000   1.700753512109 Bohr   0.0

nuclear repulsion = 2.6458860546
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        24.35


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmphvbyyj7b
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.93473902874798
  HOMO = -0.130501504497819  LUMO = 0.0773753153489079
cycle= 1 E= -3.63879400534099  delta_E= 0.296  |g|= 0.235  |ddm|= 1.57
  HOMO = -0.341731671099501  LUMO = 0.0799476255022815
cycle= 2 E= -3.65458743147023  delta_E= -0.0158  |g|= 0.019  |ddm|= 0.233
  HOMO = -0.32303867151448  LUMO = 0.0970018899096401
cycle= 3 E= -3.6546671013335  delta_E= -7.97e-05  |g|= 0.00289  |ddm|= 0.0146
  HOMO = -0.322521975791305  LUMO = 0.097395081914136
cycle= 4 E= -3.65466964454746  delta_E= -2.54e-06  |g|= 0.000107  |ddm|= 0.00302
  HOMO = -0.322559366542207  LUMO = 0.097349309421825
cycle= 5 E= -3.65466964775991  delta_E= -3.21e-09  |g|= 6.53e-06  |ddm|= 0.000158
  HOMO = -0.322561673623948  LUMO = 0.0973483895212754
cycle= 6 E= -3.65466964777236  delta_E= -1.25e-11  |g|= 2.42e-07  |ddm|= 1.25e-05
  HOMO = -0.322561622013861  LUMO = 0.0973482129144061
Extra cycle  E= -3.65466964777238  delta_E= -1.87e-14  |g|= 3.52e-08  |ddm|= 1.84e-07
converged SCF energy = -3.65466964777238

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmphvbyyj7b
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.44662656317672  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -3.45028391035058  dE = -3.65734717e-03  S^2 = 0.0000000
               |grad[o]|=0.0686  |ddm|=2.22e-16  |maxRot[o]|=0.0386
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.45028693769444  dE = -3.02734386e-06  S^2 = 0.0000000
               |grad[o]|=0.00174  |ddm|=2.22e-16  |maxRot[o]|=0.00134
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.45028693769444  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=8.97e-06  |ddm|=2.48e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.45028693769444
CASCI E = -3.45028693769444  E(CI) = -0.898347261744531  S^2 = 0.0000000
CASCI state-averaged energy = -3.45028693769444
CASCI energy for each state
  State 0 weight 0.333333  E = -3.67198191183916 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.41056190736154 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.26831699388262 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmphvbyyj7b
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.58995640745991  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -3.61436413396436  dE = -2.44077265e-02  S^2 = 2.0000000
               |grad[o]|=0.131  |ddm|=    0  |maxRot[o]|=0.186
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.61436564905168  dE = -1.51508732e-06  S^2 = 2.0000000
               |grad[o]|=0.00138  |ddm|=    0  |maxRot[o]|=0.000935
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.61436564905168  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=9.82e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61436564905168
CASCI E = -3.61436564905168  E(CI) = -1.04077737491666  S^2 = 2.0000000
CASCI state-averaged energy = -3.61436564905168
CASCI energy for each state
  State 0 weight 1  E = -3.61436564905168 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:31 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.000000000000 AA    0.000000000000   0.000000000000  -1.889726124565 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr   0.0

nuclear repulsion = 2.38129744914
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        29.50


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpm_iub65p
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.83310029293193
  HOMO = -0.14453977087734  LUMO = 0.0383019091431948
cycle= 1 E= -3.65820045602599  delta_E= 0.175  |g|= 0.201  |ddm|=  1.4
  HOMO = -0.334970074950475  LUMO = 0.0508750996253688
cycle= 2 E= -3.67006561926764  delta_E= -0.0119  |g|= 0.0155  |ddm|= 0.172
  HOMO = -0.32107378283248  LUMO = 0.0650720832943023
cycle= 3 E= -3.67012165889009  delta_E= -5.6e-05  |g|= 0.0024  |ddm|= 0.0129
  HOMO = -0.320668849106765  LUMO = 0.0654016716976085
cycle= 4 E= -3.67012349350466  delta_E= -1.83e-06  |g|= 7.59e-05  |ddm|= 0.00275
  HOMO = -0.320692102266124  LUMO = 0.0653674332774398
cycle= 5 E= -3.67012349539589  delta_E= -1.89e-09  |g|= 5.62e-06  |ddm|= 0.000118
  HOMO = -0.320693485560389  LUMO = 0.0653663205293664
cycle= 6 E= -3.67012349540615  delta_E= -1.03e-11  |g|= 3.08e-07  |ddm|= 9.48e-06
  HOMO = -0.320693452818838  LUMO = 0.065366156683095
Extra cycle  E= -3.67012349540619  delta_E= -4.53e-14  |g|= 8.13e-08  |ddm|= 2.91e-07
converged SCF energy = -3.67012349540619

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpm_iub65p
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.48176109309059  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -3.48439974992089  dE = -2.63865683e-03  S^2 = 0.0000000
               |grad[o]|=0.0561  |ddm|=1.12e-30  |maxRot[o]|=0.0339
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.48440212024017  dE = -2.37031929e-06  S^2 = 0.0000000
               |grad[o]|=0.00152  |ddm|=2.22e-16  |maxRot[o]|=0.00132
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.48440212024017  dE =  8.88178420e-16  S^2 = 0.0000000
               |grad[o]|=1.17e-05  |ddm|=1.26e-30  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.48440212024017
CASCI E = -3.48440212024017  E(CI) = -0.898689551355892  S^2 = 0.0000000
CASCI state-averaged energy = -3.48440212024017
CASCI energy for each state
  State 0 weight 0.333333  E = -3.7005924920238 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.42751839022696 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.32509547846976 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpm_iub65p
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.64584570179120  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 14 JK    3 micro), CASSCF E = -3.67159239864936  dE = -2.57466969e-02  S^2 = 2.0000000
               |grad[o]|=0.131  |ddm|=    0  |maxRot[o]|= 0.19
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.67159407314580  dE = -1.67449644e-06  S^2 = 2.0000000
               |grad[o]|=0.00159  |ddm|=    0  |maxRot[o]|=0.000882
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.67159407314580  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=1.56e-05  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 18 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.67159407314580
CASCI E = -3.67159407314580  E(CI) = -1.06462171727395  S^2 = 2.0000000
CASCI state-averaged energy = -3.6715940731458
CASCI energy for each state
  State 0 weight 1  E = -3.6715940731458 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:32 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.100000000000 AA    0.000000000000   0.000000000000  -2.078698737022 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.100000000000 AA    0.000000000000   0.000000000000   2.078698737022 Bohr   0.0

nuclear repulsion = 2.16481586285455
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        34.36


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp01hhuu4u
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.7523994645024
  HOMO = -0.154774328528624  LUMO = -0.00160519773463968
cycle= 1 E= -3.66497382149364  delta_E= 0.0874  |g|= 0.169  |ddm|= 1.28
  HOMO = -0.327231552718195  LUMO = 0.020514344980974
cycle= 2 E= -3.67361828365965  delta_E= -0.00864  |g|= 0.0126  |ddm|= 0.13
  HOMO = -0.317446455384333  LUMO = 0.0313445431513877
cycle= 3 E= -3.67365798194725  delta_E= -3.97e-05  |g|= 0.002  |ddm|= 0.0115
  HOMO = -0.317163279351523  LUMO = 0.0315594215558161
cycle= 4 E= -3.67365931594079  delta_E= -1.33e-06  |g|= 6.05e-05  |ddm|= 0.00249
  HOMO = -0.317174700914357  LUMO = 0.0315331294786472
cycle= 5 E= -3.6736593176801  delta_E= -1.74e-09  |g|= 8.03e-06  |ddm|= 9.95e-05
  HOMO = -0.317174986525106  LUMO = 0.0315315154098399
cycle= 6 E= -3.67365931770964  delta_E= -2.95e-11  |g|= 6.24e-07  |ddm|= 1.14e-05
  HOMO = -0.317174907095883  LUMO = 0.0315313974748822
Extra cycle  E= -3.67365931770982  delta_E= -1.74e-13  |g|= 1.75e-07  |ddm|= 6.39e-07
converged SCF energy = -3.67365931770982

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp01hhuu4u
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.50571171585590  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  7 JK    2 micro), CASSCF E = -3.50787568471781  dE = -2.16396886e-03  S^2 = 0.0000000
               |grad[o]|=0.0495  |ddm|=3.14e-16  |maxRot[o]|=0.0367
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.50787744602775  dE = -1.76130994e-06  S^2 = 0.0000000
               |grad[o]|=0.00128  |ddm|=1.12e-30  |maxRot[o]|=0.00121
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.50787744602775  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=1.8e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 11 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.50787744602775
CASCI E = -3.50787744602775  E(CI) = -0.896537607250675  S^2 = 0.0000000
CASCI state-averaged energy = -3.50787744602775
CASCI energy for each state
  State 0 weight 0.333333  E = -3.72140123234236 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.43559884255159 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.36663226318931 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp01hhuu4u
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.69051934940268  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 15 JK    4 micro), CASSCF E = -3.71639399086156  dE = -2.58746415e-02  S^2 = 2.0000000
               |grad[o]|=0.131  |ddm|=    0  |maxRot[o]|=0.181
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.71639493191871  dE = -9.41057152e-07  S^2 = 2.0000000
               |grad[o]|=0.00103  |ddm|=    0  |maxRot[o]|=0.000772
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.71639493191871  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=9.98e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 19 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.71639493191871
CASCI E = -3.71639493191871  E(CI) = -1.08577101182051  S^2 = 2.0000000
CASCI state-averaged energy = -3.71639493191871
CASCI energy for each state
  State 0 weight 1  E = -3.71639493191871 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:33 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.200000000000 AA    0.000000000000   0.000000000000  -2.267671349478 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.200000000000 AA    0.000000000000   0.000000000000   2.267671349478 Bohr   0.0

nuclear repulsion = 1.98441454095
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        39.04


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp_rn5dhp2
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.68989122905533
  HOMO = -0.162207801959195  LUMO = -0.038504627347627
cycle= 1 E= -3.6649611755832  delta_E= 0.0249  |g|= 0.14  |ddm|=  1.2
  HOMO = -0.319391836868398  LUMO = -0.00852719101709604
cycle= 2 E= -3.67102768867641  delta_E= -0.00607  |g|= 0.0102  |ddm|=  0.1
  HOMO = -0.31300224212289  LUMO = -0.00105317248393114
cycle= 3 E= -3.67105706742864  delta_E= -2.94e-05  |g|= 0.00167  |ddm|= 0.0101
  HOMO = -0.312837507728046  LUMO = -0.000965949682501485
cycle= 4 E= -3.67105806654039  delta_E= -9.99e-07  |g|= 7.39e-05  |ddm|= 0.00221
  HOMO = -0.312839574767688  LUMO = -0.000986632237173565
cycle= 5 E= -3.67105806957357  delta_E= -3.03e-09  |g|= 1.11e-05  |ddm|= 0.000105
  HOMO = -0.312838698651814  LUMO = -0.000987777239202784
cycle= 6 E= -3.67105806962864  delta_E= -5.51e-11  |g|= 4.82e-07  |ddm|= 1.37e-05
  HOMO = -0.312838645155007  LUMO = -0.000987808431992217
Extra cycle  E= -3.67105806962873  delta_E= -8.44e-14  |g|= 1.15e-07  |ddm|= 4.79e-07
converged SCF energy = -3.67105806962873

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp_rn5dhp2
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.52209792547537  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -3.52409365990790  dE = -1.99573443e-03  S^2 = 0.0000000
               |grad[o]|=0.0467  |ddm|=2.48e-16  |maxRot[o]|=0.0379
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.52409526145400  dE = -1.60154611e-06  S^2 = 0.0000000
               |grad[o]|=0.00117  |ddm|=2.22e-16  |maxRot[o]|=0.00123
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.52409526145400  dE =  8.88178420e-16  S^2 = 0.0000000
               |grad[o]|=5.81e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.52409526145400
CASCI E = -3.52409526145400  E(CI) = -0.891969017212937  S^2 = 0.0000000
CASCI state-averaged energy = -3.524095261454
CASCI energy for each state
  State 0 weight 0.333333  E = -3.73893235156064 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.43875111584022 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.39460231696115 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp_rn5dhp2
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.72560245662374  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    3 micro), CASSCF E = -3.75097139630493  dE = -2.53689397e-02  S^2 = 2.0000000
               |grad[o]|=0.131  |ddm|=    0  |maxRot[o]|= 0.17
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.75097179768909  dE = -4.01384156e-07  S^2 = 2.0000000
               |grad[o]|=0.000776  |ddm|=    0  |maxRot[o]|=0.00035
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.75097179768909  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=2.86e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.75097179768909
CASCI E = -3.75097179768909  E(CI) = -1.10258887485622  S^2 = 2.0000000
CASCI state-averaged energy = -3.75097179768909
CASCI energy for each state
  State 0 weight 1  E = -3.75097179768909 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:34 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.300000000000 AA    0.000000000000   0.000000000000  -2.456643961935 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.300000000000 AA    0.000000000000   0.000000000000   2.456643961935 Bohr   0.0

nuclear repulsion = 1.83176726856923
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        43.89


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmphu2l3348
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.64227159002224
  HOMO = -0.167604325747284  LUMO = -0.0703370009311576
cycle= 1 E= -3.66154644648808  delta_E= -0.0193  |g|= 0.114  |ddm|= 1.14
  HOMO = -0.31201100554313  LUMO = -0.0347678846571121
cycle= 2 E= -3.66564829459545  delta_E= -0.0041  |g|= 0.00839  |ddm|= 0.08
  HOMO = -0.308292929553763  LUMO = -0.0302096965926038
cycle= 3 E= -3.66567138184721  delta_E= -2.31e-05  |g|= 0.00139  |ddm|= 0.00892
  HOMO = -0.308232965055429  LUMO = -0.0302348036465584
cycle= 4 E= -3.66567214305278  delta_E= -7.61e-07  |g|= 9.39e-05  |ddm|= 0.0019
  HOMO = -0.308227747667371  LUMO = -0.030250313217024
cycle= 5 E= -3.66567214801189  delta_E= -4.96e-09  |g|= 1.02e-05  |ddm|= 0.000122
  HOMO = -0.308226651107165  LUMO = -0.0302507805065697
cycle= 6 E= -3.66567214805467  delta_E= -4.28e-11  |g|= 3.06e-07  |ddm|= 1.17e-05
  HOMO = -0.308226643714127  LUMO = -0.0302507863651401
Extra cycle  E= -3.6656721480547  delta_E= -3.11e-14  |g|= 6.04e-08  |ddm|= 2.98e-07
converged SCF energy = -3.6656721480547

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmphu2l3348
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53319512912755  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -3.53514670028708  dE = -1.95157116e-03  S^2 = 0.0000000
               |grad[o]|=0.0455  |ddm|=2.22e-16  |maxRot[o]|=0.0375
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.53514801091124  dE = -1.31062417e-06  S^2 = 0.0000000
               |grad[o]|=0.00103  |ddm|=4e-16  |maxRot[o]|=0.00114
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.53514801091124  dE =  4.44089210e-16  S^2 = 0.0000000
               |grad[o]|=8.73e-06  |ddm|=3.33e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.53514801091124
CASCI E = -3.53514801091124  E(CI) = -0.885489224466265  S^2 = 0.0000000
CASCI state-averaged energy = -3.53514801091124
CASCI energy for each state
  State 0 weight 0.333333  E = -3.75464472361425 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.43904284263891 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.41175646648057 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmphu2l3348
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.75268687068273  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -3.77731384473029  dE = -2.46269740e-02  S^2 = 2.0000000
               |grad[o]|= 0.13  |ddm|=    0  |maxRot[o]|=0.159
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.77731429504790  dE = -4.50317609e-07  S^2 = 2.0000000
               |grad[o]|=0.000817  |ddm|=    0  |maxRot[o]|=0.000402
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.77731429504790  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=3.9e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.77731429504790
CASCI E = -3.77731429504790  E(CI) = -1.11476953996345  S^2 = 2.0000000
CASCI state-averaged energy = -3.7773142950479
CASCI energy for each state
  State 0 weight 1  E = -3.7773142950479 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:36 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.400000000000 AA    0.000000000000   0.000000000000  -2.645616574391 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.400000000000 AA    0.000000000000   0.000000000000   2.645616574391 Bohr   0.0

nuclear repulsion = 1.70092674938571
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        48.63


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpp2isiq96
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.60641856485355
  HOMO = -0.171527856213208  LUMO = -0.0965118700467596
cycle= 1 E= -3.65665716952643  delta_E= -0.0502  |g|= 0.0913  |ddm|=  1.1
  HOMO = -0.305370710823266  LUMO = -0.0576315764211355
cycle= 2 E= -3.65935387916114  delta_E= -0.0027  |g|= 0.00703  |ddm|= 0.0669
  HOMO = -0.303646704730113  LUMO = -0.0553471042171994
cycle= 3 E= -3.65937274696488  delta_E= -1.89e-05  |g|= 0.00114  |ddm|= 0.00802
  HOMO = -0.303670091166769  LUMO = -0.0554538869077439
cycle= 4 E= -3.65937331425317  delta_E= -5.67e-07  |g|= 0.000103  |ddm|= 0.00159
  HOMO = -0.303660387217442  LUMO = -0.0554641723981152
cycle= 5 E= -3.65937332043434  delta_E= -6.18e-09  |g|= 7.64e-06  |ddm|= 0.000135
  HOMO = -0.303659576993753  LUMO = -0.0554643353117303
cycle= 6 E= -3.65937332045661  delta_E= -2.23e-11  |g|= 1.9e-07  |ddm|= 8.29e-06
  HOMO = -0.303659591264869  LUMO = -0.055464334992257
Extra cycle  E= -3.65937332045663  delta_E= -1.15e-14  |g|= 3.28e-08  |ddm|= 1.94e-07
converged SCF energy = -3.65937332045663

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpp2isiq96
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54054266925494  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    3 micro), CASSCF E = -3.54248478887684  dE = -1.94211962e-03  S^2 = 0.0000000
               |grad[o]|=0.0445  |ddm|=4e-16  |maxRot[o]|=0.0359
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54248582331770  dE = -1.03444086e-06  S^2 = 0.0000000
               |grad[o]|=0.000902  |ddm|=4.46e-30  |maxRot[o]|=0.00103
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.54248582331770  dE = -4.44089210e-16  S^2 = 0.0000000
               |grad[o]|=8.31e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54248582331770
CASCI E = -3.54248582331770  E(CI) = -0.877719667223862  S^2 = 0.0000000
CASCI state-averaged energy = -3.5424858233177
CASCI energy for each state
  State 0 weight 0.333333  E = -3.76863447675823 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.43765140419243 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.42117158900244 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpp2isiq96
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.77339286229954  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -3.79720762615709  dE = -2.38147639e-02  S^2 = 2.0000000
               |grad[o]|=0.128  |ddm|=    0  |maxRot[o]|=0.149
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.79720790628150  dE = -2.80124413e-07  S^2 = 2.0000000
               |grad[o]|=0.000671  |ddm|=    0  |maxRot[o]|=0.000368
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.79720790628150  dE = -4.44089210e-16  S^2 = 2.0000000
               |grad[o]|=3.71e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.79720790628150
CASCI E = -3.79720790628150  E(CI) = -1.12273010970199  S^2 = 2.0000000
CASCI state-averaged energy = -3.7972079062815
CASCI energy for each state
  State 0 weight 1  E = -3.7972079062815 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:37 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.500000000000 AA    0.000000000000   0.000000000000  -2.834589186848 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.500000000000 AA    0.000000000000   0.000000000000   2.834589186848 Bohr   0.0

nuclear repulsion = 1.58753163276
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        53.46


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpqqt3v2xu
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.57965258190631
  HOMO = -0.17438715020202  LUMO = -0.117327552051225
cycle= 1 E= -3.65133946920334  delta_E= -0.0717  |g|= 0.0727  |ddm|= 1.07
  HOMO = -0.299546883318861  LUMO = -0.0770999325290774
cycle= 2 E= -3.65309783060358  delta_E= -0.00176  |g|= 0.00601  |ddm|= 0.0589
  HOMO = -0.299237587810069  LUMO = -0.076442798222027
cycle= 3 E= -3.65311337746227  delta_E= -1.55e-05  |g|= 0.000904  |ddm|= 0.00749
  HOMO = -0.299318271806862  LUMO = -0.0765958492894749
cycle= 4 E= -3.65311377235038  delta_E= -3.95e-07  |g|= 9.95e-05  |ddm|= 0.00129
  HOMO = -0.299307296697392  LUMO = -0.0766017540041344
cycle= 5 E= -3.6531137783295  delta_E= -5.98e-09  |g|= 5.31e-06  |ddm|= 0.000134
  HOMO = -0.299306702538665  LUMO = -0.0766017297707458
cycle= 6 E= -3.65311377833968  delta_E= -1.02e-11  |g|= 1.12e-07  |ddm|= 5.49e-06
  HOMO = -0.299306720401988  LUMO = -0.0766017265002851
Extra cycle  E= -3.65311377833969  delta_E= -4.44e-15  |g|= 1.94e-08  |ddm|= 1.26e-07
converged SCF energy = -3.65311377833969

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpqqt3v2xu
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54520609640049  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54714318567670  dE = -1.93708928e-03  S^2 = 0.0000000
               |grad[o]|=0.0436  |ddm|=3.14e-16  |maxRot[o]|=0.0333
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54714345606690  dE = -2.70390206e-07  S^2 = 0.0000000
               |grad[o]|=0.000559  |ddm|=2.22e-16  |maxRot[o]|=0.000597
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.54714345606690  dE =  4.44089210e-16  S^2 = 0.0000000
               |grad[o]|=2.82e-06  |ddm|=1.11e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro (  8 JK   3 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54714345606690
CASCI E = -3.54714345606690  E(CI) = -0.869221839002079  S^2 = 0.0000000
CASCI state-averaged energy = -3.5471434560669
CASCI energy for each state
  State 0 weight 0.333333  E = -3.78066943205918 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.43528229978308 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.42547863635845 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpqqt3v2xu
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.78913758237391  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 12 JK    3 micro), CASSCF E = -3.81213519307313  dE = -2.29976107e-02  S^2 = 2.0000000
               |grad[o]|=0.126  |ddm|=    0  |maxRot[o]|= 0.14
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.81213591866662  dE = -7.25593495e-07  S^2 = 2.0000000
               |grad[o]|=0.000924  |ddm|=    0  |maxRot[o]|=0.000484
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.81213591866662  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=7.02e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 16 JK   5 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.81213591866662
CASCI E = -3.81213591866662  E(CI) = -1.12718777974706  S^2 = 2.0000000
CASCI state-averaged energy = -3.81213591866662
CASCI energy for each state
  State 0 weight 1  E = -3.81213591866662 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:38 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.600000000000 AA    0.000000000000   0.000000000000  -3.023561799304 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.600000000000 AA    0.000000000000   0.000000000000   3.023561799304 Bohr   0.0

nuclear repulsion = 1.4883109057125
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        57.42


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpzy8stlsv
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.55979458234643
  HOMO = -0.176477333253723  LUMO = -0.133499205427013
cycle= 1 E= -3.64612221975959  delta_E= -0.0863  |g|= 0.0581  |ddm|= 1.04
  HOMO = -0.294491046013726  LUMO = -0.0934403278153031
cycle= 2 E= -3.64729322182749  delta_E= -0.00117  |g|= 0.00525  |ddm|= 0.0544
  HOMO = -0.295141958016555  LUMO = -0.0938730761486684
cycle= 3 E= -3.64730601648024  delta_E= -1.28e-05  |g|= 0.000691  |ddm|= 0.00729
  HOMO = -0.295252574061071  LUMO = -0.0940397278745085
cycle= 4 E= -3.64730626368237  delta_E= -2.47e-07  |g|= 8.5e-05  |ddm|= 0.00101
  HOMO = -0.295243005930529  LUMO = -0.094042808671851
cycle= 5 E= -3.64730626831075  delta_E= -4.63e-09  |g|= 3.61e-06  |ddm|= 0.000119
  HOMO = -0.295242460416129  LUMO = -0.0940426093140066
cycle= 6 E= -3.64730626831547  delta_E= -4.72e-12  |g|= 5.48e-08  |ddm|= 3.73e-06
  HOMO = -0.295242474431103  LUMO = -0.0940426038129364
Extra cycle  E= -3.64730626831547  delta_E= -2.66e-15  |g|= 1.12e-08  |ddm|= 6.67e-08
converged SCF energy = -3.64730626831547

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpzy8stlsv
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54792952244285  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54985762234223  dE = -1.92809990e-03  S^2 = 0.0000000
               |grad[o]|=0.0427  |ddm|=2.22e-16  |maxRot[o]|=0.0305
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54985781642890  dE = -1.94086675e-07  S^2 = 0.0000000
               |grad[o]|=0.000479  |ddm|=2.48e-16  |maxRot[o]|=0.000512
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.54985781642890  dE =  4.44089210e-16  S^2 = 0.0000000
               |grad[o]|=2.32e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro (  8 JK   3 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54985781642890
CASCI E = -3.54985781642890  E(CI) = -0.860417855556636  S^2 = 0.0000000
CASCI state-averaged energy = -3.5498578164289
CASCI energy for each state
  State 0 weight 0.333333  E = -3.7906421620941 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.43235165217623 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.42657963501637 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpzy8stlsv
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.80105758331812  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -3.82327339209713  dE = -2.22158088e-02  S^2 = 2.0000000
               |grad[o]|=0.124  |ddm|=    0  |maxRot[o]|=0.133
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.82327398309762  dE = -5.91000497e-07  S^2 = 2.0000000
               |grad[o]|=0.000808  |ddm|=    0  |maxRot[o]|=0.000422
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.82327398309762  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=4.51e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.82327398309762
CASCI E = -3.82327398309762  E(CI) = -1.12891907390812  S^2 = 2.0000000
CASCI state-averaged energy = -3.82327398309762
CASCI energy for each state
  State 0 weight 1  E = -3.82327398309762 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:39 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.700000000000 AA    0.000000000000   0.000000000000  -3.212534411761 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.700000000000 AA    0.000000000000   0.000000000000   3.212534411761 Bohr   0.0

nuclear repulsion = 1.40076320537647
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        61.58


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpurlm460q
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.54513584252863
  HOMO = -0.178012236299108  LUMO = -0.145860822238377
cycle= 1 E= -3.64124687415652  delta_E= -0.0961  |g|= 0.0472  |ddm|= 1.03
  HOMO = -0.290098670641873  LUMO = -0.107038775005533
cycle= 2 E= -3.64206901979974  delta_E= -0.000822  |g|= 0.00468  |ddm|= 0.0522
  HOMO = -0.291379243227611  LUMO = -0.108168518785964
cycle= 3 E= -3.64207968062306  delta_E= -1.07e-05  |g|= 0.000503  |ddm|= 0.00732
  HOMO = -0.291494752729656  LUMO = -0.108323445675092
cycle= 4 E= -3.64207981679259  delta_E= -1.36e-07  |g|= 6.53e-05  |ddm|= 0.000759
  HOMO = -0.291488095785473  LUMO = -0.108325237824295
cycle= 5 E= -3.6420798197012  delta_E= -2.91e-09  |g|= 2.55e-06  |ddm|= 9.36e-05
  HOMO = -0.291487530377759  LUMO = -0.108324917837077
cycle= 6 E= -3.64207981970382  delta_E= -2.62e-12  |g|= 2.4e-08  |ddm|= 2.94e-06
  HOMO = -0.291487540894221  LUMO = -0.108324912090729
Extra cycle  E= -3.64207981970382  delta_E= 8.88e-16  |g|= 5.74e-09  |ddm|= 3.55e-08
converged SCF energy = -3.64207981970382

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpurlm460q
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54924156157022  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    4 micro), CASSCF E = -3.55115629861193  dE = -1.91473704e-03  S^2 = 0.0000000
               |grad[o]|=0.0418  |ddm|=7.14e-29  |maxRot[o]|=0.0277
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.55115675275555  dE = -4.54143612e-07  S^2 = 0.0000000
               |grad[o]|=0.000604  |ddm|=1.78e-29  |maxRot[o]|=0.000577
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.55115675275555  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=9.56e-06  |ddm|=1.95e-30  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.55115675275555
CASCI E = -3.55115675275555  E(CI) = -0.851591237963902  S^2 = 0.0000000
CASCI state-averaged energy = -3.55115675275555
CASCI energy for each state
  State 0 weight 0.333333  E = -3.7986526551111 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.42909548631957 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.42572211683597 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpurlm460q
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.81003906279019  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -3.83153765768408  dE = -2.14985949e-02  S^2 = 2.0000000
               |grad[o]|=0.122  |ddm|=    0  |maxRot[o]|=0.128
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.83153812599375  dE = -4.68309668e-07  S^2 = 2.0000000
               |grad[o]|=0.000712  |ddm|=    0  |maxRot[o]|=0.00037
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.83153812599375  dE =  4.44089210e-16  S^2 = 2.0000000
               |grad[o]|=3.51e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.83153812599375
CASCI E = -3.83153812599375  E(CI) = -1.12863517048668  S^2 = 2.0000000
CASCI state-averaged energy = -3.83153812599375
CASCI energy for each state
  State 0 weight 1  E = -3.83153812599375 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:41 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.800000000000 AA    0.000000000000   0.000000000000  -3.401507024217 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.800000000000 AA    0.000000000000   0.000000000000   3.401507024217 Bohr   0.0

nuclear repulsion = 1.3229430273
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        67.18


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpffe2racp
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.53436785561271
  HOMO = -0.179146908608687  LUMO = -0.155205946194012
cycle= 1 E= -3.63680262685571  delta_E= -0.102  |g|= 0.0394  |ddm|= 1.01
  HOMO = -0.286253666263384  LUMO = -0.118308120846995
cycle= 2 E= -3.63742434406622  delta_E= -0.000622  |g|= 0.00426  |ddm|= 0.0511
  HOMO = -0.287937019435835  LUMO = -0.119872106943945
cycle= 3 E= -3.63743349971522  delta_E= -9.16e-06  |g|= 0.00035  |ddm|= 0.00746
  HOMO = -0.28803874276786  LUMO = -0.119999770556802
cycle= 4 E= -3.63743356541408  delta_E= -6.57e-08  |g|= 4.52e-05  |ddm|= 0.000548
  HOMO = -0.288035181176458  LUMO = -0.120001187826576
cycle= 5 E= -3.63743356688907  delta_E= -1.47e-09  |g|= 2e-06  |ddm|= 6.54e-05
  HOMO = -0.288034618090113  LUMO = -0.120000837063555
cycle= 6 E= -3.63743356689106  delta_E= -1.99e-12  |g|= 2.98e-08  |ddm|= 2.72e-06
  HOMO = -0.288034629982973  LUMO = -0.120000835006994
Extra cycle  E= -3.63743356689106  delta_E= 1.78e-15  |g|= 4.73e-09  |ddm|= 4.43e-08
converged SCF energy = -3.63743356689106

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpffe2racp
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54952778135397  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    4 micro), CASSCF E = -3.55142598219309  dE = -1.89820084e-03  S^2 = 0.0000000
               |grad[o]|=0.0411  |ddm|=2.22e-16  |maxRot[o]|=0.0296
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.55142635586543  dE = -3.73672342e-07  S^2 = 0.0000000
               |grad[o]|=0.000557  |ddm|=2.22e-16  |maxRot[o]|=0.000429
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.55142635586543  dE = -8.88178420e-16  S^2 = 0.0000000
               |grad[o]|=6.75e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.55142635586543
CASCI E = -3.55142635586543  E(CI) = -0.842924363742455  S^2 = 0.0000000
CASCI state-averaged energy = -3.55142635586543
CASCI energy for each state
  State 0 weight 0.333333  E = -3.80493579314136 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.42565253404581 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.42369074040912 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpffe2racp
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.81677076056543  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -3.83763849169370  dE = -2.08677311e-02  S^2 = 2.0000000
               |grad[o]|= 0.12  |ddm|=    0  |maxRot[o]|=0.124
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.83763886307825  dE = -3.71384552e-07  S^2 = 2.0000000
               |grad[o]|=0.000626  |ddm|=    0  |maxRot[o]|=0.000337
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.83763886307825  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=3.72e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.83763886307825
CASCI E = -3.83763886307825  E(CI) = -1.12693279333216  S^2 = 2.0000000
CASCI state-averaged energy = -3.83763886307825
CASCI energy for each state
  State 0 weight 1  E = -3.83763886307825 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:42 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.900000000000 AA    0.000000000000   0.000000000000  -3.590479636674 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr   0.0

nuclear repulsion = 1.25331444691579
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        72.64


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpeefb6gcz
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.52649966107313
  HOMO = -0.179992836426112  LUMO = -0.162218770758214
cycle= 1 E= -3.63279934246129  delta_E= -0.106  |g|= 0.0341  |ddm|= 1.01
  HOMO = -0.282850145283001  LUMO = -0.127640597171403
cycle= 2 E= -3.63330689470563  delta_E= -0.000508  |g|= 0.00395  |ddm|= 0.0506
  HOMO = -0.284785507851846  LUMO = -0.129471620022204
cycle= 3 E= -3.63331504575614  delta_E= -8.15e-06  |g|= 0.000234  |ddm|= 0.0076
  HOMO = -0.284864019613056  LUMO = -0.129566768672273
cycle= 4 E= -3.63331507390639  delta_E= -2.82e-08  |g|= 2.81e-05  |ddm|= 0.00038
  HOMO = -0.284862819675209  LUMO = -0.129568066206838
cycle= 5 E= -3.63331507449405  delta_E= -5.88e-10  |g|= 1.74e-06  |ddm|= 3.99e-05
  HOMO = -0.284862404141248  LUMO = -0.129567800151784
Extra cycle  E= -3.63331507449576  delta_E= -1.71e-12  |g|= 4.53e-07  |ddm|= 1.98e-06
converged SCF energy = -3.63331507449576

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpeefb6gcz
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54907443572655  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.55095386950466  dE = -1.87943378e-03  S^2 = 0.0000000
               |grad[o]|=0.0405  |ddm|=2.22e-16  |maxRot[o]|=0.0317
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.55095390853154  dE = -3.90268742e-08  S^2 = 0.0000000
               |grad[o]|=0.000251  |ddm|=5.35e-29  |maxRot[o]|=0.000207
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.55095390853154
CASCI E = -3.55095390853154  E(CI) = -0.834528018480991  S^2 = 0.0000000
CASCI state-averaged energy = -3.55095390853154
CASCI energy for each state
  State 0 weight 0.333333  E = -3.80977834333766 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.42211060536994 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.42097277688701 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpeefb6gcz
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.82178746681900  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -3.84212314639789  dE = -2.03356796e-02  S^2 = 2.0000000
               |grad[o]|=0.118  |ddm|=    0  |maxRot[o]|=0.121
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.84212344824109  dE = -3.01843204e-07  S^2 = 2.0000000
               |grad[o]|=0.000557  |ddm|=    0  |maxRot[o]|=0.000324
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.84212344824109  dE =  4.44089210e-16  S^2 = 2.0000000
               |grad[o]|=3.65e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.84212344824109
CASCI E = -3.84212344824109  E(CI) = -1.12428227800611  S^2 = 2.0000000
CASCI state-averaged energy = -3.84212344824109
CASCI energy for each state
  State 0 weight 1  E = -3.84212344824109 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:43 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.000000000000 AA    0.000000000000   0.000000000000  -3.779452249130 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr   0.0

nuclear repulsion = 1.19064872457
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        76.47


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpyehew_5l
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.52078136596289
  HOMO = -0.180628935177126  LUMO = -0.167456651587941
cycle= 1 E= -3.6292058644456  delta_E= -0.108  |g|= 0.0304  |ddm|= 0.999
  HOMO = -0.279799621539845  LUMO = -0.135385326675811
cycle= 2 E= -3.6296471532909  delta_E= -0.000441  |g|= 0.00371  |ddm|= 0.0503
  HOMO = -0.281887955295082  LUMO = -0.137378614301324
cycle= 3 E= -3.62965462190883  delta_E= -7.47e-06  |g|= 0.000153  |ddm|= 0.00769
  HOMO = -0.28194261341414  LUMO = -0.137444169053939
cycle= 4 E= -3.62965463309506  delta_E= -1.12e-08  |g|= 1.52e-05  |ddm|= 0.000255
  HOMO = -0.28194276834749  LUMO = -0.137445284292417
cycle= 5 E= -3.62965463326804  delta_E= -1.73e-10  |g|= 1.5e-06  |ddm|= 2.05e-05
  HOMO = -0.28194245897041  LUMO = -0.137445108829891
Extra cycle  E= -3.62965463326952  delta_E= -1.48e-12  |g|= 4.24e-07  |ddm|= 1.72e-06
converged SCF energy = -3.62965463326952

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpyehew_5l
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54809369693245  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54995294852987  dE = -1.85925160e-03  S^2 = 0.0000000
               |grad[o]|= 0.04  |ddm|=2.22e-16  |maxRot[o]|=0.0327
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54995296936826  dE = -2.08383857e-08  S^2 = 0.0000000
               |grad[o]|=0.000197  |ddm|=    0  |maxRot[o]|=0.000131
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54995296936826
CASCI E = -3.54995296936826  E(CI) = -0.826464184051642  S^2 = 0.0000000
CASCI state-averaged energy = -3.54995296936826
CASCI energy for each state
  State 0 weight 0.333333  E = -3.81345817826124 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.41853013543134 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.4178705944122 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpyehew_5l
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.82550240487663  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 13 JK    4 micro), CASSCF E = -3.84540729475435  dE = -1.99048899e-02  S^2 = 2.0000000
               |grad[o]|=0.117  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.84540754513196  dE = -2.50377602e-07  S^2 = 2.0000000
               |grad[o]|=0.000501  |ddm|=    0  |maxRot[o]|=0.000312
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.84540754513196  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=2.68e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 17 JK   6 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.84540754513196
CASCI E = -3.84540754513196  E(CI) = -1.12103644329803  S^2 = 2.0000000
CASCI state-averaged energy = -3.84540754513196
CASCI energy for each state
  State 0 weight 1  E = -3.84540754513196 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:44 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.100000000000 AA    0.000000000000   0.000000000000  -3.968424861587 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.100000000000 AA    0.000000000000   0.000000000000   3.968424861587 Bohr   0.0

nuclear repulsion = 1.13395116625714
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        80.48


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp2xx3tcr0
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51664422464009
  HOMO = -0.181110313210348  LUMO = -0.171357860679087
cycle= 1 E= -3.625972313148  delta_E= -0.109  |g|= 0.028  |ddm|= 0.995
  HOMO = -0.277031543101581  LUMO = -0.141840205145885
cycle= 2 E= -3.62637341571645  delta_E= -0.000401  |g|= 0.00352  |ddm|= 0.05
  HOMO = -0.279208694101186  LUMO = -0.143930381212527
cycle= 3 E= -3.62638038074846  delta_E= -6.97e-06  |g|= 0.000103  |ddm|= 0.00771
  HOMO = -0.279243998754658  LUMO = -0.14397328479232
cycle= 4 E= -3.62638038528261  delta_E= -4.53e-09  |g|= 7e-06  |ddm|= 0.000171
  HOMO = -0.279244700960268  LUMO = -0.143974149558774
cycle= 5 E= -3.62638038531531  delta_E= -3.27e-11  |g|= 9.67e-07  |ddm|= 8.62e-06
  HOMO = -0.279244528653128  LUMO = -0.143974066957901
Extra cycle  E= -3.62638038531599  delta_E= -6.76e-13  |g|= 2.84e-07  |ddm|= 1.08e-06
converged SCF energy = -3.62638038531599

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp2xx3tcr0
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54674132007239  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54858059880829  dE = -1.83927874e-03  S^2 = 0.0000000
               |grad[o]|=0.0396  |ddm|=1.46e-25  |maxRot[o]|=0.0333
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54858061053281  dE = -1.17245254e-08  S^2 = 0.0000000
               |grad[o]|=0.000156  |ddm|=2.22e-16  |maxRot[o]|=7.52e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54858061053281
CASCI E = -3.54858061053281  E(CI) = -0.818761110619378  S^2 = 0.0000000
CASCI state-averaged energy = -3.54858061053281
CASCI energy for each state
  State 0 weight 0.333333  E = -3.81621856599366 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.41495297099742 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.41457029460736 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp2xx3tcr0
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.82823269244594  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.84779983210930  dE = -1.95671397e-02  S^2 = 2.0000000
               |grad[o]|=0.116  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.84780212751802  dE = -2.29540872e-06  S^2 = 2.0000000
               |grad[o]|=0.00139  |ddm|=    0  |maxRot[o]|=0.00105
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.84780212751802  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=2.95e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.84780212751802
CASCI E = -3.84780212751802  E(CI) = -1.11744978395856  S^2 = 2.0000000
CASCI state-averaged energy = -3.84780212751802
CASCI energy for each state
  State 0 weight 1  E = -3.84780212751802 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:45 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.200000000000 AA    0.000000000000   0.000000000000  -4.157397474043 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.200000000000 AA    0.000000000000   0.000000000000   4.157397474043 Bohr   0.0

nuclear repulsion = 1.08240793142727
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        83.66


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpwdqemz98
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.5136584512937
  HOMO = -0.181475450404588  LUMO = -0.174259222111897
cycle= 1 E= -3.62304487834971  delta_E= -0.109  |g|= 0.0264  |ddm|= 0.991
  HOMO = -0.274491589320433  LUMO = -0.147252213295294
cycle= 2 E= -3.62342012327879  delta_E= -0.000375  |g|= 0.00337  |ddm|= 0.0498
  HOMO = -0.276717367599816  LUMO = -0.149399092273182
cycle= 3 E= -3.62342667936503  delta_E= -6.56e-06  |g|= 7.32e-05  |ddm|= 0.00766
  HOMO = -0.276739006105913  LUMO = -0.149426509693264
cycle= 4 E= -3.62342668150926  delta_E= -2.14e-09  |g|= 3.09e-06  |ddm|= 0.000119
  HOMO = -0.276739844552484  LUMO = -0.149427171832488
cycle= 5 E= -3.62342668151302  delta_E= -3.75e-12  |g|= 2.2e-07  |ddm|= 3.82e-06
  HOMO = -0.276739763722542  LUMO = -0.149427131391568
Extra cycle  E= -3.62342668151305  delta_E= -3.55e-14  |g|= 6.28e-08  |ddm|= 2.31e-07
converged SCF energy = -3.62342668151305

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpwdqemz98
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54513160935412  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54695212490918  dE = -1.82051556e-03  S^2 = 0.0000000
               |grad[o]|=0.0392  |ddm|=2.22e-16  |maxRot[o]|=0.0336
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54695213234178  dE = -7.43260253e-09  S^2 = 0.0000000
               |grad[o]|=0.000126  |ddm|=2.22e-16  |maxRot[o]|=3.99e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54695213234178
CASCI E = -3.54695213234178  E(CI) = -0.811424781664901  S^2 = 0.0000000
CASCI state-averaged energy = -3.54695213234178
CASCI energy for each state
  State 0 weight 0.333333  E = -3.81826304544792 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.41140785656393 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.41118549501349 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpwdqemz98
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83022128058643  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.84953614880688  dE = -1.93148682e-02  S^2 = 2.0000000
               |grad[o]|=0.115  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.84953806560005  dE = -1.91679318e-06  S^2 = 2.0000000
               |grad[o]|=0.00125  |ddm|=    0  |maxRot[o]|=0.000996
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.84953806560005  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=2.36e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.84953806560005
CASCI E = -3.84953806560005  E(CI) = -1.11370017933180  S^2 = 2.0000000
CASCI state-averaged energy = -3.84953806560005
CASCI energy for each state
  State 0 weight 1  E = -3.84953806560005 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:46 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.300000000000 AA    0.000000000000   0.000000000000  -4.346370086500 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.300000000000 AA    0.000000000000   0.000000000000   4.346370086500 Bohr   0.0

nuclear repulsion = 1.03534671701739
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        86.82


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmps9kefvb7
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51150364206229
  HOMO = -0.181751733499305  LUMO = -0.176415681617095
cycle= 1 E= -3.62037511925811  delta_E= -0.109  |g|= 0.0253  |ddm|= 0.989
  HOMO = -0.272139351071046  LUMO = -0.151822317578288
cycle= 2 E= -3.62073269853723  delta_E= -0.000358  |g|= 0.00324  |ddm|= 0.0496
  HOMO = -0.274389765307599  LUMO = -0.154001834872481
cycle= 3 E= -3.62073890156748  delta_E= -6.2e-06  |g|= 5.61e-05  |ddm|= 0.00757
  HOMO = -0.274402449780433  LUMO = -0.154019304979374
cycle= 4 E= -3.62073890281396  delta_E= -1.25e-09  |g|= 2.56e-06  |ddm|= 8.67e-05
  HOMO = -0.274403303565469  LUMO = -0.154019852260091
cycle= 5 E= -3.6207389028169  delta_E= -2.94e-12  |g|= 2.32e-07  |ddm|= 3.47e-06
  HOMO = -0.274403237490382  LUMO = -0.154019809188237
Extra cycle  E= -3.62073890281695  delta_E= -4.62e-14  |g|= 6.72e-08  |ddm|= 2.63e-07
converged SCF energy = -3.62073890281695

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmps9kefvb7
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54334995714988  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54515349030324  dE = -1.80353315e-03  S^2 = 0.0000000
               |grad[o]|=0.0389  |ddm|=4.71e-16  |maxRot[o]|=0.0336
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54515349569551  dE = -5.39227374e-09  S^2 = 0.0000000
               |grad[o]|=0.000105  |ddm|=2.22e-16  |maxRot[o]|=3.78e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54515349569551
CASCI E = -3.54515349569551  E(CI) = -0.804448929871690  S^2 = 0.0000000
CASCI state-averaged energy = -3.54515349569551
CASCI energy for each state
  State 0 weight 0.333333  E = -3.81975809406073 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.40791583622358 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.40778655680223 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmps9kefvb7
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83165488712813  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85078557415577  dE = -1.91306870e-02  S^2 = 2.0000000
               |grad[o]|=0.114  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85078727195724  dE = -1.69780147e-06  S^2 = 2.0000000
               |grad[o]|=0.00116  |ddm|=    0  |maxRot[o]|=0.000971
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85078727195724  dE =  8.88178420e-16  S^2 = 2.0000000
               |grad[o]|=1.97e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85078727195724
CASCI E = -3.85078727195724  E(CI) = -1.10990924341829  S^2 = 2.0000000
CASCI state-averaged energy = -3.85078727195724
CASCI energy for each state
  State 0 weight 1  E = -3.85078727195724 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:47 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.400000000000 AA    0.000000000000   0.000000000000  -4.535342698956 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.400000000000 AA    0.000000000000   0.000000000000   4.535342698956 Bohr   0.0

nuclear repulsion = 0.992207270475
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        90.06


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpbl9y8thq
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50994567955587
  HOMO = -0.181959319674286  LUMO = -0.178018251687607
cycle= 1 E= -3.61792406477422  delta_E= -0.108  |g|= 0.0245  |ddm|= 0.987
  HOMO = -0.269945797779708  LUMO = -0.155712280967784
cycle= 2 E= -3.61826896984222  delta_E= -0.000345  |g|= 0.00313  |ddm|= 0.0494
  HOMO = -0.272207266098356  LUMO = -0.157910409568811
cycle= 3 E= -3.61827486137283  delta_E= -5.89e-06  |g|= 4.51e-05  |ddm|= 0.00745
  HOMO = -0.272214255278577  LUMO = -0.157921623278354
cycle= 4 E= -3.61827486218819  delta_E= -8.15e-10  |g|= 2.53e-06  |ddm|= 6.62e-05
  HOMO = -0.272214975645684  LUMO = -0.15792204211591
Extra cycle  E= -3.61827486219189  delta_E= -3.7e-12  |g|= 5.63e-07  |ddm|= 2.98e-06
converged SCF energy = -3.61827486219189

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpbl9y8thq
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.54146176317885  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54325031005276  dE = -1.78854687e-03  S^2 = 0.0000000
               |grad[o]|=0.0387  |ddm|=1.11e-16  |maxRot[o]|=0.0336
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54325031435447  dE = -4.30171543e-09  S^2 = 0.0000000
               |grad[o]|=9.05e-05  |ddm|=4.97e-16  |maxRot[o]|=3.53e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54325031435447
CASCI E = -3.54325031435447  E(CI) = -0.797821818961055  S^2 = 0.0000000
CASCI state-averaged energy = -3.54325031435447
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82083820477341 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.40449388228215 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.40441885600786 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpbl9y8thq
max_memory 40000 MB (current use 141 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83267753894951  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85167727473847  dE = -1.89997358e-02  S^2 = 2.0000000
               |grad[o]|=0.114  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85167881443640  dE = -1.53969792e-06  S^2 = 2.0000000
               |grad[o]|=0.00109  |ddm|=    0  |maxRot[o]|=0.000954
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85167881443640  dE =  8.88178420e-16  S^2 = 2.0000000
               |grad[o]|=1.64e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85167881443640
CASCI E = -3.85167881443640  E(CI) = -1.10615863312968  S^2 = 2.0000000
CASCI state-averaged energy = -3.8516788144364
CASCI energy for each state
  State 0 weight 1  E = -3.8516788144364 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:48 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.500000000000 AA    0.000000000000   0.000000000000  -4.724315311413 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.500000000000 AA    0.000000000000   0.000000000000   4.724315311413 Bohr   0.0

nuclear repulsion = 0.952518979656
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        93.29


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp1ke4l620
max_memory 40000 MB (current use 141 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.5088166494123
  HOMO = -0.182113591320753  LUMO = -0.179209093653251
cycle= 1 E= -3.61566224793918  delta_E= -0.107  |g|= 0.0239  |ddm|= 0.986
  HOMO = -0.26789068605256  LUMO = -0.159051646695094
cycle= 2 E= -3.61599774611739  delta_E= -0.000335  |g|= 0.00303  |ddm|= 0.0492
  HOMO = -0.27015595156155  LUMO = -0.16126039891014
cycle= 3 E= -3.61600336280565  delta_E= -5.62e-06  |g|= 3.69e-05  |ddm|= 0.00733
  HOMO = -0.270159319071556  LUMO = -0.161267638437077
cycle= 4 E= -3.61600336334925  delta_E= -5.44e-10  |g|= 2.11e-06  |ddm|= 5.17e-05
  HOMO = -0.270160007742664  LUMO = -0.161268032207379
Extra cycle  E= -3.61600336335201  delta_E= -2.76e-12  |g|= 4.85e-07  |ddm|= 2.46e-06
converged SCF energy = -3.61600336335201

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp1ke4l620
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53951783240339  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.54129334330036  dE = -1.77551090e-03  S^2 = 0.0000000
               |grad[o]|=0.0385  |ddm|=4.97e-16  |maxRot[o]|=0.0334
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.54129334689278  dE = -3.59242414e-09  S^2 = 0.0000000
               |grad[o]|=7.94e-05  |ddm|=1.11e-16  |maxRot[o]|=3.23e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54129334689278
CASCI E = -3.54129334689278  E(CI) = -0.791530054951485  S^2 = 0.0000000
CASCI state-averaged energy = -3.54129334689278
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82161042916289 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.40115645954553 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.40111315196993 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp1ke4l620
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83339991181617  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85230855440085  dE = -1.89086426e-02  S^2 = 2.0000000
               |grad[o]|=0.113  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85230998469789  dE = -1.43029705e-06  S^2 = 2.0000000
               |grad[o]|=0.00103  |ddm|=    0  |maxRot[o]|=0.000948
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85230998469789  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=1.44e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85230998469789
CASCI E = -3.85230998469789  E(CI) = -1.10250205519873  S^2 = 2.0000000
CASCI state-averaged energy = -3.85230998469789
CASCI energy for each state
  State 0 weight 1  E = -3.85230998469789 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:49 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.600000000000 AA    0.000000000000   0.000000000000  -4.913287923869 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.600000000000 AA    0.000000000000   0.000000000000   4.913287923869 Bohr   0.0

nuclear repulsion = 0.915883634284615
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        96.43


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpq451v1ed
max_memory 40000 MB (current use 143 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50799725278773
  HOMO = -0.182226625005609  LUMO = -0.180093597875707
cycle= 1 E= -3.61356762168801  delta_E= -0.106  |g|= 0.0235  |ddm|= 0.985
  HOMO = -0.265960094091058  LUMO = -0.161943978728548
cycle= 2 E= -3.61389598898363  delta_E= -0.000328  |g|= 0.00295  |ddm|= 0.0491
  HOMO = -0.268225563256192  LUMO = -0.164158906725549
cycle= 3 E= -3.61390136459647  delta_E= -5.38e-06  |g|= 3.04e-05  |ddm|= 0.00721
  HOMO = -0.268226588205589  LUMO = -0.164163542932666
cycle= 4 E= -3.61390136495312  delta_E= -3.57e-10  |g|= 1.5e-06  |ddm|= 4.08e-05
  HOMO = -0.268227248525148  LUMO = -0.164163926782306
Extra cycle  E= -3.61390136495447  delta_E= -1.35e-12  |g|= 3.29e-07  |ddm|= 1.72e-06
converged SCF energy = -3.61390136495447

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpq451v1ed
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53755732840781  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.53932160016028  dE = -1.76427175e-03  S^2 = 0.0000000
               |grad[o]|=0.0383  |ddm|=1.16e-24  |maxRot[o]|=0.0332
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.53932160320723  dE = -3.04695158e-09  S^2 = 0.0000000
               |grad[o]|=7.06e-05  |ddm|=3.33e-16  |maxRot[o]|=2.87e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.53932160320723
CASCI E = -3.53932160320723  E(CI) = -0.785560207354416  S^2 = 0.0000000
CASCI state-averaged energy = -3.53932160320723
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82215816000246 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.39791570384915 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.39789094577008 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpq451v1ed
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83390607714411  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85275233841681  dE = -1.88462613e-02  S^2 = 2.0000000
               |grad[o]|=0.113  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85275369501526  dE = -1.35659845e-06  S^2 = 2.0000000
               |grad[o]|=0.000993  |ddm|=    0  |maxRot[o]|=0.000944
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85275369501526  dE =  8.88178420e-16  S^2 = 2.0000000
               |grad[o]|=1.28e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85275369501526
CASCI E = -3.85275369501526  E(CI) = -1.09897359715720  S^2 = 2.0000000
CASCI state-averaged energy = -3.85275369501526
CASCI energy for each state
  State 0 weight 1  E = -3.85275369501526 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:49 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.700000000000 AA    0.000000000000   0.000000000000  -5.102260536326 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.700000000000 AA    0.000000000000   0.000000000000   5.102260536326 Bohr   0.0

nuclear repulsion = 0.8819620182
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        99.63


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp1v19s9g1
max_memory 40000 MB (current use 143 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50740247812268
  HOMO = -0.182308059337704  LUMO = -0.180749774491458
cycle= 1 E= -3.61162310543276  delta_E= -0.104  |g|= 0.0231  |ddm|= 0.984
  HOMO = -0.264144270442037  LUMO = -0.164472050445919
cycle= 2 E= -3.61194599859035  delta_E= -0.000323  |g|= 0.00288  |ddm|= 0.049
  HOMO = -0.266408381464386  LUMO = -0.166690743261516
cycle= 3 E= -3.61195116354673  delta_E= -5.16e-06  |g|= 2.52e-05  |ddm|= 0.00709
  HOMO = -0.266407850763356  LUMO = -0.166693600970717
cycle= 4 E= -3.6119511637802  delta_E= -2.33e-10  |g|= 9.06e-07  |ddm|= 3.23e-05
  HOMO = -0.266408486087601  LUMO = -0.166693979468594
Extra cycle  E= -3.61195116378063  delta_E= -4.33e-13  |g|= 1.73e-07  |ddm|= 1.02e-06
converged SCF energy = -3.61195116378063

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp1v19s9g1
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53560974301910  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.53736436661462  dE = -1.75462360e-03  S^2 = 0.0000000
               |grad[o]|=0.0382  |ddm|=2.22e-16  |maxRot[o]|=0.033
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.53736436920652  dE = -2.59190491e-09  S^2 = 0.0000000
               |grad[o]|=6.33e-05  |ddm|=2.22e-16  |maxRot[o]|=2.61e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.53736436920652
CASCI E = -3.53736436920652  E(CI) = -0.779899189029673  S^2 = 0.0000000
CASCI state-averaged energy = -3.53736436920652
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82254466211518 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.3947812002418 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.39476724526258 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp1v19s9g1
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83425859054902  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85306249024285  dE = -1.88038997e-02  S^2 = 2.0000000
               |grad[o]|=0.113  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85306379822241  dE = -1.30797956e-06  S^2 = 2.0000000
               |grad[o]|=0.000967  |ddm|=    0  |maxRot[o]|=0.000941
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85306379822241  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=1.04e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85306379822241
CASCI E = -3.85306379822241  E(CI) = -1.09559344119019  S^2 = 2.0000000
CASCI state-averaged energy = -3.85306379822241
CASCI energy for each state
  State 0 weight 1  E = -3.85306379822241 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:50 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.800000000000 AA    0.000000000000   0.000000000000  -5.291233148782 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.800000000000 AA    0.000000000000   0.000000000000   5.291233148782 Bohr   0.0

nuclear repulsion = 0.850463374692857
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       102.95


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmp8qud7h4y
max_memory 40000 MB (current use 143 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50697101132642
  HOMO = -0.182365623031561  LUMO = -0.18123540385657
cycle= 1 E= -3.60981469801995  delta_E= -0.103  |g|= 0.0229  |ddm|= 0.984
  HOMO = -0.262435924928918  LUMO = -0.166702021420096
cycle= 2 E= -3.61013335580204  delta_E= -0.000319  |g|= 0.00283  |ddm|= 0.049
  HOMO = -0.264698186970755  LUMO = -0.168923218324343
cycle= 3 E= -3.61013833654273  delta_E= -4.98e-06  |g|= 2.12e-05  |ddm|= 0.00699
  HOMO = -0.26469659122945  LUMO = -0.168924805931646
cycle= 4 E= -3.61013833670113  delta_E= -1.58e-10  |g|= 4.97e-07  |ddm|= 2.59e-05
  HOMO = -0.264697204975473  LUMO = -0.168925179377196
Extra cycle  E= -3.61013833670122  delta_E= -8.44e-14  |g|= 5.78e-08  |ddm|= 5.07e-07
converged SCF energy = -3.61013833670122

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp8qud7h4y
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53369657869227  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.53544293998027  dE = -1.74636129e-03  S^2 = 0.0000000
               |grad[o]|=0.038  |ddm|=2.22e-16  |maxRot[o]|=0.0329
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.53544294218550  dE = -2.20522578e-09  S^2 = 0.0000000
               |grad[o]|=5.71e-05  |ddm|=7.02e-16  |maxRot[o]|=2.56e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.53544294218550
CASCI E = -3.53544294218550  E(CI) = -0.774534123989397  S^2 = 0.0000000
CASCI state-averaged energy = -3.5354429421855
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82281664768425 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.39175995095228 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.39175222791996 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmp8qud7h4y
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83450298678019  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85327808672841  dE = -1.87750999e-02  S^2 = 2.0000000
               |grad[o]|=0.113  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85327936385843  dE = -1.27713003e-06  S^2 = 2.0000000
               |grad[o]|=0.000949  |ddm|=    0  |maxRot[o]|=0.000942
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85327936385843  dE =  4.44089210e-16  S^2 = 2.0000000
               |grad[o]|=8.24e-07  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85327936385843
CASCI E = -3.85327936385843  E(CI) = -1.09237186106601  S^2 = 2.0000000
CASCI state-averaged energy = -3.85327936385843
CASCI energy for each state
  State 0 weight 1  E = -3.85327936385843 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:51 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.900000000000 AA    0.000000000000   0.000000000000  -5.480205761239 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.900000000000 AA    0.000000000000   0.000000000000   5.480205761239 Bohr   0.0

nuclear repulsion = 0.821137051427586
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       106.13


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpkdq945bz
max_memory 40000 MB (current use 143 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50665805269423

WARN: HOMO -0.182405476261831 == LUMO -0.181593394948865

cycle= 1 E= -3.60813033805308  delta_E= -0.101  |g|= 0.0227  |ddm|= 0.983
  HOMO = -0.26082900365971  LUMO = -0.168686774941725
cycle= 2 E= -3.60844570062276  delta_E= -0.000315  |g|= 0.00277  |ddm|= 0.0489
  HOMO = -0.263089448174137  LUMO = -0.170909846699787
cycle= 3 E= -3.60845051947532  delta_E= -4.82e-06  |g|= 1.81e-05  |ddm|= 0.00689
  HOMO = -0.263087100756273  LUMO = -0.170910490575824
cycle= 4 E= -3.60845051959081  delta_E= -1.15e-10  |g|= 4.17e-07  |ddm|= 2.13e-05
  HOMO = -0.263087697248661  LUMO = -0.170910858924662
Extra cycle  E= -3.60845051959089  delta_E= -7.9e-14  |g|= 6.68e-08  |ddm|= 4.09e-07
converged SCF energy = -3.60845051959089

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpkdq945bz
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53183298928450  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.53357229132834  dE = -1.73930204e-03  S^2 = 0.0000000
               |grad[o]|=0.0379  |ddm|=2.48e-16  |maxRot[o]|=0.0327
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.53357229320824  dE = -1.87989535e-09  S^2 = 0.0000000
               |grad[o]|=5.16e-05  |ddm|=3.33e-16  |maxRot[o]|=2.47e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.53357229320824
CASCI E = -3.53357229320824  E(CI) = -0.769452122697588  S^2 = 0.0000000
CASCI state-averaged energy = -3.53357229320824
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82300780829693 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.38885662653969 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.3888524447881 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpkdq945bz
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83467176759561  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85342704298428  dE = -1.87552754e-02  S^2 = 2.0000000
               |grad[o]|=0.112  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85342830082631  dE = -1.25784203e-06  S^2 = 2.0000000
               |grad[o]|=0.000937  |ddm|=    0  |maxRot[o]|=0.000944
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85342830082631  dE =  4.44089210e-16  S^2 = 2.0000000
               |grad[o]|=6.18e-07  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85342830082631
CASCI E = -3.85342830082631  E(CI) = -1.08931211874851  S^2 = 2.0000000
CASCI state-averaged energy = -3.85342830082631
CASCI energy for each state
  State 0 weight 1  E = -3.85342830082631 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()


    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    
    solvers.nroots = 3
    # Weights
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,], weights)
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    
    #Set up solvers for triplet
    solvers = csf_solver(mol, smult=3)
    solvers.nroots = 1
    # Weights and Coef
    weights = np.ones(solvers.nroots) / solvers.nroots
    mo_coeff = avas.kernel(mf, ['H 1S'],minao=mol.basis)[2]
    #Run CASSCF
    tri = mcscf.CASSCF(mf, ncas, nelecas)
    tri = mcscf.state_average_mix_(tri, [solvers,], weights)
    tri.kernel(mo_coeff)
    tri_e = tri.e_states

    return sing_e, tri_e

x = [i/10 for i in range(5, 31, 1)]
sin_e = []
tri_e = []
J = []


for b in x:
    sing, tri = (run(b))
    sin_e.append(sing)
    tri_e.append(tri)
    J.append(219474.6 * (tri[0]-sing[0])/2)

with open('energies.txt', 'w') as fout:
    for i, xi in enumerate(x):
        fout.write(f'{xi}:    {sin_e[i]}    {tri_e[i]}\n')



# Convert Hartree to eV
hartree_to_ev = 27.2114
sin_e_ev = [[e * hartree_to_ev for e in row] for row in sin_e]
tri_e_ev = [[e * hartree_to_ev for e in row] for row in tri_e]


#Plot Energy Spectra
fig, ax = plt.subplots(figsize=(6, 4))
ax.set_xlabel('Bond Distance (Å)', fontsize=12)
ax.set_ylabel('Energy (eV)', fontsize=12)
ax.set_title('Singlet and Triplet Energy Levels', fontsize=14)

# Plot singlet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in sin_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='blue', label='Singlet' if i == 0 else "")

# Plot triplet energy levels as horizontal lines
for i, dist in enumerate(x):
    for energy in tri_e_ev[i]:
        ax.hlines(energy, dist - 0.05, dist + 0.05, color='red', label='Triplet' if i == 0 else "")

# Avoid duplicate legend entries
handles, labels = ax.get_legend_handles_labels()
ax.legend(dict(zip(labels, handles)).values(), dict(zip(labels, handles)).keys())

plt.tight_layout()
plt.savefig("energy_levels.png", dpi=300, bbox_inches='tight')
plt.close()

plt.figure(figsize=(6, 4))
plt.plot(x, J, marker='o', linestyle='-', color='purple')
plt.xlabel('Bond Distance (Å)', fontsize=12)
plt.ylabel('J Value (cm^-1)', fontsize=12)
plt.title('J vs Bond Distance', fontsize=14)
plt.grid(True)
plt.tight_layout()
plt.savefig('J_vs_distance.png', dpi=300)
plt.close()#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0179.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Mon Jul 21 15:24:52 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -3.000000000000 AA    0.000000000000   0.000000000000  -5.669178373695 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.000000000000 AA    0.000000000000   0.000000000000   5.669178373695 Bohr   0.0

nuclear repulsion = 0.79376581638
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       109.37


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33368602/tmpy1400lj3
max_memory 40000 MB (current use 143 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50643066874475

WARN: HOMO -0.182432453344401 == LUMO -0.181855747677892

cycle= 1 E= -3.60655931232621  delta_E= -0.1  |g|= 0.0226  |ddm|= 0.983
  HOMO = -0.259317914240888  LUMO = -0.170468594883983
cycle= 2 E= -3.60687209889339  delta_E= -0.000313  |g|= 0.00273  |ddm|= 0.0489
  HOMO = -0.261576792329364  LUMO = -0.17269324335037
cycle= 3 E= -3.60687677439247  delta_E= -4.68e-06  |g|= 1.58e-05  |ddm|= 0.0068
  HOMO = -0.261573899988991  LUMO = -0.172693163690746
cycle= 4 E= -3.60687677448385  delta_E= -9.14e-11  |g|= 5.32e-07  |ddm|= 1.79e-05
  HOMO = -0.261574484275184  LUMO = -0.172693527978373
Extra cycle  E= -3.60687677448405  delta_E= -2.03e-13  |g|= 1.15e-07  |ddm|= 5.77e-07
converged SCF energy = -3.60687677448405

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpy1400lj3
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 3
pspace_size = 200
spin = None
State-average over 3 states with weights [0.33333333 0.33333333 0.33333333]
CASCI E = -3.53002927875273  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  4 JK    1 micro), CASSCF E = -3.53176256920928  dE = -1.73329046e-03  S^2 = 0.0000000
               |grad[o]|=0.0378  |ddm|=    0  |maxRot[o]|=0.0326
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.53176257082054  dE = -1.61125824e-09  S^2 = 0.0000000
               |grad[o]|=4.68e-05  |ddm|=3.14e-16  |maxRot[o]|=2.32e-05
1-step CASSCF converged in   2 macro (  7 JK   2 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.53176257082054
CASCI E = -3.53176257082054  E(CI) = -0.764640139251077  S^2 = 0.0000000
CASCI state-averaged energy = -3.53176257082054
CASCI energy for each state
  State 0 weight 0.333333  E = -3.82314203878207 S^2 = 0.0000000
  State 1 weight 0.333333  E = -3.38607394150629 S^2 = 0.0000000
  State 2 weight 0.333333  E = -3.38607173217326 S^2 = 0.0000000

******** AVAS flags ********
aolabels = ['H 1S']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1S']:
 []
Option 2: threshold 0.2
Active from occupied = 0 , eig []
Inactive from occupied = 2
Active from unoccupied = 0 , eig []
Inactive from unoccupied = 13
Dimensions of active 0
# of alpha electrons 0
# of beta electrons 0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33368602/tmpy1400lj3
max_memory 40000 MB (current use 143 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -3.83478781483712  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  9 JK    2 micro), CASSCF E = -3.85352911619765  dE = -1.87413014e-02  S^2 = 2.0000000
               |grad[o]|=0.112  |ddm|=    0  |maxRot[o]|=0.118
macro iter   2 (  3 JK    1 micro), CASSCF E = -3.85353036244075  dE = -1.24624310e-06  S^2 = 2.0000000
               |grad[o]|=0.00093  |ddm|=    0  |maxRot[o]|=0.000944
macro iter   3 (  1 JK    1 micro), CASSCF E = -3.85353036244075  dE =  0.00000000e+00  S^2 = 2.0000000
               |grad[o]|=5.06e-07  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   3 macro ( 13 JK   4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.85353036244075
CASCI E = -3.85353036244075  E(CI) = -1.08641262931656  S^2 = 2.0000000
CASCI state-averaged energy = -3.85353036244075
CASCI energy for each state
  State 0 weight 1  E = -3.85353036244075 S^2 = 2.0000000
