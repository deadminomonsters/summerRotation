#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:30 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.500000000000 AA    0.000000000000   0.000000000000  -0.944863062283 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.500000000000 AA    0.000000000000   0.000000000000   0.944863062283 Bohr   0.0

nuclear repulsion = 4.76259489828
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:         1.40


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp_f14j96p
max_memory 40000 MB (current use 104 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.39717882526388
  HOMO = -0.00793897006449151  LUMO = 0.147752810315066
cycle= 1 E= -3.04496349315036  delta_E= 1.35  |g|= 0.444  |ddm|= 4.35
  HOMO = -0.330563699805954  LUMO = 0.121675618170203
cycle= 2 E= -3.09409471579041  delta_E= -0.0491  |g|= 0.0454  |ddm|= 1.28
  HOMO = -0.285511077186397  LUMO = 0.148493425203048
cycle= 3 E= -3.0944308868931  delta_E= -0.000336  |g|= 0.00614  |ddm|= 0.0643
  HOMO = -0.285198454246892  LUMO = 0.148295512277871
cycle= 4 E= -3.09444053643837  delta_E= -9.65e-06  |g|= 0.000578  |ddm|= 0.00989
  HOMO = -0.285406716790752  LUMO = 0.148038095243878
cycle= 5 E= -3.09444065701485  delta_E= -1.21e-07  |g|= 6.82e-05  |ddm|= 0.00231
  HOMO = -0.28542617265767  LUMO = 0.148020010826856
cycle= 6 E= -3.09444065871491  delta_E= -1.7e-09  |g|= 1.87e-06  |ddm|= 0.000305
  HOMO = -0.285425083930788  LUMO = 0.148019543778142
cycle= 7 E= -3.09444065871603  delta_E= -1.12e-12  |g|= 2.05e-07  |ddm|= 7.08e-06
  HOMO = -0.285425137732434  LUMO = 0.14801964335163
Extra cycle  E= -3.09444065871604  delta_E= -7.11e-15  |g|= 2.06e-08  |ddm|= 6.79e-07
converged SCF energy = -3.09444065871604

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.77134374 0.83581692]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.22865626]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.5

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp_f14j96p
max_memory 40000 MB (current use 122 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -2.04725163564216  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -2.39052979994602  dE = -3.43278164e-01  S^2 = 0.5000000
               |grad[o]|= 1.12  |ddm|=8.55e-30  |maxRot[o]|=0.276
macro iter   2 ( 21 JK    4 micro), CASSCF E = -2.73928317554285  dE = -3.48753376e-01  S^2 = 0.5000000
               |grad[o]|=0.995  |ddm|=2.22e-16  |maxRot[o]|=0.314
macro iter   3 ( 21 JK    4 micro), CASSCF E = -2.92670811416272  dE = -1.87424939e-01  S^2 = 0.5000000
               |grad[o]|= 0.68  |ddm|=2.22e-16  |maxRot[o]|=0.314
macro iter   4 ( 10 JK    4 micro), CASSCF E = -2.93109195538880  dE = -4.38384123e-03  S^2 = 0.5000000
               |grad[o]|= 0.12  |ddm|=2.22e-16  |maxRot[o]|=0.0415
macro iter   5 (  5 JK    2 micro), CASSCF E = -2.93109243997397  dE = -4.84585174e-07  S^2 = 0.5000000
               |grad[o]|=0.000813  |ddm|=2.22e-16  |maxRot[o]|=0.000552
macro iter   6 (  1 JK    1 micro), CASSCF E = -2.93109243997397  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.12e-05  |ddm|=2.28e-27  |maxRot[o]|=    0
1-step CASSCF converged in   6 macro ( 77 JK  19 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -2.93109243997397
CASCI E = -2.93109243997397  E(CI) = -0.894606825011699  S^2 = 0.5000000
CASCI state-averaged energy = -2.93109243997397
CASCI energy for each state
  State 0 weight 0.25  E = -3.09374329687167 S^2 = 0.0000000
  State 1 weight 0.25  E = -2.91150706321018 S^2 = 0.0000000
  State 2 weight 0.25  E = -2.70825383165512 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.01086556815891 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:35 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.550000000000 AA    0.000000000000   0.000000000000  -1.039349368511 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.550000000000 AA    0.000000000000   0.000000000000   1.039349368511 Bohr   0.0

nuclear repulsion = 4.32963172570909
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        12.45


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpw6_subh8
max_memory 40000 MB (current use 147 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.37678142061932
  HOMO = -0.0311564292569268  LUMO = 0.148567360013941
cycle= 1 E= -3.22178249594758  delta_E= 1.15  |g|= 0.404  |ddm|= 3.51
  HOMO = -0.337975306257041  LUMO = 0.12602114659104
cycle= 2 E= -3.2634446998166  delta_E= -0.0417  |g|= 0.0403  |ddm|= 0.956
  HOMO = -0.296776652639982  LUMO = 0.150698159403524
cycle= 3 E= -3.26371776006865  delta_E= -0.000273  |g|= 0.0055  |ddm|= 0.0469
  HOMO = -0.296309253874181  LUMO = 0.150664450849315
cycle= 4 E= -3.26372556397816  delta_E= -7.8e-06  |g|= 0.000437  |ddm|= 0.00739
  HOMO = -0.296468783868162  LUMO = 0.150466778370734
cycle= 5 E= -3.26372563569151  delta_E= -7.17e-08  |g|= 5.88e-05  |ddm|= 0.0015
  HOMO = -0.29648570524549  LUMO = 0.150449663500058
cycle= 6 E= -3.26372563705402  delta_E= -1.36e-09  |g|= 1.76e-06  |ddm|= 0.000235
  HOMO = -0.296484773071871  LUMO = 0.150449174505284
cycle= 7 E= -3.26372563705501  delta_E= -9.97e-13  |g|= 1.9e-07  |ddm|= 4.76e-06
  HOMO = -0.296484820637319  LUMO = 0.150449271649064
Extra cycle  E= -3.26372563705502  delta_E= -1.07e-14  |g|= 1.94e-08  |ddm|= 5.36e-07
converged SCF energy = -3.26372563705502

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.7523398  0.84785014]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.2476602]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.55

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpw6_subh8
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -2.28307305273714  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -2.57220856177937  dE = -2.89135509e-01  S^2 = 0.5000000
               |grad[o]|=0.984  |ddm|=1.14e-27  |maxRot[o]|=0.257
macro iter   2 ( 21 JK    4 micro), CASSCF E = -2.89581825254163  dE = -3.23609691e-01  S^2 = 0.5000000
               |grad[o]|=0.892  |ddm|=2.22e-16  |maxRot[o]|=0.314
macro iter   3 ( 21 JK    4 micro), CASSCF E = -3.07752048985228  dE = -1.81702237e-01  S^2 = 0.5000000
               |grad[o]|=0.625  |ddm|=3.14e-16  |maxRot[o]|=0.314
macro iter   4 (  9 JK    3 micro), CASSCF E = -3.08566677224289  dE = -8.14628239e-03  S^2 = 0.5000000
               |grad[o]|= 0.15  |ddm|=3.14e-16  |maxRot[o]|=0.0649
macro iter   5 (  5 JK    2 micro), CASSCF E = -3.08566911732808  dE = -2.34508520e-06  S^2 = 0.5000000
               |grad[o]|=0.00171  |ddm|=3.14e-16  |maxRot[o]|=0.00131
macro iter   6 (  1 JK    1 micro), CASSCF E = -3.08566911732808  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1.2e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   6 macro ( 75 JK  18 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.08566911732808
CASCI E = -3.08566911732808  E(CI) = -0.902396266864371  S^2 = 0.5000000
CASCI state-averaged energy = -3.08566911732808
CASCI energy for each state
  State 0 weight 0.25  E = -3.26335283550764 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.06388018005781 S^2 = 0.0000000
  State 2 weight 0.25  E = -2.84889426251859 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.16654919122829 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:38 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.600000000000 AA    0.000000000000   0.000000000000  -1.133835674739 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.600000000000 AA    0.000000000000   0.000000000000   1.133835674739 Bohr   0.0

nuclear repulsion = 3.9688290819
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        22.59


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpg6px5oj9
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.32830217784651
  HOMO = -0.0517773741862608  LUMO = 0.146620752613783
cycle= 1 E= -3.35032567907052  delta_E= 0.978  |g|= 0.37  |ddm|= 2.94
  HOMO = -0.342986985438554  LUMO = 0.127147470716535
cycle= 2 E= -3.3860461984517  delta_E= -0.0357  |g|= 0.0358  |ddm|= 0.739
  HOMO = -0.305566696834908  LUMO = 0.150198649511073
cycle= 3 E= -3.38627000040446  delta_E= -0.000224  |g|= 0.00497  |ddm|= 0.0355
  HOMO = -0.305004317243645  LUMO = 0.150289697440776
cycle= 4 E= -3.38627644909066  delta_E= -6.45e-06  |g|= 0.00033  |ddm|= 0.00581
  HOMO = -0.30512817413168  LUMO = 0.150136347214112
cycle= 5 E= -3.3862764904501  delta_E= -4.14e-08  |g|= 4.64e-05  |ddm|= 0.000992
  HOMO = -0.305141880817303  LUMO = 0.150121877269326
cycle= 6 E= -3.38627649135192  delta_E= -9.02e-10  |g|= 1.66e-06  |ddm|= 0.000168
  HOMO = -0.305141320816767  LUMO = 0.150121390758464
Extra cycle  E= -3.38627649135281  delta_E= -8.96e-13  |g|= 2.81e-07  |ddm|= 2.8e-06
converged SCF energy = -3.38627649135281

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.72601274 0.85590631]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.27398726]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.6

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpg6px5oj9
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -2.48646743539098  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -2.74609319873719  dE = -2.59625763e-01  S^2 = 0.5000000
               |grad[o]|=0.849  |ddm|=3.15e-16  |maxRot[o]|=0.257
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.03516251026542  dE = -2.89069312e-01  S^2 = 0.5000000
               |grad[o]|=0.774  |ddm|=3.14e-16  |maxRot[o]|=0.314
macro iter   3 ( 21 JK    4 micro), CASSCF E = -3.19252101102429  dE = -1.57358501e-01  S^2 = 0.5000000
               |grad[o]|=0.539  |ddm|=5.03e-26  |maxRot[o]|=0.314
macro iter   4 (  9 JK    3 micro), CASSCF E = -3.19848395742750  dE = -5.96294640e-03  S^2 = 0.5000000
               |grad[o]|=0.119  |ddm|=3.66e-26  |maxRot[o]|=0.0605
macro iter   5 (  5 JK    2 micro), CASSCF E = -3.19848565672757  dE = -1.69930007e-06  S^2 = 0.5000000
               |grad[o]|=0.00139  |ddm|=2.22e-16  |maxRot[o]|=0.00117
macro iter   6 (  1 JK    1 micro), CASSCF E = -3.19848565672757  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.23e-05  |ddm|=1.1e-25  |maxRot[o]|=    0
1-step CASSCF converged in   6 macro ( 75 JK  18 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.19848565672757
CASCI E = -3.19848565672757  E(CI) = -0.907907925192293  S^2 = 0.5000000
CASCI state-averaged energy = -3.19848565672757
CASCI energy for each state
  State 0 weight 0.25  E = -3.3869668945905 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.1722528974456 S^2 = 0.0000000
  State 2 weight 0.25  E = -2.95363038395258 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.2810924509216 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.650000000000 AA    0.000000000000   0.000000000000  -1.228321980967 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.650000000000 AA    0.000000000000   0.000000000000   1.228321980967 Bohr   0.0

nuclear repulsion = 3.66353453713846
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        32.83


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpox_ocyje
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.26521523269955
  HOMO = -0.0699026817086507  LUMO = 0.141885413800385
cycle= 1 E= -3.44394922928834  delta_E= 0.821  |g|= 0.341  |ddm|= 2.53
  HOMO = -0.345998383773312  LUMO = 0.125325401100064
cycle= 2 E= -3.47485697847547  delta_E= -0.0309  |g|= 0.032  |ddm|= 0.586
  HOMO = -0.312186516453909  LUMO = 0.147142912395486
cycle= 3 E= -3.47504258151  delta_E= -0.000186  |g|= 0.00451  |ddm|= 0.028
  HOMO = -0.311574488786154  LUMO = 0.147332025214602
cycle= 4 E= -3.47504801068579  delta_E= -5.43e-06  |g|= 0.000253  |ddm|= 0.00479
  HOMO = -0.311672577748027  LUMO = 0.14721136817509
cycle= 5 E= -3.47504803422213  delta_E= -2.35e-08  |g|= 3.37e-05  |ddm|= 0.000667
  HOMO = -0.311683068434285  LUMO = 0.147200318437655
cycle= 6 E= -3.47504803472028  delta_E= -4.98e-10  |g|= 1.58e-06  |ddm|= 0.000113
  HOMO = -0.311682632758862  LUMO = 0.147199823215813
Extra cycle  E= -3.47504803472112  delta_E= -8.34e-13  |g|= 3.05e-07  |ddm|= 1.81e-06
converged SCF energy = -3.47504803472112

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.69320606 0.86098617]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.30679394]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.65

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpox_ocyje
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -2.65993009060721  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 20 JK    4 micro), CASSCF E = -2.92854860742628  dE = -2.68618517e-01  S^2 = 0.5000000
               |grad[o]|=0.724  |ddm|=1.39e-31  |maxRot[o]|=0.295
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.17283025178712  dE = -2.44281644e-01  S^2 = 0.5000000
               |grad[o]|=0.643  |ddm|=1.83e-26  |maxRot[o]|=0.315
macro iter   3 ( 20 JK    4 micro), CASSCF E = -3.28106085242836  dE = -1.08230601e-01  S^2 = 0.5000000
               |grad[o]|=0.415  |ddm|=2.22e-16  |maxRot[o]|=0.295
macro iter   4 (  9 JK    4 micro), CASSCF E = -3.28205758628273  dE = -9.96733854e-04  S^2 = 0.5000000
               |grad[o]|=0.0438  |ddm|=2.22e-16  |maxRot[o]|=0.0275
macro iter   5 (  3 JK    1 micro), CASSCF E = -3.28205767352381  dE = -8.72410792e-08  S^2 = 0.5000000
               |grad[o]|=0.000302  |ddm|=2.22e-16  |maxRot[o]|=0.000274
1-step CASSCF converged in   5 macro ( 73 JK  17 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.28205767352381
CASCI E = -3.28205767352381  E(CI) = -0.911989865224687  S^2 = 0.5000000
CASCI state-averaged energy = -3.28205767352381
CASCI energy for each state
  State 0 weight 0.25  E = -3.4774629876647 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.2493425629559 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.03419431636532 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.3672308271093 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:43 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.700000000000 AA    0.000000000000   0.000000000000  -1.322808287196 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.700000000000 AA    0.000000000000   0.000000000000   1.322808287196 Bohr   0.0

nuclear repulsion = 3.40185349877143
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        42.50


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp3l4wnk2p
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.19594876144273
  HOMO = -0.0857311635457782  LUMO = 0.134310362625964
cycle= 1 E= -3.51198283533049  delta_E= 0.684  |g|= 0.315  |ddm|= 2.23
  HOMO = -0.347371278264358  LUMO = 0.120774030940876
cycle= 2 E= -3.5389065473082  delta_E= -0.0269  |g|= 0.0286  |ddm|= 0.474
  HOMO = -0.316969468902655  LUMO = 0.141619671713972
cycle= 3 E= -3.5390622150447  delta_E= -0.000156  |g|= 0.00412  |ddm|= 0.0229
  HOMO = -0.316340052660108  LUMO = 0.14188811374089
cycle= 4 E= -3.5390668524699  delta_E= -4.64e-06  |g|= 0.000199  |ddm|= 0.00413
  HOMO = -0.316419338304696  LUMO = 0.141791842951709
cycle= 5 E= -3.5390668660384  delta_E= -1.36e-08  |g|= 2.27e-05  |ddm|= 0.000458
  HOMO = -0.316427016960662  LUMO = 0.141784250385483
cycle= 6 E= -3.539066866268  delta_E= -2.3e-10  |g|= 1.46e-06  |ddm|= 7.04e-05
  HOMO = -0.316426722482155  LUMO = 0.141783744499126
Extra cycle  E= -3.53906686626877  delta_E= -7.64e-13  |g|= 3.23e-07  |ddm|= 1.32e-06
converged SCF energy = -3.53906686626877

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.65488948 0.86381301]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.34511052]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.7

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp3l4wnk2p
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -2.80580956544062  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.03157108576824  dE = -2.25761520e-01  S^2 = 0.5000000
               |grad[o]|=0.615  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.25021655102375  dE = -2.18645465e-01  S^2 = 0.5000000
               |grad[o]|=0.553  |ddm|=1.83e-26  |maxRot[o]|=0.315
macro iter   3 ( 20 JK    4 micro), CASSCF E = -3.34424408155646  dE = -9.40275305e-02  S^2 = 0.5000000
               |grad[o]|=0.355  |ddm|=2.22e-16  |maxRot[o]|=0.295
macro iter   4 (  7 JK    3 micro), CASSCF E = -3.34494422321722  dE = -7.00141661e-04  S^2 = 0.5000000
               |grad[o]|=0.0335  |ddm|=3.14e-16  |maxRot[o]|=0.025
macro iter   5 (  3 JK    1 micro), CASSCF E = -3.34494427960002  dE = -5.63827913e-08  S^2 = 0.5000000
               |grad[o]|=0.00024  |ddm|=2.22e-16  |maxRot[o]|=0.000225
1-step CASSCF converged in   5 macro ( 70 JK  16 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.34494427960002
CASCI E = -3.34494427960002  E(CI) = -0.915354533869534  S^2 = 0.5000000
CASCI state-averaged energy = -3.34494427960002
CASCI energy for each state
  State 0 weight 0.25  E = -3.54389362034743 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.30390976462809 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.09827779719378 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.43369593623077 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:46 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.750000000000 AA    0.000000000000   0.000000000000  -1.417294593424 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.750000000000 AA    0.000000000000   0.000000000000   1.417294593424 Bohr   0.0

nuclear repulsion = 3.17506326552
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        51.91


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpepbcalxc
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.12571913096265
  HOMO = -0.0994894548938971  LUMO = 0.123884402125369
cycle= 1 E= -3.56115087955256  delta_E= 0.565  |g|= 0.293  |ddm|=    2
  HOMO = -0.347405050424161  LUMO = 0.113693617678718
cycle= 2 E= -3.58470320098979  delta_E= -0.0236  |g|= 0.0258  |ddm|= 0.39
  HOMO = -0.320212692394303  LUMO = 0.133693520272269
cycle= 3 E= -3.58483479794562  delta_E= -0.000132  |g|= 0.00378  |ddm|= 0.0196
  HOMO = -0.31958918645292  LUMO = 0.134024271891361
cycle= 4 E= -3.58483879524884  delta_E= -4e-06  |g|= 0.000164  |ddm|= 0.0037
  HOMO = -0.319654438603372  LUMO = 0.133946329511505
cycle= 5 E= -3.5848388035611  delta_E= -8.31e-09  |g|= 1.45e-05  |ddm|= 0.000324
  HOMO = -0.31965990589109  LUMO = 0.133941668526942
cycle= 6 E= -3.5848388036512  delta_E= -9.01e-11  |g|= 1.22e-06  |ddm|= 4.15e-05
  HOMO = -0.319659750450189  LUMO = 0.133941189750391
Extra cycle  E= -3.58483880365177  delta_E= -5.73e-13  |g|= 2.96e-07  |ddm|= 1.12e-06
converged SCF energy = -3.58483880365177

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.61212094 0.86488681]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.38787906]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.75

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpepbcalxc
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -2.92728262130854  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.13204499523532  dE = -2.04762374e-01  S^2 = 0.5000000
               |grad[o]|=0.524  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.32259098738313  dE = -1.90545992e-01  S^2 = 0.5000000
               |grad[o]|=0.469  |ddm|=1.37e-26  |maxRot[o]|=0.315
macro iter   3 ( 19 JK    4 micro), CASSCF E = -3.39297575834438  dE = -7.03847710e-02  S^2 = 0.5000000
               |grad[o]|=0.285  |ddm|=3.14e-16  |maxRot[o]|=0.276
macro iter   4 (  7 JK    3 micro), CASSCF E = -3.39317960831351  dE = -2.03849969e-04  S^2 = 0.5000000
               |grad[o]|=0.0139  |ddm|=2.22e-16  |maxRot[o]|=0.0152
macro iter   5 (  3 JK    1 micro), CASSCF E = -3.39317961688347  dE = -8.56995452e-09  S^2 = 0.5000000
               |grad[o]|=8.46e-05  |ddm|=3.14e-16  |maxRot[o]|=9.36e-05
1-step CASSCF converged in   5 macro ( 69 JK  16 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.39317961688347
CASCI E = -3.39317961688347  E(CI) = -0.918469270437588  S^2 = 0.5000000
CASCI state-averaged energy = -3.39317961688347
CASCI energy for each state
  State 0 weight 0.25  E = -3.59285047335019 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.34225432539782 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.15100747420329 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.48660619458258 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:48 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.800000000000 AA    0.000000000000   0.000000000000  -1.511780899652 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.800000000000 AA    0.000000000000   0.000000000000   1.511780899652 Bohr   0.0

nuclear repulsion = 2.976621811425
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        61.11


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpnvfolvv4
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -4.05769170429674
  HOMO = -0.111400024028798  LUMO = 0.110709973317698
cycle= 1 E= -3.5964015598456  delta_E= 0.461  |g|= 0.272  |ddm|= 1.83
  HOMO = -0.346342369520008  LUMO = 0.104314908596695
cycle= 2 E= -3.61704178925899  delta_E= -0.0206  |g|= 0.0232  |ddm|= 0.325
  HOMO = -0.322165389204072  LUMO = 0.123465438223848
cycle= 3 E= -3.61715337321225  delta_E= -0.000112  |g|= 0.00346  |ddm|= 0.0173
  HOMO = -0.32156529578019  LUMO = 0.123839254011508
cycle= 4 E= -3.61715682700976  delta_E= -3.45e-06  |g|= 0.000141  |ddm|= 0.0034
  HOMO = -0.321619642735785  LUMO = 0.1237750933666
cycle= 5 E= -3.61715683265171  delta_E= -5.64e-09  |g|= 9.58e-06  |ddm|= 0.000242
  HOMO = -0.32162356943281  LUMO = 0.123772486875305
cycle= 6 E= -3.61715683268613  delta_E= -3.44e-11  |g|= 7.95e-07  |ddm|= 2.45e-05
  HOMO = -0.321623494231446  LUMO = 0.123772110451064
Extra cycle  E= -3.61715683268638  delta_E= -2.52e-13  |g|= 1.97e-07  |ddm|= 7.26e-07
converged SCF energy = -3.61715683268638

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.56606243 0.86455704]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.43393757]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.8

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpnvfolvv4
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.02783083442201  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.21512638964134  dE = -1.87295555e-01  S^2 = 0.5000000
               |grad[o]|=0.452  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.38082792522644  dE = -1.65701536e-01  S^2 = 0.5000000
               |grad[o]|=0.399  |ddm|=2.22e-16  |maxRot[o]|=0.315
macro iter   3 ( 18 JK    4 micro), CASSCF E = -3.43076011700928  dE = -4.99321918e-02  S^2 = 0.5000000
               |grad[o]|=0.225  |ddm|=2e-27  |maxRot[o]|=0.237
macro iter   4 (  7 JK    3 micro), CASSCF E = -3.43105519534949  dE = -2.95078340e-04  S^2 = 0.5000000
               |grad[o]|=0.0147  |ddm|=2.22e-16  |maxRot[o]|=0.0207
macro iter   5 (  3 JK    1 micro), CASSCF E = -3.43105521193647  dE = -1.65869838e-08  S^2 = 0.5000000
               |grad[o]|=0.00011  |ddm|=2.22e-16  |maxRot[o]|=0.000145
1-step CASSCF converged in   5 macro ( 68 JK  16 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.43105521193647
CASCI E = -3.43105521193647  E(CI) = -0.921544139170690  S^2 = 0.5000000
CASCI state-averaged energy = -3.43105521193647
CASCI energy for each state
  State 0 weight 0.25  E = -3.62924872217594 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.36903584017206 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.19571906072249 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.5302172246754 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:51 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.850000000000 AA    0.000000000000   0.000000000000  -1.606267205880 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.850000000000 AA    0.000000000000   0.000000000000   1.606267205880 Bohr   0.0

nuclear repulsion = 2.80152641075294
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        70.56


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpz605y6bk
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.99370727445888
  HOMO = -0.121672249114963  LUMO = 0.0950578764716917
cycle= 1 E= -3.621388497068  delta_E= 0.372  |g|= 0.253  |ddm|= 1.68
  HOMO = -0.344389403683655  LUMO = 0.0929392854804312
cycle= 2 E= -3.6394675709275  delta_E= -0.0181  |g|= 0.021  |ddm|= 0.274
  HOMO = -0.323042717704942  LUMO = 0.111130566849885
cycle= 3 E= -3.63956204816072  delta_E= -9.45e-05  |g|= 0.00317  |ddm|= 0.0157
  HOMO = -0.322479367921338  LUMO = 0.111525490199323
cycle= 4 E= -3.63956502162219  delta_E= -2.97e-06  |g|= 0.000123  |ddm|= 0.00319
  HOMO = -0.322524704791007  LUMO = 0.11147172975446
cycle= 5 E= -3.63956502580919  delta_E= -4.19e-09  |g|= 7.41e-06  |ddm|= 0.000191
  HOMO = -0.322527652677312  LUMO = 0.111470302143573
cycle= 6 E= -3.63956502582653  delta_E= -1.73e-11  |g|= 4.09e-07  |ddm|= 1.62e-05
  HOMO = -0.32252759478932  LUMO = 0.111470049512903
Extra cycle  E= -3.6395650258266  delta_E= -6.93e-14  |g|= 8.85e-08  |ddm|= 2.83e-07
converged SCF energy = -3.6395650258266

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.5179769  0.86308619]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.4820231]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.85

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpz605y6bk
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.11071989353164  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.28354239169784  dE = -1.72822498e-01  S^2 = 0.5000000
               |grad[o]|=0.397  |ddm|=5.35e-29  |maxRot[o]|=0.276
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.42751332481030  dE = -1.43970933e-01  S^2 = 0.5000000
               |grad[o]|=0.344  |ddm|=2.22e-16  |maxRot[o]|=0.315
macro iter   3 ( 16 JK    4 micro), CASSCF E = -3.46144486234972  dE = -3.39315375e-02  S^2 = 0.5000000
               |grad[o]|=0.174  |ddm|=2.22e-16  |maxRot[o]|=0.208
macro iter   4 (  5 JK    2 micro), CASSCF E = -3.46155762598203  dE = -1.12763632e-04  S^2 = 0.5000000
               |grad[o]|=0.00887  |ddm|=2.22e-16  |maxRot[o]|=0.013
macro iter   5 (  3 JK    1 micro), CASSCF E = -3.46155762849893  dE = -2.51690846e-09  S^2 = 0.5000000
               |grad[o]|=4.26e-05  |ddm|=2.22e-16  |maxRot[o]|=6.2e-05
1-step CASSCF converged in   5 macro ( 64 JK  15 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.46155762849893
CASCI E = -3.46155762849893  E(CI) = -0.924586145833572  S^2 = 0.5000000
CASCI state-averaged energy = -3.46155762849893
CASCI energy for each state
  State 0 weight 0.25  E = -3.65675456785625 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38770316170573 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.23442196906585 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.56735081536791 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:53 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.900000000000 AA    0.000000000000   0.000000000000  -1.700753512109 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.900000000000 AA    0.000000000000   0.000000000000   1.700753512109 Bohr   0.0

nuclear repulsion = 2.6458860546
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        79.29


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp4faa28zu
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.93473902874798
  HOMO = -0.130501504497819  LUMO = 0.0773753153489088
cycle= 1 E= -3.63879400534099  delta_E= 0.296  |g|= 0.235  |ddm|= 1.57
  HOMO = -0.341731671099502  LUMO = 0.07994762550228
cycle= 2 E= -3.65458743147023  delta_E= -0.0158  |g|= 0.019  |ddm|= 0.233
  HOMO = -0.323038671514479  LUMO = 0.0970018899096426
cycle= 3 E= -3.65466710133351  delta_E= -7.97e-05  |g|= 0.00289  |ddm|= 0.0146
  HOMO = -0.322521975791304  LUMO = 0.0973950819141353
cycle= 4 E= -3.65466964454746  delta_E= -2.54e-06  |g|= 0.000107  |ddm|= 0.00302
  HOMO = -0.322559366542208  LUMO = 0.0973493094218249
cycle= 5 E= -3.6546696477599  delta_E= -3.21e-09  |g|= 6.53e-06  |ddm|= 0.000158
  HOMO = -0.322561673623948  LUMO = 0.0973483895212732
cycle= 6 E= -3.65466964777236  delta_E= -1.25e-11  |g|= 2.42e-07  |ddm|= 1.25e-05
  HOMO = -0.322561622013862  LUMO = 0.0973482129144049
Extra cycle  E= -3.65466964777238  delta_E= -2.22e-14  |g|= 3.52e-08  |ddm|= 1.84e-07
converged SCF energy = -3.65466964777238

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.46915778 0.8606886 ]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.53084222]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.9

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp4faa28zu
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.17882960808407  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 20 JK    4 micro), CASSCF E = -3.34999584637731  dE = -1.71166238e-01  S^2 = 0.5000000
               |grad[o]|=0.355  |ddm|=2.22e-16  |maxRot[o]|=0.296
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.46921873124061  dE = -1.19222885e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=2.74e-26  |maxRot[o]|=0.315
macro iter   3 ( 12 JK    3 micro), CASSCF E = -3.48666748958751  dE = -1.74487583e-02  S^2 = 0.5000000
               |grad[o]|= 0.12  |ddm|=2.22e-16  |maxRot[o]|=0.157
macro iter   4 (  3 JK    1 micro), CASSCF E = -3.48668886654418  dE = -2.13769567e-05  S^2 = 0.5000000
               |grad[o]|=0.00383  |ddm|=7.31e-24  |maxRot[o]|=0.00564
macro iter   5 (  1 JK    1 micro), CASSCF E = -3.48668886654418  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.53e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   5 macro ( 57 JK  13 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.48668886654418
CASCI E = -3.48668886654418  E(CI) = -0.927477744379342  S^2 = 0.5000000
CASCI state-averaged energy = -3.48668886654418
CASCI energy for each state
  State 0 weight 0.25  E = -3.67806405381982 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40074379462801 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.26819909275448 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.59974852497441 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:55 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.950000000000 AA    0.000000000000   0.000000000000  -1.795239818337 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.950000000000 AA    0.000000000000   0.000000000000   1.795239818337 Bohr   0.0

nuclear repulsion = 2.50662889383158
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        86.92


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmppzh7wc9x
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.88119093709286
  HOMO = -0.138068795075747  LUMO = 0.058243268578512
cycle= 1 E= -3.65058237175485  delta_E= 0.231  |g|= 0.217  |ddm|= 1.47
  HOMO = -0.338539959521677  LUMO = 0.065776235026118
cycle= 2 E= -3.6643151054101  delta_E= -0.0137  |g|= 0.0171  |ddm|=  0.2
  HOMO = -0.322329804577607  LUMO = 0.081492731326133
cycle= 3 E= -3.66438200074488  delta_E= -6.69e-05  |g|= 0.00264  |ddm|= 0.0137
  HOMO = -0.321866741622471  LUMO = 0.0818629395454773
cycle= 4 E= -3.6643841633535  delta_E= -2.16e-06  |g|= 9.09e-05  |ddm|= 0.00288
  HOMO = -0.321896811831228  LUMO = 0.0818235024489282
cycle= 5 E= -3.66438416580251  delta_E= -2.45e-09  |g|= 5.93e-06  |ddm|= 0.000135
  HOMO = -0.321898636831098  LUMO = 0.0818226236478882
cycle= 6 E= -3.66438416581272  delta_E= -1.02e-11  |g|= 2.12e-07  |ddm|= 1.05e-05
  HOMO = -0.321898598945805  LUMO = 0.0818224684676342
Extra cycle  E= -3.66438416581274  delta_E= -1.78e-14  |g|= 3.49e-08  |ddm|= 1.45e-07
converged SCF energy = -3.66438416581274

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.42082128 0.85754831]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.57917872]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 0.95

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmppzh7wc9x
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.23465574142889  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.38575186188783  dE = -1.51096120e-01  S^2 = 0.5000000
               |grad[o]|=0.325  |ddm|=2.16e-29  |maxRot[o]|=0.276
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.49461661475717  dE = -1.08864753e-01  S^2 = 0.5000000
               |grad[o]|=0.264  |ddm|=2.95e-25  |maxRot[o]|=0.315
macro iter   3 ( 12 JK    3 micro), CASSCF E = -3.50772896547372  dE = -1.31123507e-02  S^2 = 0.5000000
               |grad[o]|=0.0987  |ddm|=2.22e-16  |maxRot[o]|=0.139
macro iter   4 (  5 JK    2 micro), CASSCF E = -3.50775267332533  dE = -2.37078516e-05  S^2 = 0.5000000
               |grad[o]|=0.00388  |ddm|=3.14e-16  |maxRot[o]|=0.00622
macro iter   5 (  1 JK    1 micro), CASSCF E = -3.50775267332533  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1.1e-05  |ddm|=2.92e-25  |maxRot[o]|=    0
1-step CASSCF converged in   5 macro ( 58 JK  14 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.50775267332533
CASCI E = -3.50775267332533  E(CI) = -0.930056515061257  S^2 = 0.5000000
CASCI state-averaged energy = -3.50775267332533
CASCI energy for each state
  State 0 weight 0.25  E = -3.6951222858462 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40988949436637 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.29758245406396 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.62841645902481 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:57 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.000000000000 AA    0.000000000000   0.000000000000  -1.889726124565 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr   0.0

nuclear repulsion = 2.38129744914
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:        95.06


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpyjv__rmd
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.83310029293193
  HOMO = -0.144539770877341  LUMO = 0.0383019091431946
cycle= 1 E= -3.65820045602599  delta_E= 0.175  |g|= 0.201  |ddm|=  1.4
  HOMO = -0.334970074950474  LUMO = 0.0508750996253674
cycle= 2 E= -3.67006561926764  delta_E= -0.0119  |g|= 0.0155  |ddm|= 0.172
  HOMO = -0.321073782832478  LUMO = 0.0650720832943031
cycle= 3 E= -3.67012165889009  delta_E= -5.6e-05  |g|= 0.0024  |ddm|= 0.0129
  HOMO = -0.320668849106765  LUMO = 0.0654016716976087
cycle= 4 E= -3.67012349350466  delta_E= -1.83e-06  |g|= 7.59e-05  |ddm|= 0.00275
  HOMO = -0.320692102266123  LUMO = 0.0653674332774403
cycle= 5 E= -3.6701234953959  delta_E= -1.89e-09  |g|= 5.62e-06  |ddm|= 0.000118
  HOMO = -0.32069348556039  LUMO = 0.0653663205293652
cycle= 6 E= -3.67012349540615  delta_E= -1.03e-11  |g|= 3.08e-07  |ddm|= 9.48e-06
  HOMO = -0.320693452818839  LUMO = 0.0653661566830953
Extra cycle  E= -3.67012349540619  delta_E= -4.53e-14  |g|= 8.13e-08  |ddm|= 2.91e-07
converged SCF energy = -3.67012349540619

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.37401447 0.85382696]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.62598553]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 1.0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpyjv__rmd
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.28033666628411  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.41455429660055  dE = -1.34217630e-01  S^2 = 0.5000000
               |grad[o]|=0.303  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.51554722195510  dE = -1.00992925e-01  S^2 = 0.5000000
               |grad[o]|=0.244  |ddm|=2.22e-16  |maxRot[o]|=0.315
macro iter   3 ( 11 JK    3 micro), CASSCF E = -3.52558669450905  dE = -1.00394726e-02  S^2 = 0.5000000
               |grad[o]|=0.0829  |ddm|=3.14e-16  |maxRot[o]|=0.125
macro iter   4 (  3 JK    1 micro), CASSCF E = -3.52559729234904  dE = -1.05978400e-05  S^2 = 0.5000000
               |grad[o]|=0.00258  |ddm|=6.21e-25  |maxRot[o]|=0.00417
macro iter   5 (  1 JK    1 micro), CASSCF E = -3.52559729234904  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1e-05  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   5 macro ( 54 JK  13 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.52559729234904
CASCI E = -3.52559729234904  E(CI) = -0.932175310814706  S^2 = 0.5000000
CASCI state-averaged energy = -3.52559729234904
CASCI energy for each state
  State 0 weight 0.25  E = -3.70929727137537 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41631826887181 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.32285562501072 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.65391800413827 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:30:59 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.050000000000 AA    0.000000000000   0.000000000000  -1.984212430793 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.050000000000 AA    0.000000000000   0.000000000000   1.984212430793 Bohr   0.0

nuclear repulsion = 2.26790233251429
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       102.66


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpshqc2rtm
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.79027714611021
  HOMO = -0.150063907439047  LUMO = 0.0181720088747589
cycle= 1 E= -3.66272647815999  delta_E= 0.128  |g|= 0.185  |ddm|= 1.33
  HOMO = -0.331160717221582  LUMO = 0.0356663473819745
cycle= 2 E= -3.67289877135129  delta_E= -0.0102  |g|= 0.0139  |ddm|= 0.149
  HOMO = -0.319407479175591  LUMO = 0.0482123009663607
cycle= 3 E= -3.67294578719652  delta_E= -4.7e-05  |g|= 0.00219  |ddm|= 0.0122
  HOMO = -0.319063093898362  LUMO = 0.0484884188780103
cycle= 4 E= -3.67294734689529  delta_E= -1.56e-06  |g|= 6.46e-05  |ddm|= 0.00262
  HOMO = -0.319080099506682  LUMO = 0.0484585227111569
cycle= 5 E= -3.67294734852459  delta_E= -1.63e-09  |g|= 6.26e-06  |ddm|= 0.000106
  HOMO = -0.319080991062034  LUMO = 0.0484570946922647
cycle= 6 E= -3.67294734854053  delta_E= -1.59e-11  |g|= 5.13e-07  |ddm|= 9.83e-06
  HOMO = -0.319080937316328  LUMO = 0.0484569339045791
Extra cycle  E= -3.67294734854066  delta_E= -1.22e-13  |g|= 1.48e-07  |ddm|= 5.4e-07
converged SCF energy = -3.67294734854066

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.32956507 0.84966852]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.67043493]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 1.05

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpshqc2rtm
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.31767704207001  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.44608602525695  dE = -1.28408983e-01  S^2 = 0.5000000
               |grad[o]|=0.287  |ddm|=1.43e-28  |maxRot[o]|=0.257
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.53532071549910  dE = -8.92346902e-02  S^2 = 0.5000000
               |grad[o]|=0.223  |ddm|=2.22e-16  |maxRot[o]|=0.315
macro iter   3 ( 12 JK    4 micro), CASSCF E = -3.54079110401960  dE = -5.47038852e-03  S^2 = 0.5000000
               |grad[o]|=0.0596  |ddm|=5.12e-25  |maxRot[o]|=0.0938
macro iter   4 (  3 JK    1 micro), CASSCF E = -3.54079482391033  dE = -3.71989074e-06  S^2 = 0.5000000
               |grad[o]|=0.00152  |ddm|=2.22e-16  |maxRot[o]|=0.00248
macro iter   5 (  1 JK    1 micro), CASSCF E = -3.54079482391033  dE =  8.88178420e-16  S^2 = 0.5000000
               |grad[o]|=9.42e-06  |ddm|=5.85e-25  |maxRot[o]|=    0
1-step CASSCF converged in   5 macro ( 55 JK  14 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.54079482391033
CASCI E = -3.54079482391033  E(CI) = -0.933732301426504  S^2 = 0.5000000
CASCI state-averaged energy = -3.54079482391033
CASCI energy for each state
  State 0 weight 0.25  E = -3.72153085921462 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42080247303559 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.34423977019023 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.67660619320089 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:01 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.100000000000 AA    0.000000000000   0.000000000000  -2.078698737022 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.100000000000 AA    0.000000000000   0.000000000000   2.078698737022 Bohr   0.0

nuclear repulsion = 2.16481586285455
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       110.52


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpc3x3u2f7
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.7523994645024
  HOMO = -0.154774328528625  LUMO = -0.00160519773464027
cycle= 1 E= -3.66497382149364  delta_E= 0.0874  |g|= 0.169  |ddm|= 1.28
  HOMO = -0.327231552718194  LUMO = 0.0205143449809763
cycle= 2 E= -3.67361828365965  delta_E= -0.00864  |g|= 0.0126  |ddm|= 0.13
  HOMO = -0.317446455384331  LUMO = 0.0313445431513878
cycle= 3 E= -3.67365798194725  delta_E= -3.97e-05  |g|= 0.002  |ddm|= 0.0115
  HOMO = -0.317163279351523  LUMO = 0.0315594215558152
cycle= 4 E= -3.67365931594079  delta_E= -1.33e-06  |g|= 6.05e-05  |ddm|= 0.00249
  HOMO = -0.317174700914358  LUMO = 0.0315331294786456
cycle= 5 E= -3.6736593176801  delta_E= -1.74e-09  |g|= 8.03e-06  |ddm|= 9.95e-05
  HOMO = -0.317174986525106  LUMO = 0.0315315154098395
cycle= 6 E= -3.67365931770964  delta_E= -2.95e-11  |g|= 6.24e-07  |ddm|= 1.14e-05
  HOMO = -0.317174907095883  LUMO = 0.0315313974748831
Extra cycle  E= -3.67365931770981  delta_E= -1.7e-13  |g|= 1.75e-07  |ddm|= 6.39e-07
converged SCF energy = -3.67365931770981

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.28807046 0.84520288]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.71192954]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 1.1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpc3x3u2f7
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.34817690122764  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.47197280856374  dE = -1.23795907e-01  S^2 = 0.5000000
               |grad[o]|=0.276  |ddm|=1.07e-28  |maxRot[o]|=0.257
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.55116236832057  dE = -7.91895598e-02  S^2 = 0.5000000
               |grad[o]|=0.206  |ddm|=1.1e-25  |maxRot[o]|=0.315
macro iter   3 (  9 JK    3 micro), CASSCF E = -3.55375674339575  dE = -2.59437508e-03  S^2 = 0.5000000
               |grad[o]|=0.0403  |ddm|=2.22e-16  |maxRot[o]|=0.0655
macro iter   4 (  3 JK    1 micro), CASSCF E = -3.55375755027005  dE = -8.06874296e-07  S^2 = 0.5000000
               |grad[o]|=0.000708  |ddm|=2.22e-16  |maxRot[o]|=0.00115
macro iter   5 (  1 JK    1 micro), CASSCF E = -3.55375755027005  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=5.64e-06  |ddm|=    0  |maxRot[o]|=    0
1-step CASSCF converged in   5 macro ( 52 JK  13 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.55375755027005
CASCI E = -3.55375755027005  E(CI) = -0.934674545303911  S^2 = 0.5000000
CASCI state-averaged energy = -3.55375755027005
CASCI energy for each state
  State 0 weight 0.25  E = -3.73244142983705 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42386108889646 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.36199110593636 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.69673657641033 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:03 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.150000000000 AA    0.000000000000   0.000000000000  -2.173185043250 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.150000000000 AA    0.000000000000   0.000000000000   2.173185043250 Bohr   0.0

nuclear repulsion = 2.07069343403478
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       118.06


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpj3zzoer3
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.71907672056518
  HOMO = -0.158788241383508  LUMO = -0.0206005551018726
cycle= 1 E= -3.66556133249582  delta_E= 0.0535  |g|= 0.154  |ddm|= 1.24
  HOMO = -0.323282138285486  LUMO = 0.0057108088215181
cycle= 2 E= -3.67283820311982  delta_E= -0.00728  |g|= 0.0113  |ddm|= 0.114
  HOMO = -0.315285858712551  LUMO = 0.0148298587631721
cycle= 3 E= -3.67287210293174  delta_E= -3.39e-05  |g|= 0.00183  |ddm|= 0.0108
  HOMO = -0.315063021574939  LUMO = 0.0149804457013645
cycle= 4 E= -3.67287325306617  delta_E= -1.15e-06  |g|= 6.46e-05  |ddm|= 0.00235
  HOMO = -0.315069502637837  LUMO = 0.0149571393595958
cycle= 5 E= -3.67287325529703  delta_E= -2.23e-09  |g|= 9.99e-06  |ddm|= 9.93e-05
  HOMO = -0.315069131189773  LUMO = 0.0149556387006521
cycle= 6 E= -3.6728732553431  delta_E= -4.61e-11  |g|= 5.82e-07  |ddm|= 1.31e-05
  HOMO = -0.315069054583641  LUMO = 0.0149555733768484
Extra cycle  E= -3.67287325534323  delta_E= -1.33e-13  |g|= 1.52e-07  |ddm|= 5.84e-07
converged SCF energy = -3.67287325534323

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.2499129  0.84054777]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.7500871]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 1.15

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpj3zzoer3
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.37306856544337  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 20 JK    4 micro), CASSCF E = -3.50765738220268  dE = -1.34588817e-01  S^2 = 0.5000000
               |grad[o]|=0.269  |ddm|=2.22e-16  |maxRot[o]|=0.296
macro iter   2 ( 20 JK    4 micro), CASSCF E = -3.56456267686724  dE = -5.69052947e-02  S^2 = 0.5000000
               |grad[o]|=0.175  |ddm|=2.22e-16  |maxRot[o]|=0.296
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.56480558596090  dE = -2.42909094e-04  S^2 = 0.5000000
               |grad[o]|=0.0123  |ddm|=3.14e-16  |maxRot[o]|=0.0201
macro iter   4 (  3 JK    1 micro), CASSCF E = -3.56480559254382  dE = -6.58292532e-09  S^2 = 0.5000000
               |grad[o]|=6.75e-05  |ddm|=4.57e-27  |maxRot[o]|=0.000102
1-step CASSCF converged in   4 macro ( 48 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.56480559254382
CASCI E = -3.56480559254382  E(CI) = -0.935001117800273  S^2 = 0.5000000
CASCI state-averaged energy = -3.56480559254383
CASCI energy for each state
  State 0 weight 0.25  E = -3.74241019712953 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42584892346464 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.37642858063293 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.7145346689482 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:05 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.200000000000 AA    0.000000000000   0.000000000000  -2.267671349478 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.200000000000 AA    0.000000000000   0.000000000000   2.267671349478 Bohr   0.0

nuclear repulsion = 1.98441454095
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       124.69


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpoi3fb5nd
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.68989122905533
  HOMO = -0.162207801959195  LUMO = -0.0385046273476267
cycle= 1 E= -3.66496117558319  delta_E= 0.0249  |g|= 0.14  |ddm|=  1.2
  HOMO = -0.3193918368684  LUMO = -0.00852719101709752
cycle= 2 E= -3.67102768867642  delta_E= -0.00607  |g|= 0.0102  |ddm|=  0.1
  HOMO = -0.313002242122891  LUMO = -0.00105317248393073
cycle= 3 E= -3.67105706742865  delta_E= -2.94e-05  |g|= 0.00167  |ddm|= 0.0101
  HOMO = -0.312837507728046  LUMO = -0.000965949682501551
cycle= 4 E= -3.67105806654039  delta_E= -9.99e-07  |g|= 7.39e-05  |ddm|= 0.00221
  HOMO = -0.312839574767688  LUMO = -0.00098663223717148
cycle= 5 E= -3.67105806957357  delta_E= -3.03e-09  |g|= 1.11e-05  |ddm|= 0.000105
  HOMO = -0.312838698651814  LUMO = -0.000987777239201624
cycle= 6 E= -3.67105806962864  delta_E= -5.51e-11  |g|= 4.82e-07  |ddm|= 1.37e-05
  HOMO = -0.312838645155008  LUMO = -0.000987808431992877
Extra cycle  E= -3.67105806962873  delta_E= -8.53e-14  |g|= 1.15e-07  |ddm|= 4.79e-07
converged SCF energy = -3.67105806962873

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 2 , eig [0.21528868 0.8358088 ]
Inactive from occupied = 0
Active from unoccupied = 1 , eig [0.78471132]
Inactive from unoccupied = 12
Dimensions of active 3
# of alpha electrons 2
# of beta electrons 2
Distance = 1.2

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpoi3fb5nd
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.39335708343741  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.51077842830945  dE = -1.17421345e-01  S^2 = 0.5000000
               |grad[o]|=0.265  |ddm|=4.97e-16  |maxRot[o]|=0.257
macro iter   2 ( 21 JK    4 micro), CASSCF E = -3.57402893106485  dE = -6.32505028e-02  S^2 = 0.5000000
               |grad[o]|=0.183  |ddm|=3.14e-16  |maxRot[o]|=0.315
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.57420282568770  dE = -1.73894623e-04  S^2 = 0.5000000
               |grad[o]|=0.0104  |ddm|=4.57e-26  |maxRot[o]|=0.0169
macro iter   4 (  3 JK    1 micro), CASSCF E = -3.57420282678790  dE = -1.10020038e-09  S^2 = 0.5000000
               |grad[o]|=3.48e-05  |ddm|=5.71e-27  |maxRot[o]|=3.37e-05
1-step CASSCF converged in   4 macro ( 45 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.57420282678790
CASCI E = -3.57420282678790  E(CI) = -0.934740944674947  S^2 = 0.5000000
CASCI state-averaged energy = -3.5742028267879
CASCI energy for each state
  State 0 weight 0.25  E = -3.75165409301034 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42701509538725 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.3879224579248 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.73021966082921 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:07 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.250000000000 AA    0.000000000000   0.000000000000  -2.362157655706 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.250000000000 AA    0.000000000000   0.000000000000   2.362157655706 Bohr   0.0

nuclear repulsion = 1.905037959312
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       130.84


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmphdorcijp
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.66442419808707
  HOMO = -0.165121265601679  LUMO = -0.0551186381376149
cycle= 1 E= -3.6635325243294  delta_E= 0.000892  |g|= 0.126  |ddm|= 1.17
  HOMO = -0.315620677833631  LUMO = -0.0220506718845933
cycle= 2 E= -3.66854247036012  delta_E= -0.00501  |g|= 0.00924  |ddm|= 0.0891
  HOMO = -0.310655835178726  LUMO = -0.0161077031870191
cycle= 3 E= -3.66856833427221  delta_E= -2.59e-05  |g|= 0.00152  |ddm|= 0.00948
  HOMO = -0.310545746430853  LUMO = -0.0160798025777403
cycle= 4 E= -3.66856920628876  delta_E= -8.72e-07  |g|= 8.46e-05  |ddm|= 0.00206
  HOMO = -0.310543882934402  LUMO = -0.0160979321032515
cycle= 5 E= -3.66856921029195  delta_E= -4e-09  |g|= 1.11e-05  |ddm|= 0.000113
  HOMO = -0.310542779300551  LUMO = -0.0160986891198187
cycle= 6 E= -3.66856921034441  delta_E= -5.25e-11  |g|= 3.86e-07  |ddm|= 1.31e-05
  HOMO = -0.310542751441733  LUMO = -0.0160987030829278
Extra cycle  E= -3.66856921034446  delta_E= -5.51e-14  |g|= 8.37e-08  |ddm|= 3.78e-07
converged SCF energy = -3.66856921034446

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.83107843]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.81575766]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.25

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmphdorcijp
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.40985934126483  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.52522088844308  dE = -1.15361547e-01  S^2 = 0.5000000
               |grad[o]|=0.263  |ddm|=3.14e-16  |maxRot[o]|=0.257
macro iter   2 ( 20 JK    4 micro), CASSCF E = -3.58200743843086  dE = -5.67865500e-02  S^2 = 0.5000000
               |grad[o]|=0.175  |ddm|=4.97e-16  |maxRot[o]|=0.296
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.58217459967194  dE = -1.67161241e-04  S^2 = 0.5000000
               |grad[o]|=0.0102  |ddm|=3.02e-25  |maxRot[o]|=0.0166
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.58217459967194  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=2.07e-05  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 42 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.58217459967194
CASCI E = -3.58217459967194  E(CI) = -0.933951951871810  S^2 = 0.5000000
CASCI state-averaged energy = -3.58217459967194
CASCI energy for each state
  State 0 weight 0.25  E = -3.760277834664 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42754483370256 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39687064957185 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.74400508074935 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:08 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.300000000000 AA    0.000000000000   0.000000000000  -2.456643961935 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.300000000000 AA    0.000000000000   0.000000000000   2.456643961935 Bohr   0.0

nuclear repulsion = 1.83176726856923
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       136.66


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp5cvpouvn
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.64227159002224
  HOMO = -0.167604325747283  LUMO = -0.0703370009311579
cycle= 1 E= -3.66154644648808  delta_E= -0.0193  |g|= 0.114  |ddm|= 1.14
  HOMO = -0.312011005543128  LUMO = -0.0347678846571106
cycle= 2 E= -3.66564829459545  delta_E= -0.0041  |g|= 0.00839  |ddm|= 0.08
  HOMO = -0.308292929553763  LUMO = -0.0302096965926041
cycle= 3 E= -3.66567138184721  delta_E= -2.31e-05  |g|= 0.00139  |ddm|= 0.00892
  HOMO = -0.308232965055429  LUMO = -0.0302348036465592
cycle= 4 E= -3.66567214305278  delta_E= -7.61e-07  |g|= 9.39e-05  |ddm|= 0.0019
  HOMO = -0.308227747667371  LUMO = -0.0302503132170241
cycle= 5 E= -3.66567214801188  delta_E= -4.96e-09  |g|= 1.02e-05  |ddm|= 0.000122
  HOMO = -0.308226651107166  LUMO = -0.0302507805065707
cycle= 6 E= -3.66567214805467  delta_E= -4.28e-11  |g|= 3.06e-07  |ddm|= 1.17e-05
  HOMO = -0.308226643714127  LUMO = -0.0302507863651398
Extra cycle  E= -3.6656721480547  delta_E= -3.2e-14  |g|= 6.04e-08  |ddm|= 2.98e-07
converged SCF energy = -3.6656721480547

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.82643466]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.84329915]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.3

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp5cvpouvn
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.42323899160518  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -3.53025024080562  dE = -1.07011249e-01  S^2 = 0.5000000
               |grad[o]|=0.262  |ddm|=3.14e-16  |maxRot[o]|=0.238
macro iter   2 ( 20 JK    4 micro), CASSCF E = -3.58869620698044  dE = -5.84459662e-02  S^2 = 0.5000000
               |grad[o]|=0.178  |ddm|=2.22e-16  |maxRot[o]|=0.296
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.58891617313913  dE = -2.19966159e-04  S^2 = 0.5000000
               |grad[o]|=0.0117  |ddm|=2.22e-16  |maxRot[o]|=0.019
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.58891617313913  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=2.35e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 41 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.58891617313913
CASCI E = -3.58891617313913  E(CI) = -0.932686087233276  S^2 = 0.5000000
CASCI state-averaged energy = -3.58891617313913
CASCI energy for each state
  State 0 weight 0.25  E = -3.76832365436138 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42757678945773 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40366788576584 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.75609636297157 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:10 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.350000000000 AA    0.000000000000   0.000000000000  -2.551130268163 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.350000000000 AA    0.000000000000   0.000000000000   2.551130268163 Bohr   0.0

nuclear repulsion = 1.7639240364
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       142.01


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpty0n_nmj
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.62305337489771
  HOMO = -0.169721554431738  LUMO = -0.0841274027211651
cycle= 1 E= -3.65920512701851  delta_E= -0.0362  |g|= 0.102  |ddm|= 1.12
  HOMO = -0.308589696603032  LUMO = -0.0466323319597485
cycle= 2 E= -3.66253942997872  delta_E= -0.00333  |g|= 0.00766  |ddm|= 0.0727
  HOMO = -0.305948177422549  LUMO = -0.0432952278154827
cycle= 3 E= -3.66256024471949  delta_E= -2.08e-05  |g|= 0.00126  |ddm|= 0.00843
  HOMO = -0.305932932437554  LUMO = -0.0433655135531041
cycle= 4 E= -3.66256090560223  delta_E= -6.61e-07  |g|= 0.0001  |ddm|= 0.00175
  HOMO = -0.305925071874126  LUMO = -0.0433783694406956
cycle= 5 E= -3.66256091132962  delta_E= -5.73e-09  |g|= 8.96e-06  |ddm|= 0.00013
  HOMO = -0.305924104609894  LUMO = -0.0433786528150992
cycle= 6 E= -3.66256091136136  delta_E= -3.17e-11  |g|= 2.42e-07  |ddm|= 9.98e-06
  HOMO = -0.305924111011285  LUMO = -0.0433786547251966
Extra cycle  E= -3.66256091136138  delta_E= -1.6e-14  |g|= 4.4e-08  |ddm|= 2.39e-07
converged SCF energy = -3.66256091136138

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.82194029]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.86749508]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.35

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpty0n_nmj
max_memory 40000 MB (current use 150 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.43403620513233  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.55325208880081  dE = -1.19215884e-01  S^2 = 0.5000000
               |grad[o]|=0.263  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 18 JK    4 micro), CASSCF E = -3.59450719840638  dE = -4.12551096e-02  S^2 = 0.5000000
               |grad[o]|=0.154  |ddm|=3.14e-16  |maxRot[o]|=0.249
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.59459704130163  dE = -8.98428952e-05  S^2 = 0.5000000
               |grad[o]|=0.00763  |ddm|=2.22e-16  |maxRot[o]|=0.0117
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.59459704130163  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=2.39e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 43 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.59459704130163
CASCI E = -3.59459704130163  E(CI) = -0.931005380416199  S^2 = 0.5000000
CASCI state-averaged energy = -3.59459704130163
CASCI energy for each state
  State 0 weight 0.25  E = -3.77580535575776 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42721190896963 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40867926288928 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.76669163758984 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:11 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.400000000000 AA    0.000000000000   0.000000000000  -2.645616574391 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.400000000000 AA    0.000000000000   0.000000000000   2.645616574391 Bohr   0.0

nuclear repulsion = 1.70092674938571
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       148.37


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp5ewvcalp
max_memory 40000 MB (current use 150 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.60641856485355
  HOMO = -0.171527856213208  LUMO = -0.0965118700467597
cycle= 1 E= -3.65665716952644  delta_E= -0.0502  |g|= 0.0913  |ddm|=  1.1
  HOMO = -0.305370710823265  LUMO = -0.0576315764211353
cycle= 2 E= -3.65935387916115  delta_E= -0.0027  |g|= 0.00703  |ddm|= 0.0669
  HOMO = -0.303646704730113  LUMO = -0.0553471042171987
cycle= 3 E= -3.65937274696488  delta_E= -1.89e-05  |g|= 0.00114  |ddm|= 0.00802
  HOMO = -0.30367009116677  LUMO = -0.0554538869077454
cycle= 4 E= -3.65937331425316  delta_E= -5.67e-07  |g|= 0.000103  |ddm|= 0.00159
  HOMO = -0.303660387217442  LUMO = -0.0554641723981146
cycle= 5 E= -3.65937332043434  delta_E= -6.18e-09  |g|= 7.64e-06  |ddm|= 0.000135
  HOMO = -0.303659576993752  LUMO = -0.0554643353117296
cycle= 6 E= -3.65937332045661  delta_E= -2.23e-11  |g|= 1.9e-07  |ddm|= 8.29e-06
  HOMO = -0.303659591264869  LUMO = -0.0554643349922576
Extra cycle  E= -3.65937332045662  delta_E= -8.88e-15  |g|= 3.28e-08  |ddm|= 1.94e-07
converged SCF energy = -3.65937332045662

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.8176431]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.88856401]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.4

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp5ewvcalp
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.44269229881985  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.55502484285978  dE = -1.12332544e-01  S^2 = 0.5000000
               |grad[o]|=0.264  |ddm|=1.43e-28  |maxRot[o]|=0.257
macro iter   2 ( 18 JK    4 micro), CASSCF E = -3.59928642487004  dE = -4.42615820e-02  S^2 = 0.5000000
               |grad[o]|= 0.16  |ddm|=3.14e-16  |maxRot[o]|=0.257
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.59936376014494  dE = -7.73352749e-05  S^2 = 0.5000000
               |grad[o]|=0.00713  |ddm|=5.14e-27  |maxRot[o]|=0.0108
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.59936376014494  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=2.01e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 42 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.59936376014494
CASCI E = -3.59936376014494  E(CI) = -0.928987709244990  S^2 = 0.5000000
CASCI state-averaged energy = -3.59936376014494
CASCI energy for each state
  State 0 weight 0.25  E = -3.78269814507002 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42655616375715 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41225242725799 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.77594830449461 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:13 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.450000000000 AA    0.000000000000   0.000000000000  -2.740102880619 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.450000000000 AA    0.000000000000   0.000000000000   2.740102880619 Bohr   0.0

nuclear repulsion = 1.64227410285517
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       154.66


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpc7sivryt
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.59204753920906
  HOMO = -0.173069854528093  LUMO = -0.107550389718605
cycle= 1 E= -3.65400993353464  delta_E= -0.062  |g|= 0.0815  |ddm|= 1.08
  HOMO = -0.302357757102123  LUMO = -0.0677777418255338
cycle= 2 E= -3.6561861276632  delta_E= -0.00218  |g|= 0.00648  |ddm|= 0.0623
  HOMO = -0.301406003348734  LUMO = -0.0663825628687705
cycle= 3 E= -3.65620325879231  delta_E= -1.71e-05  |g|= 0.00102  |ddm|= 0.00771
  HOMO = -0.301461456378212  LUMO = -0.0665168736826715
cycle= 4 E= -3.65620373743696  delta_E= -4.79e-07  |g|= 0.000103  |ddm|= 0.00144
  HOMO = -0.30145072884617  LUMO = -0.0665248045000401
cycle= 5 E= -3.65620374369831  delta_E= -6.26e-09  |g|= 6.41e-06  |ddm|= 0.000136
  HOMO = -0.301450049670606  LUMO = -0.0665248715650794
cycle= 6 E= -3.65620374371346  delta_E= -1.52e-11  |g|= 1.48e-07  |ddm|= 6.76e-06
  HOMO = -0.301450067279874  LUMO = -0.0665248696579517
Extra cycle  E= -3.65620374371347  delta_E= -1.15e-14  |g|= 2.5e-08  |ddm|= 1.58e-07
converged SCF energy = -3.65620374371347

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.81357694]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.90676132]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.45

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpc7sivryt
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.44956974205823  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -3.55519291306906  dE = -1.05623171e-01  S^2 = 0.5000000
               |grad[o]|=0.266  |ddm|=3.14e-16  |maxRot[o]|=0.238
macro iter   2 ( 19 JK    4 micro), CASSCF E = -3.60331197328241  dE = -4.81190602e-02  S^2 = 0.5000000
               |grad[o]|=0.168  |ddm|=2.22e-16  |maxRot[o]|= 0.27
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60334243399942  dE = -3.04607170e-05  S^2 = 0.5000000
               |grad[o]|=0.00461  |ddm|=2.22e-16  |maxRot[o]|=0.00644
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60334243399942  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=2.05e-05  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 40 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60334243399942
CASCI E = -3.60334243399942  E(CI) = -0.926680801192556  S^2 = 0.5000000
CASCI state-averaged energy = -3.60334243399942
CASCI energy for each state
  State 0 weight 0.25  E = -3.78900349883023 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42566978046187 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41466935777353 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.78402709893206 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:14 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.500000000000 AA    0.000000000000   0.000000000000  -2.834589186848 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.500000000000 AA    0.000000000000   0.000000000000   2.834589186848 Bohr   0.0

nuclear repulsion = 1.58753163276
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       160.01


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpn8kuxjsm
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.57965258190631
  HOMO = -0.17438715020202  LUMO = -0.117327552051225
cycle= 1 E= -3.65133946920334  delta_E= -0.0717  |g|= 0.0727  |ddm|= 1.07
  HOMO = -0.299546883318861  LUMO = -0.0770999325290777
cycle= 2 E= -3.65309783060358  delta_E= -0.00176  |g|= 0.00601  |ddm|= 0.0589
  HOMO = -0.29923758781007  LUMO = -0.0764427982220271
cycle= 3 E= -3.65311337746227  delta_E= -1.55e-05  |g|= 0.000904  |ddm|= 0.00749
  HOMO = -0.299318271806863  LUMO = -0.0765958492894764
cycle= 4 E= -3.65311377235038  delta_E= -3.95e-07  |g|= 9.95e-05  |ddm|= 0.00129
  HOMO = -0.299307296697391  LUMO = -0.0766017540041333
cycle= 5 E= -3.6531137783295  delta_E= -5.98e-09  |g|= 5.31e-06  |ddm|= 0.000134
  HOMO = -0.299306702538665  LUMO = -0.0766017297707463
cycle= 6 E= -3.65311377833968  delta_E= -1.02e-11  |g|= 1.12e-07  |ddm|= 5.49e-06
  HOMO = -0.299306720401989  LUMO = -0.0766017265002854
Extra cycle  E= -3.65311377833969  delta_E= -5.33e-15  |g|= 1.94e-08  |ddm|= 1.26e-07
converged SCF energy = -3.65311377833969

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.80976355]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.92236105]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.5

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpn8kuxjsm
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45496816406994  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -3.56067723657041  dE = -1.05709073e-01  S^2 = 0.5000000
               |grad[o]|=0.268  |ddm|=4.44e-16  |maxRot[o]|=0.238
macro iter   2 ( 18 JK    4 micro), CASSCF E = -3.60656518042819  dE = -4.58879439e-02  S^2 = 0.5000000
               |grad[o]|=0.166  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60664123268595  dE = -7.60522578e-05  S^2 = 0.5000000
               |grad[o]|=0.00716  |ddm|=2.22e-16  |maxRot[o]|=0.0106
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60664123268595  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=2.53e-05  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60664123268595
CASCI E = -3.60664123268595  E(CI) = -0.924138981801319  S^2 = 0.5000000
CASCI state-averaged energy = -3.60664123268595
CASCI energy for each state
  State 0 weight 0.25  E = -3.79473089413231 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.424597467943 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.4161622655788 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.79107430308968 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:16 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.550000000000 AA    0.000000000000   0.000000000000  -2.929075493076 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.550000000000 AA    0.000000000000   0.000000000000   2.929075493076 Bohr   0.0

nuclear repulsion = 1.53632093492903
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       165.39


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpa765k3z3
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.56897719823207
  HOMO = -0.175513418236524  LUMO = -0.125942122541741
cycle= 1 E= -3.64869842468638  delta_E= -0.0797  |g|= 0.0649  |ddm|= 1.05
  HOMO = -0.29692883208103  LUMO = -0.0856384242239447
cycle= 2 E= -3.65012663025574  delta_E= -0.00143  |g|= 0.0056  |ddm|= 0.0563
  HOMO = -0.297148401507689  LUMO = -0.0855844720983389
cycle= 3 E= -3.65014072933201  delta_E= -1.41e-05  |g|= 0.000794  |ddm|= 0.00735
  HOMO = -0.297247419142688  LUMO = -0.0857480265204957
cycle= 4 E= -3.65014104650441  delta_E= -3.17e-07  |g|= 9.32e-05  |ddm|= 0.00115
  HOMO = -0.297236876152558  LUMO = -0.0857523071090824
cycle= 5 E= -3.65014105190615  delta_E= -5.4e-09  |g|= 4.38e-06  |ddm|= 0.000128
  HOMO = -0.297236322417391  LUMO = -0.0857521922925437
cycle= 6 E= -3.65014105191301  delta_E= -6.85e-12  |g|= 8.09e-08  |ddm|= 4.47e-06
  HOMO = -0.297236338729299  LUMO = -0.0857521877905515
Extra cycle  E= -3.65014105191301  delta_E= -5.33e-15  |g|= 1.5e-08  |ddm|= 9.51e-08
converged SCF energy = -3.65014105191301

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.80621471]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.93564188]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.55

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpa765k3z3
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45913697666336  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -3.56510714144640  dE = -1.05970165e-01  S^2 = 0.5000000
               |grad[o]|= 0.27  |ddm|=2.22e-16  |maxRot[o]|=0.238
macro iter   2 ( 18 JK    4 micro), CASSCF E = -3.60927930107515  dE = -4.41721596e-02  S^2 = 0.5000000
               |grad[o]|=0.165  |ddm|=3.14e-16  |maxRot[o]|= 0.25
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.60935292643207  dE = -7.36253569e-05  S^2 = 0.5000000
               |grad[o]|=0.00711  |ddm|=3.14e-16  |maxRot[o]|=0.0102
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60935292643207  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.76e-05  |ddm|=2.51e-26  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 41 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60935292643207
CASCI E = -3.60935292643207  E(CI) = -0.921405147393740  S^2 = 0.5000000
CASCI state-averaged energy = -3.60935292643207
CASCI energy for each state
  State 0 weight 0.25  E = -3.79989432207812 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42337827117594 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41692519429137 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.79721391818286 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:17 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.600000000000 AA    0.000000000000   0.000000000000  -3.023561799304 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.600000000000 AA    0.000000000000   0.000000000000   3.023561799304 Bohr   0.0

nuclear repulsion = 1.4883109057125
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       171.33


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpon71vc_o
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.55979458234643
  HOMO = -0.176477333253723  LUMO = -0.133499205427013
cycle= 1 E= -3.64612221975959  delta_E= -0.0863  |g|= 0.0581  |ddm|= 1.04
  HOMO = -0.294491046013725  LUMO = -0.0934403278153021
cycle= 2 E= -3.64729322182748  delta_E= -0.00117  |g|= 0.00525  |ddm|= 0.0544
  HOMO = -0.295141958016555  LUMO = -0.0938730761486688
cycle= 3 E= -3.64730601648024  delta_E= -1.28e-05  |g|= 0.000691  |ddm|= 0.00729
  HOMO = -0.295252574061072  LUMO = -0.0940397278745091
cycle= 4 E= -3.64730626368237  delta_E= -2.47e-07  |g|= 8.5e-05  |ddm|= 0.00101
  HOMO = -0.295243005930529  LUMO = -0.0940428086718501
cycle= 5 E= -3.64730626831075  delta_E= -4.63e-09  |g|= 3.61e-06  |ddm|= 0.000119
  HOMO = -0.295242460416129  LUMO = -0.0940426093140064
cycle= 6 E= -3.64730626831547  delta_E= -4.72e-12  |g|= 5.48e-08  |ddm|= 3.73e-06
  HOMO = -0.295242474431103  LUMO = -0.0940426038129363
Extra cycle  E= -3.64730626831547  delta_E=    0  |g|= 1.12e-08  |ddm|= 6.67e-08
converged SCF energy = -3.64730626831547

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.80293445]
Inactive from occupied = 1
Active from unoccupied = 1 , eig [0.94687643]
Inactive from unoccupied = 12
Dimensions of active 2
# of alpha electrons 1
# of beta electrons 1
Distance = 1.6

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpon71vc_o
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46228518185550  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.57492009299398  dE = -1.12634911e-01  S^2 = 0.5000000
               |grad[o]|=0.272  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61149741623356  dE = -3.65773232e-02  S^2 = 0.5000000
               |grad[o]|=0.152  |ddm|=1.65e-25  |maxRot[o]|=0.225
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.61155729258453  dE = -5.98763510e-05  S^2 = 0.5000000
               |grad[o]|=0.00644  |ddm|=2.22e-16  |maxRot[o]|=0.00917
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61155729258453  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.4e-05  |ddm|=3.57e-28  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 41 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61155729258453
CASCI E = -3.61155729258453  E(CI) = -0.918516408834507  S^2 = 0.5000000
CASCI state-averaged energy = -3.61155729258453
CASCI energy for each state
  State 0 weight 0.25  E = -3.8045069143228 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42205249077972 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41712494197966 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.80254482325594 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:19 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.650000000000 AA    0.000000000000   0.000000000000  -3.118048105532 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.650000000000 AA    0.000000000000   0.000000000000   3.118048105532 Bohr   0.0

nuclear repulsion = 1.44321057523636
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       177.58


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp_4r6w7lz
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.55190550558949
  HOMO = -0.177303332378585  LUMO = -0.140104584130766
cycle= 1 E= -3.64363374945871  delta_E= -0.0917  |g|= 0.0523  |ddm|= 1.03
  HOMO = -0.292219259448768  LUMO = -0.100556407642242
cycle= 2 E= -3.64460679346509  delta_E= -0.000973  |g|= 0.00494  |ddm|= 0.0531
  HOMO = -0.293219219502494  LUMO = -0.101377922001427
cycle= 3 E= -3.64461843968137  delta_E= -1.16e-05  |g|= 0.000593  |ddm|= 0.00728
  HOMO = -0.293335108062831  LUMO = -0.101541302187132
cycle= 4 E= -3.64461862623543  delta_E= -1.87e-07  |g|= 7.54e-05  |ddm|= 0.000879
  HOMO = -0.293326893424745  LUMO = -0.101543577461335
cycle= 5 E= -3.64461863000103  delta_E= -3.77e-09  |g|= 3.01e-06  |ddm|= 0.000107
  HOMO = -0.293326339458152  LUMO = -0.101543307594183
cycle= 6 E= -3.64461863000442  delta_E= -3.39e-12  |g|= 3.46e-08  |ddm|= 3.23e-06
  HOMO = -0.293326351305141  LUMO = -0.101543301571558
Extra cycle  E= -3.64461863000443  delta_E= -2.66e-15  |g|= 8.02e-09  |ddm|= 4.47e-08
converged SCF energy = -3.64461863000443

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.79992102]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.20007898 0.9563238 ]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.65

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp_4r6w7lz
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46458888935998  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.57767255079676  dE = -1.13083661e-01  S^2 = 0.5000000
               |grad[o]|=0.275  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61325355281210  dE = -3.55810020e-02  S^2 = 0.5000000
               |grad[o]|=0.152  |ddm|=3.14e-16  |maxRot[o]|= 0.22
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.61332324795265  dE = -6.96951406e-05  S^2 = 0.5000000
               |grad[o]|=0.00699  |ddm|=2.22e-16  |maxRot[o]|=0.00985
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61332324795265  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.57e-05  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 41 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61332324795265
CASCI E = -3.61332324795265  E(CI) = -0.915506830624717  S^2 = 0.5000000
CASCI state-averaged energy = -3.61332324795265
CASCI energy for each state
  State 0 weight 0.25  E = -3.80860612937222 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.42063631031519 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41687927443217 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.80717127769102 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:21 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.700000000000 AA    0.000000000000   0.000000000000  -3.212534411761 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.700000000000 AA    0.000000000000   0.000000000000   3.212534411761 Bohr   0.0

nuclear repulsion = 1.40076320537647
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       183.78


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpusrm6hvt
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.54513584252863
  HOMO = -0.178012236299108  LUMO = -0.145860822238377
cycle= 1 E= -3.64124687415652  delta_E= -0.0961  |g|= 0.0472  |ddm|= 1.03
  HOMO = -0.290098670641873  LUMO = -0.107038775005534
cycle= 2 E= -3.64206901979974  delta_E= -0.000822  |g|= 0.00468  |ddm|= 0.0522
  HOMO = -0.291379243227612  LUMO = -0.108168518785965
cycle= 3 E= -3.64207968062306  delta_E= -1.07e-05  |g|= 0.000503  |ddm|= 0.00732
  HOMO = -0.291494752729656  LUMO = -0.108323445675091
cycle= 4 E= -3.64207981679259  delta_E= -1.36e-07  |g|= 6.53e-05  |ddm|= 0.000759
  HOMO = -0.291488095785472  LUMO = -0.108325237824294
cycle= 5 E= -3.64207981970119  delta_E= -2.91e-09  |g|= 2.55e-06  |ddm|= 9.36e-05
  HOMO = -0.29148753037776  LUMO = -0.108324917837078
cycle= 6 E= -3.64207981970381  delta_E= -2.62e-12  |g|= 2.4e-08  |ddm|= 2.94e-06
  HOMO = -0.291487540894221  LUMO = -0.10832491209073
Extra cycle  E= -3.64207981970382  delta_E= -3.55e-15  |g|= 5.74e-09  |ddm|= 3.55e-08
converged SCF energy = -3.64207981970382

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.79716845]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.20283155 0.96422458]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.7

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpusrm6hvt
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46619702748274  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58555061114215  dE = -1.19353584e-01  S^2 = 0.5000000
               |grad[o]|=0.277  |ddm|=3.14e-16  |maxRot[o]|=0.276
macro iter   2 ( 16 JK    4 micro), CASSCF E = -3.61466094405486  dE = -2.91103329e-02  S^2 = 0.5000000
               |grad[o]|=0.139  |ddm|=9.14e-26  |maxRot[o]|=0.198
macro iter   3 (  5 JK    2 micro), CASSCF E = -3.61471061776009  dE = -4.96737052e-05  S^2 = 0.5000000
               |grad[o]|=0.00594  |ddm|=1.14e-27  |maxRot[o]|=0.00827
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61471061776009  dE = -8.88178420e-16  S^2 = 0.5000000
               |grad[o]|=1.13e-05  |ddm|=5.71e-28  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 41 JK  11 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61471061776009
CASCI E = -3.61471061776009  E(CI) = -0.912405631148790  S^2 = 0.5000000
CASCI state-averaged energy = -3.61471061776009
CASCI energy for each state
  State 0 weight 0.25  E = -3.81222533053968 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41915084151364 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41628943787171 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.81117686111532 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:22 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.750000000000 AA    0.000000000000   0.000000000000  -3.307020717989 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.750000000000 AA    0.000000000000   0.000000000000   3.307020717989 Bohr   0.0

nuclear repulsion = 1.36074139950857
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       190.08


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpkniqzc12
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.53933392066734
  HOMO = -0.178621755359126  LUMO = -0.150864742010529
cycle= 1 E= -3.63896894835117  delta_E= -0.0996  |g|= 0.043  |ddm|= 1.02
  HOMO = -0.288114737099171  LUMO = -0.112939235195415
cycle= 2 E= -3.63967684730403  delta_E= -0.000708  |g|= 0.00445  |ddm|= 0.0516
  HOMO = -0.289619654907031  LUMO = -0.114312104379839
cycle= 3 E= -3.639686682424  delta_E= -9.84e-06  |g|= 0.000422  |ddm|= 0.00739
  HOMO = -0.289730064486917  LUMO = -0.114454683244056
cycle= 4 E= -3.63968677855242  delta_E= -9.61e-08  |g|= 5.51e-05  |ddm|= 0.000648
  HOMO = -0.289725004282316  LUMO = -0.114456220728225
cycle= 5 E= -3.63968678068241  delta_E= -2.13e-09  |g|= 2.22e-06  |ddm|= 7.95e-05
  HOMO = -0.289724434027562  LUMO = -0.114455873913809
cycle= 6 E= -3.6396867806846  delta_E= -2.19e-12  |g|= 2.51e-08  |ddm|= 2.79e-06
  HOMO = -0.289724444523982  LUMO = -0.114455869489862
Extra cycle  E= -3.6396867806846  delta_E= -8.88e-16  |g|= 4.73e-09  |ddm|= 3.89e-08
converged SCF energy = -3.6396867806846

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.79466782]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.20533218 0.97079803]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.75

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpkniqzc12
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46723568456816  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58712520444043  dE = -1.19889520e-01  S^2 = 0.5000000
               |grad[o]|=0.279  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 16 JK    4 micro), CASSCF E = -3.61571808325079  dE = -2.85928788e-02  S^2 = 0.5000000
               |grad[o]|=0.139  |ddm|=3.14e-16  |maxRot[o]|=0.195
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61577152421213  dE = -5.34409613e-05  S^2 = 0.5000000
               |grad[o]|=0.00619  |ddm|=2.74e-26  |maxRot[o]|=0.00856
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61577152421213  dE =  8.88178420e-16  S^2 = 0.5000000
               |grad[o]|=4.18e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61577152421213
CASCI E = -3.61577152421213  E(CI) = -0.909238230927681  S^2 = 0.5000000
CASCI state-averaged energy = -3.61577152421213
CASCI energy for each state
  State 0 weight 0.25  E = -3.8154039222316 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41761068260468 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41543304649915 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.81463844551309 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:24 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.800000000000 AA    0.000000000000   0.000000000000  -3.401507024217 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.800000000000 AA    0.000000000000   0.000000000000   3.401507024217 Bohr   0.0

nuclear repulsion = 1.3229430273
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       195.68


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpph5l_cq4
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.53436785561271
  HOMO = -0.179146908608688  LUMO = -0.155205946194013
cycle= 1 E= -3.63680262685571  delta_E= -0.102  |g|= 0.0394  |ddm|= 1.01
  HOMO = -0.286253666263384  LUMO = -0.118308120846995
cycle= 2 E= -3.63742434406621  delta_E= -0.000622  |g|= 0.00426  |ddm|= 0.0511
  HOMO = -0.287937019435835  LUMO = -0.119872106943945
cycle= 3 E= -3.63743349971522  delta_E= -9.16e-06  |g|= 0.00035  |ddm|= 0.00746
  HOMO = -0.288038742767859  LUMO = -0.119999770556801
cycle= 4 E= -3.63743356541408  delta_E= -6.57e-08  |g|= 4.52e-05  |ddm|= 0.000548
  HOMO = -0.288035181176458  LUMO = -0.120001187826577
cycle= 5 E= -3.63743356688907  delta_E= -1.47e-09  |g|= 2e-06  |ddm|= 6.54e-05
  HOMO = -0.288034618090114  LUMO = -0.120000837063556
cycle= 6 E= -3.63743356689106  delta_E= -1.99e-12  |g|= 2.98e-08  |ddm|= 2.72e-06
  HOMO = -0.288034629982973  LUMO = -0.120000835006994
Extra cycle  E= -3.63743356689106  delta_E= -8.88e-16  |g|= 4.73e-09  |ddm|= 4.43e-08
converged SCF energy = -3.63743356689106

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.79240811]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.20759189 0.97624093]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.8

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpph5l_cq4
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46781146025012  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 20 JK    4 micro), CASSCF E = -3.59349623192032  dE = -1.25684772e-01  S^2 = 0.5000000
               |grad[o]|=0.281  |ddm|=4.64e-28  |maxRot[o]|=0.296
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.61654192398167  dE = -2.30456921e-02  S^2 = 0.5000000
               |grad[o]|=0.126  |ddm|=2.22e-16  |maxRot[o]|=0.178
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61655144996869  dE = -9.52598702e-06  S^2 = 0.5000000
               |grad[o]|=0.00265  |ddm|=2.22e-16  |maxRot[o]|=0.00349
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61655144996869  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=2.8e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 37 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61655144996869
CASCI E = -3.61655144996869  E(CI) = -0.906025417051267  S^2 = 0.5000000
CASCI state-averaged energy = -3.61655144996869
CASCI energy for each state
  State 0 weight 0.25  E = -3.81818803096783 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41602222779005 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41436600309156 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.8176295380253 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:25 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.850000000000 AA    0.000000000000   0.000000000000  -3.495993330445 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.850000000000 AA    0.000000000000   0.000000000000   3.495993330445 Bohr   0.0

nuclear repulsion = 1.28718781034595
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       201.10


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpxhxhp6td
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.53012300739284
  HOMO = -0.179600380771872  LUMO = -0.158966103309475
cycle= 1 E= -3.63474715916293  delta_E= -0.105  |g|= 0.0365  |ddm|= 1.01
  HOMO = -0.284502682648478  LUMO = -0.12319348947738
cycle= 2 E= -3.63530388346645  delta_E= -0.000557  |g|= 0.00409  |ddm|= 0.0508
  HOMO = -0.286327167793559  LUMO = -0.124907324168672
cycle= 3 E= -3.63531248551509  delta_E= -8.6e-06  |g|= 0.000287  |ddm|= 0.00754
  HOMO = -0.286417856084322  LUMO = -0.125018793410958
cycle= 4 E= -3.63531252908525  delta_E= -4.36e-08  |g|= 3.62e-05  |ddm|= 0.000458
  HOMO = -0.286415598580309  LUMO = -0.125020147929082
cycle= 5 E= -3.63531253004735  delta_E= -9.62e-10  |g|= 1.85e-06  |ddm|= 5.2e-05
  HOMO = -0.286415150009091  LUMO = -0.125019850862078
Extra cycle  E= -3.6353125300491  delta_E= -1.76e-12  |g|= 4.57e-07  |ddm|= 2.03e-06
converged SCF energy = -3.6353125300491

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.79037677]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.20962323 0.98072744]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.85

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpxhxhp6td
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46801412504802  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.58325526719496  dE = -1.15241142e-01  S^2 = 0.5000000
               |grad[o]|=0.283  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61700032420252  dE = -3.37450570e-02  S^2 = 0.5000000
               |grad[o]|=0.151  |ddm|=3.14e-16  |maxRot[o]|=0.208
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61709005673376  dE = -8.97325312e-05  S^2 = 0.5000000
               |grad[o]|=0.00809  |ddm|=2.22e-16  |maxRot[o]|=0.011
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61709005673376  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=4.62e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61709005673376
CASCI E = -3.61709005673376  E(CI) = -0.902787427128207  S^2 = 0.5000000
CASCI state-averaged energy = -3.61709005673376
CASCI energy for each state
  State 0 weight 0.25  E = -3.8206146841038 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41439858438066 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41313922143877 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.82020773701181 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:27 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.900000000000 AA    0.000000000000   0.000000000000  -3.590479636674 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr   0.0

nuclear repulsion = 1.25331444691579
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       206.84


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpt8pkdxfg
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.52649966107313
  HOMO = -0.179992836426112  LUMO = -0.162218770758213
cycle= 1 E= -3.63279934246129  delta_E= -0.106  |g|= 0.0341  |ddm|= 1.01
  HOMO = -0.282850145283  LUMO = -0.127640597171403
cycle= 2 E= -3.63330689470563  delta_E= -0.000508  |g|= 0.00395  |ddm|= 0.0506
  HOMO = -0.284785507851847  LUMO = -0.129471620022205
cycle= 3 E= -3.63331504575614  delta_E= -8.15e-06  |g|= 0.000234  |ddm|= 0.0076
  HOMO = -0.284864019613056  LUMO = -0.129566768672273
cycle= 4 E= -3.63331507390639  delta_E= -2.82e-08  |g|= 2.81e-05  |ddm|= 0.00038
  HOMO = -0.284862819675209  LUMO = -0.129568066206838
cycle= 5 E= -3.63331507449406  delta_E= -5.88e-10  |g|= 1.74e-06  |ddm|= 3.99e-05
  HOMO = -0.284862404141247  LUMO = -0.129567800151783
Extra cycle  E= -3.63331507449577  delta_E= -1.71e-12  |g|= 4.53e-07  |ddm|= 1.98e-06
converged SCF energy = -3.63331507449577

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78856045]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21143955 0.9844103 ]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.9

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpt8pkdxfg
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46791888902652  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58945049352884  dE = -1.21531605e-01  S^2 = 0.5000000
               |grad[o]|=0.284  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 14 JK    3 micro), CASSCF E = -3.61742009244482  dE = -2.79695989e-02  S^2 = 0.5000000
               |grad[o]|=0.139  |ddm|=2.22e-16  |maxRot[o]|=0.197
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61742184706419  dE = -1.75461938e-06  S^2 = 0.5000000
               |grad[o]|=0.00118  |ddm|=1.82e-26  |maxRot[o]|=0.00118
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61742184706419  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=9.27e-07  |ddm|=5e-28  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 37 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61742184706419
CASCI E = -3.61742184706419  E(CI) = -0.899539444775306  S^2 = 0.5000000
CASCI state-averaged energy = -3.61742184706419
CASCI energy for each state
  State 0 weight 0.25  E = -3.82272245430284 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41274803987929 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41179053935887 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.82242635471577 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:28 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -1.950000000000 AA    0.000000000000   0.000000000000  -3.684965942902 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.950000000000 AA    0.000000000000   0.000000000000   3.684965942902 Bohr   0.0

nuclear repulsion = 1.22117817904615
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       212.11


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmprumg32x7
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.52341099589988
  HOMO = -0.1803332039169  LUMO = -0.165029580027126
cycle= 1 E= -3.63095425727919  delta_E= -0.108  |g|= 0.0321  |ddm|=    1
  HOMO = -0.281285573521377  LUMO = -0.131691584493378
cycle= 2 E= -3.63142435693499  delta_E= -0.00047  |g|= 0.00382  |ddm|= 0.0504
  HOMO = -0.283307312034271  LUMO = -0.133613957167249
cycle= 3 E= -3.63143213683647  delta_E= -7.78e-06  |g|= 0.000189  |ddm|= 0.00766
  HOMO = -0.283373550793737  LUMO = -0.133693586281171
cycle= 4 E= -3.6314321546697  delta_E= -1.78e-08  |g|= 2.11e-05  |ddm|= 0.000312
  HOMO = -0.283373149319115  LUMO = -0.133694806130964
cycle= 5 E= -3.63143215500288  delta_E= -3.33e-10  |g|= 1.64e-06  |ddm|= 2.93e-05
  HOMO = -0.283372780605427  LUMO = -0.133694582023313
Extra cycle  E= -3.63143215500453  delta_E= -1.65e-12  |g|= 4.46e-07  |ddm|= 1.88e-06
converged SCF energy = -3.63143215500453

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78694494]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21305506 0.98742169]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 1.95

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmprumg32x7
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46758827044970  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 17 JK    4 micro), CASSCF E = -3.57755350616821  dE = -1.09965236e-01  S^2 = 0.5000000
               |grad[o]|=0.286  |ddm|=3.14e-16  |maxRot[o]|=0.238
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61752819501684  dE = -3.99746888e-02  S^2 = 0.5000000
               |grad[o]|=0.165  |ddm|=2.22e-16  |maxRot[o]|=0.229
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61757674161722  dE = -4.85466004e-05  S^2 = 0.5000000
               |grad[o]|=0.00601  |ddm|=2.22e-16  |maxRot[o]|=0.00795
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61757674161722  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=5.39e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61757674161722
CASCI E = -3.61757674161722  E(CI) = -0.896295763534471  S^2 = 0.5000000
CASCI state-averaged energy = -3.61757674161722
CASCI energy for each state
  State 0 weight 0.25  E = -3.82454762300757 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.41107739684491 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.41034934503817 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.82433260157823 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:30 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.000000000000 AA    0.000000000000   0.000000000000  -3.779452249130 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr   0.0

nuclear repulsion = 1.19064872457
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       217.50


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmplvpq4z3l
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.52078136596289
  HOMO = -0.180628935177127  LUMO = -0.167456651587942
cycle= 1 E= -3.6292058644456  delta_E= -0.108  |g|= 0.0304  |ddm|= 0.999
  HOMO = -0.279799621539845  LUMO = -0.135385326675811
cycle= 2 E= -3.6296471532909  delta_E= -0.000441  |g|= 0.00371  |ddm|= 0.0503
  HOMO = -0.281887955295082  LUMO = -0.137378614301324
cycle= 3 E= -3.62965462190883  delta_E= -7.47e-06  |g|= 0.000153  |ddm|= 0.00769
  HOMO = -0.28194261341414  LUMO = -0.137444169053939
cycle= 4 E= -3.62965463309506  delta_E= -1.12e-08  |g|= 1.52e-05  |ddm|= 0.000255
  HOMO = -0.281942768347491  LUMO = -0.137445284292417
cycle= 5 E= -3.62965463326804  delta_E= -1.73e-10  |g|= 1.5e-06  |ddm|= 2.05e-05
  HOMO = -0.28194245897041  LUMO = -0.137445108829891
Extra cycle  E= -3.62965463326953  delta_E= -1.48e-12  |g|= 4.24e-07  |ddm|= 1.72e-06
converged SCF energy = -3.62965463326953

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78551577]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21448423 0.9898752 ]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmplvpq4z3l
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46707388395140  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58958626253486  dE = -1.22512379e-01  S^2 = 0.5000000
               |grad[o]|=0.287  |ddm|=1.71e-27  |maxRot[o]|=0.276
macro iter   2 ( 14 JK    3 micro), CASSCF E = -3.61757862041420  dE = -2.79923579e-02  S^2 = 0.5000000
               |grad[o]|= 0.14  |ddm|=3.51e-24  |maxRot[o]|=0.196
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61758061629035  dE = -1.99587615e-06  S^2 = 0.5000000
               |grad[o]|=0.00126  |ddm|=2.22e-16  |maxRot[o]|=0.00129
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61758061629035  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=5.13e-07  |ddm|=4.44e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 37 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61758061629035
CASCI E = -3.61758061629035  E(CI) = -0.893068182199806  S^2 = 0.5000000
CASCI state-averaged energy = -3.61758061629035
CASCI energy for each state
  State 0 weight 0.25  E = -3.82612337875957 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40939257996526 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40883885465523 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.82596765178136 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:31 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.050000000000 AA    0.000000000000   0.000000000000  -3.873938555358 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.050000000000 AA    0.000000000000   0.000000000000   3.873938555358 Bohr   0.0

nuclear repulsion = 1.16160851177561
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       222.70


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpo07w85em
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51854487803673
  HOMO = -0.180886242826058  LUMO = -0.169551142832602
cycle= 1 E= -3.62754750434583  delta_E= -0.109  |g|= 0.0291  |ddm|= 0.997
  HOMO = -0.278384026387342  LUMO = -0.138757410290376
cycle= 2 E= -3.62796634851771  delta_E= -0.000419  |g|= 0.00361  |ddm|= 0.0501
  HOMO = -0.280523081254634  LUMO = -0.140805482320987
cycle= 3 E= -3.62797354956831  delta_E= -7.2e-06  |g|= 0.000125  |ddm|= 0.00771
  HOMO = -0.280567350122324  LUMO = -0.140858761227505
cycle= 4 E= -3.62797355661339  delta_E= -7.05e-09  |g|= 1.06e-05  |ddm|= 0.000209
  HOMO = -0.280567856370792  LUMO = -0.140859752775248
cycle= 5 E= -3.62797355669395  delta_E= -8.06e-11  |g|= 1.28e-06  |ddm|= 1.36e-05
  HOMO = -0.280567615285567  LUMO = -0.140859627027257
Extra cycle  E= -3.6279735566951  delta_E= -1.15e-12  |g|= 3.72e-07  |ddm|= 1.45e-06
converged SCF energy = -3.6279735566951

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78425836]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21574164 0.99186758]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.05

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpo07w85em
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46641802242466  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.59942359173289  dE = -1.33005569e-01  S^2 = 0.5000000
               |grad[o]|=0.288  |ddm|=2.28e-27  |maxRot[o]|=0.315
macro iter   2 ( 12 JK    3 micro), CASSCF E = -3.61744961817520  dE = -1.80260264e-02  S^2 = 0.5000000
               |grad[o]|=0.113  |ddm|=3.14e-16  |maxRot[o]|=0.155
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61745581691104  dE = -6.19873583e-06  S^2 = 0.5000000
               |grad[o]|=0.00217  |ddm|=    0  |maxRot[o]|=0.00277
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61745581691104  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=9.63e-07  |ddm|=1.4e-23  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 37 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61745581691104
CASCI E = -3.61745581691104  E(CI) = -0.889865999453133  S^2 = 0.5000000
CASCI state-averaged energy = -3.61745581691104
CASCI energy for each state
  State 0 weight 0.25  E = -3.82747992010027 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40769855483851 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40727731482339 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.82736747788197 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:32 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.100000000000 AA    0.000000000000   0.000000000000  -3.968424861587 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.100000000000 AA    0.000000000000   0.000000000000   3.968424861587 Bohr   0.0

nuclear repulsion = 1.13395116625714
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       228.14


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpr5yug4_j
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51664422464009
  HOMO = -0.181110313210348  LUMO = -0.171357860679086
cycle= 1 E= -3.62597231314801  delta_E= -0.109  |g|= 0.028  |ddm|= 0.995
  HOMO = -0.27703154310158  LUMO = -0.141840205145884
cycle= 2 E= -3.62637341571645  delta_E= -0.000401  |g|= 0.00352  |ddm|= 0.05
  HOMO = -0.279208694101186  LUMO = -0.143930381212528
cycle= 3 E= -3.62638038074846  delta_E= -6.97e-06  |g|= 0.000103  |ddm|= 0.00771
  HOMO = -0.279243998754658  LUMO = -0.14397328479232
cycle= 4 E= -3.62638038528261  delta_E= -4.53e-09  |g|= 7e-06  |ddm|= 0.000171
  HOMO = -0.279244700960268  LUMO = -0.143974149558775
cycle= 5 E= -3.62638038531531  delta_E= -3.27e-11  |g|= 9.67e-07  |ddm|= 8.62e-06
  HOMO = -0.279244528653128  LUMO = -0.143974066957901
Extra cycle  E= -3.62638038531599  delta_E= -6.77e-13  |g|= 2.84e-07  |ddm|= 1.08e-06
converged SCF energy = -3.62638038531599

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78315826]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21684174 0.99348062]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.1

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpr5yug4_j
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46565511107573  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58899311448500  dE = -1.23338003e-01  S^2 = 0.5000000
               |grad[o]|=0.289  |ddm|=3.43e-27  |maxRot[o]|=0.276
macro iter   2 ( 14 JK    3 micro), CASSCF E = -3.61721969843499  dE = -2.82265839e-02  S^2 = 0.5000000
               |grad[o]|=0.141  |ddm|=3.14e-16  |maxRot[o]|=0.196
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61722165041046  dE = -1.95197547e-06  S^2 = 0.5000000
               |grad[o]|=0.00125  |ddm|=3.14e-16  |maxRot[o]|=0.00125
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61722165041046  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=5.16e-07  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 37 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61722165041046
CASCI E = -3.61722165041046  E(CI) = -0.886697413428059  S^2 = 0.5000000
CASCI state-averaged energy = -3.61722165041046
CASCI energy for each state
  State 0 weight 0.25  E = -3.82864437861119 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40599963248982 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40567909609182 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.828563494449 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:34 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.150000000000 AA    0.000000000000   0.000000000000  -4.062911167815 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.150000000000 AA    0.000000000000   0.000000000000   4.062911167815 Bohr   0.0

nuclear repulsion = 1.10758020890233
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       233.54


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp2h39y4hs
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51502971577656
  HOMO = -0.181305493337852  LUMO = -0.172915892125929
cycle= 1 E= -3.62447355660522  delta_E= -0.109  |g|= 0.0271  |ddm|= 0.993
  HOMO = -0.275735873232429  LUMO = -0.144663004837148
cycle= 2 E= -3.62486041561284  delta_E= -0.000387  |g|= 0.00344  |ddm|= 0.0499
  HOMO = -0.277941192388792  LUMO = -0.146785376465625
cycle= 3 E= -3.62486716756808  delta_E= -6.75e-06  |g|= 8.59e-05  |ddm|= 0.00769
  HOMO = -0.277968987549732  LUMO = -0.146819723599054
cycle= 4 E= -3.62486717060503  delta_E= -3.04e-09  |g|= 4.52e-06  |ddm|= 0.000142
  HOMO = -0.277969784985041  LUMO = -0.146820475366556
cycle= 5 E= -3.62486717061632  delta_E= -1.13e-11  |g|= 5.85e-07  |ddm|= 5.42e-06
  HOMO = -0.277969669235403  LUMO = -0.146820421934103
Extra cycle  E= -3.62486717061657  delta_E= -2.54e-13  |g|= 1.72e-07  |ddm|= 6.4e-07
converged SCF energy = -3.62486717061657

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78220134]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21779866 0.99478294]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.15

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp2h39y4hs
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46481301572674  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.58263835812201  dE = -1.17825342e-01  S^2 = 0.5000000
               |grad[o]|= 0.29  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61680378017438  dE = -3.41654221e-02  S^2 = 0.5000000
               |grad[o]|=0.154  |ddm|=2.22e-16  |maxRot[o]|=0.207
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61689483917533  dE = -9.10590009e-05  S^2 = 0.5000000
               |grad[o]|=0.00825  |ddm|=1.5e-22  |maxRot[o]|=0.011
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61689483917533  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=2.58e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61689483917533
CASCI E = -3.61689483917533  E(CI) = -0.883568971029250  S^2 = 0.5000000
CASCI state-averaged energy = -3.61689483917533
CASCI energy for each state
  State 0 weight 0.25  E = -3.82964129752704 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40429932007588 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40405536795685 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.82958337114154 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:35 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.200000000000 AA    0.000000000000   0.000000000000  -4.157397474043 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.200000000000 AA    0.000000000000   0.000000000000   4.157397474043 Bohr   0.0

nuclear repulsion = 1.08240793142727
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       239.36


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmptxs8o2ct
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.5136584512937
  HOMO = -0.181475450404588  LUMO = -0.174259222111896
cycle= 1 E= -3.62304487834971  delta_E= -0.109  |g|= 0.0264  |ddm|= 0.991
  HOMO = -0.274491589320432  LUMO = -0.147252213295293
cycle= 2 E= -3.62342012327879  delta_E= -0.000375  |g|= 0.00337  |ddm|= 0.0498
  HOMO = -0.276717367599816  LUMO = -0.149399092273182
cycle= 3 E= -3.62342667936503  delta_E= -6.56e-06  |g|= 7.32e-05  |ddm|= 0.00766
  HOMO = -0.276739006105914  LUMO = -0.149426509693264
cycle= 4 E= -3.62342668150927  delta_E= -2.14e-09  |g|= 3.09e-06  |ddm|= 0.000119
  HOMO = -0.276739844552484  LUMO = -0.149427171832488
cycle= 5 E= -3.62342668151301  delta_E= -3.75e-12  |g|= 2.2e-07  |ddm|= 3.82e-06
  HOMO = -0.276739763722542  LUMO = -0.149427131391568
Extra cycle  E= -3.62342668151305  delta_E= -3.82e-14  |g|= 6.28e-08  |ddm|= 2.31e-07
converged SCF energy = -3.62342668151305

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78137394]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21862606 0.99583179]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.2

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmptxs8o2ct
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46391419496458  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.58202817968585  dE = -1.18113985e-01  S^2 = 0.5000000
               |grad[o]|= 0.29  |ddm|=3.14e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61639993662379  dE = -3.43717569e-02  S^2 = 0.5000000
               |grad[o]|=0.155  |ddm|=4.97e-16  |maxRot[o]|=0.207
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61648992450039  dE = -8.99878766e-05  S^2 = 0.5000000
               |grad[o]|=0.00821  |ddm|=2.22e-16  |maxRot[o]|=0.0109
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61648992450039  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=2.35e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61648992450039
CASCI E = -3.61648992450039  E(CI) = -0.880485965398352  S^2 = 0.5000000
CASCI state-averaged energy = -3.61648992450039
CASCI energy for each state
  State 0 weight 0.25  E = -3.83049193728422 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40260138514188 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40241571412836 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83045066144709 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:37 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.250000000000 AA    0.000000000000   0.000000000000  -4.251883780271 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.250000000000 AA    0.000000000000   0.000000000000   4.251883780271 Bohr   0.0

nuclear repulsion = 1.05835442184
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       245.14


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpjpvxoygf
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51249358448537
  HOMO = -0.181623304106747  LUMO = -0.175417319675133
cycle= 1 E= -3.6216804628216  delta_E= -0.109  |g|= 0.0258  |ddm|= 0.99
  HOMO = -0.273294056364574  LUMO = -0.14963155842149
cycle= 2 E= -3.62204609812921  delta_E= -0.000366  |g|= 0.0033  |ddm|= 0.0497
  HOMO = -0.275534386161159  LUMO = -0.151797022210734
cycle= 3 E= -3.6220524719528  delta_E= -6.37e-06  |g|= 6.36e-05  |ddm|= 0.00762
  HOMO = -0.275551051327578  LUMO = -0.151818895899912
cycle= 4 E= -3.62205247355143  delta_E= -1.6e-09  |g|= 2.58e-06  |ddm|= 0.000101
  HOMO = -0.275551904542346  LUMO = -0.151819491560781
cycle= 5 E= -3.62205247355377  delta_E= -2.34e-12  |g|= 7.72e-08  |ddm|= 3.4e-06
  HOMO = -0.27555183768178  LUMO = -0.151819452383206
Extra cycle  E= -3.62205247355377  delta_E= -6.22e-15  |g|= 2.01e-08  |ddm|= 9.36e-08
converged SCF energy = -3.62205247355377

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78066301]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21933699 0.99667457]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.25

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpjpvxoygf
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46297668993262  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.58134113386939  dE = -1.18364444e-01  S^2 = 0.5000000
               |grad[o]|=0.291  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61593085759726  dE = -3.45897237e-02  S^2 = 0.5000000
               |grad[o]|=0.155  |ddm|=2.22e-16  |maxRot[o]|=0.208
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61601960871983  dE = -8.87511226e-05  S^2 = 0.5000000
               |grad[o]|=0.00816  |ddm|=2.22e-16  |maxRot[o]|=0.0108
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61601960871983  dE = -8.88178420e-16  S^2 = 0.5000000
               |grad[o]|=2.16e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61601960871983
CASCI E = -3.61601960871983  E(CI) = -0.877452796092557  S^2 = 0.5000000
CASCI state-averaged energy = -3.61601960871983
CASCI energy for each state
  State 0 weight 0.25  E = -3.83121578286184 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.40090869949091 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.40076741061426 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83118654191232 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:39 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.300000000000 AA    0.000000000000   0.000000000000  -4.346370086500 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.300000000000 AA    0.000000000000   0.000000000000   4.346370086500 Bohr   0.0

nuclear repulsion = 1.03534671701739
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       250.86


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp5neauhk8
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51150364206229
  HOMO = -0.181751733499304  LUMO = -0.176415681617095
cycle= 1 E= -3.62037511925811  delta_E= -0.109  |g|= 0.0253  |ddm|= 0.989
  HOMO = -0.272139351071046  LUMO = -0.151822317578288
cycle= 2 E= -3.62073269853724  delta_E= -0.000358  |g|= 0.00324  |ddm|= 0.0496
  HOMO = -0.274389765307598  LUMO = -0.15400183487248
cycle= 3 E= -3.62073890156748  delta_E= -6.2e-06  |g|= 5.61e-05  |ddm|= 0.00757
  HOMO = -0.274402449780433  LUMO = -0.154019304979374
cycle= 4 E= -3.62073890281396  delta_E= -1.25e-09  |g|= 2.56e-06  |ddm|= 8.67e-05
  HOMO = -0.274403303565469  LUMO = -0.15401985226009
cycle= 5 E= -3.62073890281691  delta_E= -2.95e-12  |g|= 2.32e-07  |ddm|= 3.47e-06
  HOMO = -0.274403237490381  LUMO = -0.154019809188235
Extra cycle  E= -3.62073890281695  delta_E= -3.73e-14  |g|= 6.72e-08  |ddm|= 2.63e-07
converged SCF energy = -3.62073890281695

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.78005618]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.21994382 0.9973504 ]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.3

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp5neauhk8
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46201495368375  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58651727688536  dE = -1.24502323e-01  S^2 = 0.5000000
               |grad[o]|=0.291  |ddm|=3.14e-16  |maxRot[o]|=0.276
macro iter   2 ( 16 JK    4 micro), CASSCF E = -3.61543833999161  dE = -2.89210631e-02  S^2 = 0.5000000
               |grad[o]|=0.143  |ddm|=2.22e-16  |maxRot[o]|=0.191
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61549503311298  dE = -5.66931214e-05  S^2 = 0.5000000
               |grad[o]|=0.00653  |ddm|=3.14e-16  |maxRot[o]|=0.00862
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61549503311298  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1.47e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61549503311298
CASCI E = -3.61549503311298  E(CI) = -0.874472952652843  S^2 = 0.5000000
CASCI state-averaged energy = -3.61549503311298
CASCI energy for each state
  State 0 weight 0.25  E = -3.83182988713864 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.39922420272109 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39911673524294 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83180930734927 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.350000000000 AA    0.000000000000   0.000000000000  -4.440856392728 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.350000000000 AA    0.000000000000   0.000000000000   4.440856392728 Bohr   0.0

nuclear repulsion = 1.01331806346383
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       256.48


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpf34_ty97
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.51066188140473
  HOMO = -0.181863061362592  LUMO = -0.177276328516001
cycle= 1 E= -3.61912429930159  delta_E= -0.108  |g|= 0.0248  |ddm|= 0.988
  HOMO = -0.271024179961601  LUMO = -0.153843543305367
cycle= 2 E= -3.61947504868511  delta_E= -0.000351  |g|= 0.00318  |ddm|= 0.0495
  HOMO = -0.273281346419242  LUMO = -0.156033668707808
cycle= 3 E= -3.61948109117945  delta_E= -6.04e-06  |g|= 5.01e-05  |ddm|= 0.00751
  HOMO = -0.273290859500185  LUMO = -0.156047649959051
cycle= 4 E= -3.61948109218032  delta_E= -1e-09  |g|= 2.59e-06  |ddm|= 7.54e-05
  HOMO = -0.273291704652307  LUMO = -0.156048162068018
cycle= 5 E= -3.61948109218398  delta_E= -3.66e-12  |g|= 3.07e-07  |ddm|= 3.53e-06
  HOMO = -0.273291633994253  LUMO = -0.156048114467032
Extra cycle  E= -3.61948109218405  delta_E= -7.02e-14  |g|= 8.79e-08  |ddm|= 3.43e-07
converged SCF energy = -3.61948109218405

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77954183]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22045817 0.99789134]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.35

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpf34_ty97
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46104053119369  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.59603763356208  dE = -1.34997102e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=3.14e-16  |maxRot[o]|=0.315
macro iter   2 ( 12 JK    3 micro), CASSCF E = -3.61492070555357  dE = -1.88830720e-02  S^2 = 0.5000000
               |grad[o]|=0.116  |ddm|=3.14e-16  |maxRot[o]|=0.159
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61492599572322  dE = -5.29016965e-06  S^2 = 0.5000000
               |grad[o]|=0.00202  |ddm|=2.22e-16  |maxRot[o]|=0.00253
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61492599572322  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=4.75e-07  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 37 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61492599572322
CASCI E = -3.61492599572322  E(CI) = -0.871549226535316  S^2 = 0.5000000
CASCI state-averaged energy = -3.61492599572322
CASCI energy for each state
  State 0 weight 0.25  E = -3.83234939420836 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.39755062562901 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39746894732021 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83233501573528 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:41 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.400000000000 AA    0.000000000000   0.000000000000  -4.535342698956 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.400000000000 AA    0.000000000000   0.000000000000   4.535342698956 Bohr   0.0

nuclear repulsion = 0.992207270475
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       261.88


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp933uoqyg
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50994567955587
  HOMO = -0.181959319674286  LUMO = -0.178018251687607
cycle= 1 E= -3.61792406477422  delta_E= -0.108  |g|= 0.0245  |ddm|= 0.987
  HOMO = -0.269945797779708  LUMO = -0.155712280967784
cycle= 2 E= -3.61826896984222  delta_E= -0.000345  |g|= 0.00313  |ddm|= 0.0494
  HOMO = -0.272207266098355  LUMO = -0.15791040956881
cycle= 3 E= -3.61827486137283  delta_E= -5.89e-06  |g|= 4.51e-05  |ddm|= 0.00745
  HOMO = -0.272214255278577  LUMO = -0.157921623278353
cycle= 4 E= -3.61827486218819  delta_E= -8.15e-10  |g|= 2.53e-06  |ddm|= 6.62e-05
  HOMO = -0.272214975645684  LUMO = -0.15792204211591
Extra cycle  E= -3.61827486219189  delta_E= -3.71e-12  |g|= 5.63e-07  |ddm|= 2.98e-06
converged SCF energy = -3.61827486219189

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77910915]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22089085 0.99832361]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.4

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp933uoqyg
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.46006261361513  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 18 JK    4 micro), CASSCF E = -3.57898059565550  dE = -1.18917982e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=2.22e-16  |maxRot[o]|=0.257
macro iter   2 ( 17 JK    4 micro), CASSCF E = -3.61423663723915  dE = -3.52560416e-02  S^2 = 0.5000000
               |grad[o]|=0.157  |ddm|=2.22e-16  |maxRot[o]|= 0.21
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61432111863130  dE = -8.44813921e-05  S^2 = 0.5000000
               |grad[o]|=0.00796  |ddm|=3.92e-23  |maxRot[o]|=0.0106
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61432111863130  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.82e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61432111863130
CASCI E = -3.61432111863130  E(CI) = -0.868683810085724  S^2 = 0.5000000
CASCI state-averaged energy = -3.6143211186313
CASCI energy for each state
  State 0 weight 0.25  E = -3.83278823421519 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.39588998813163 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39582798121336 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83277827096502 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:43 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.450000000000 AA    0.000000000000   0.000000000000  -4.629829005184 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.450000000000 AA    0.000000000000   0.000000000000   4.629829005184 Bohr   0.0

nuclear repulsion = 0.971958142506122
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       267.66


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpyu2zs1p9
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50933595770123
  HOMO = -0.182042299876758  LUMO = -0.178657812093582
cycle= 1 E= -3.61677102329305  delta_E= -0.107  |g|= 0.0242  |ddm|= 0.986
  HOMO = -0.268901927849225  LUMO = -0.157443772982898
cycle= 2 E= -3.61711089013029  delta_E= -0.00034  |g|= 0.00308  |ddm|= 0.0493
  HOMO = -0.271165924569215  LUMO = -0.159647945907524
cycle= 3 E= -3.61711663983965  delta_E= -5.75e-06  |g|= 4.08e-05  |ddm|= 0.00739
  HOMO = -0.27117090182417  LUMO = -0.159656954570832
cycle= 4 E= -3.61711664050627  delta_E= -6.67e-10  |g|= 2.36e-06  |ddm|= 5.84e-05
  HOMO = -0.271171606055896  LUMO = -0.159657358055083
Extra cycle  E= -3.61711664050966  delta_E= -3.39e-12  |g|= 5.41e-07  |ddm|= 2.76e-06
converged SCF energy = -3.61711664050966

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77874802]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22125198 0.99866847]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.45

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpyu2zs1p9
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45908845421401  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58410955073705  dE = -1.25021097e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=2.22e-16  |maxRot[o]|=0.276
macro iter   2 ( 16 JK    4 micro), CASSCF E = -3.61363413916459  dE = -2.95245884e-02  S^2 = 0.5000000
               |grad[o]|=0.144  |ddm|=3.14e-16  |maxRot[o]|=0.194
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61368797679307  dE = -5.38376285e-05  S^2 = 0.5000000
               |grad[o]|=0.00636  |ddm|=3.14e-16  |maxRot[o]|=0.0084
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61368797679307  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1.25e-06  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61368797679307
CASCI E = -3.61368797679307  E(CI) = -0.865878351170735  S^2 = 0.5000000
CASCI state-averaged energy = -3.61368797679307
CASCI energy for each state
  State 0 weight 0.25  E = -3.83315742179222 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.39424545218533 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39419845382263 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83315057937209 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:44 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.500000000000 AA    0.000000000000   0.000000000000  -4.724315311413 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.500000000000 AA    0.000000000000   0.000000000000   4.724315311413 Bohr   0.0

nuclear repulsion = 0.952518979656
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       273.47


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpv92906lo
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.5088166494123
  HOMO = -0.182113591320754  LUMO = -0.179209093653252
cycle= 1 E= -3.61566224793918  delta_E= -0.107  |g|= 0.0239  |ddm|= 0.986
  HOMO = -0.26789068605256  LUMO = -0.159051646695094
cycle= 2 E= -3.61599774611739  delta_E= -0.000335  |g|= 0.00303  |ddm|= 0.0492
  HOMO = -0.270155951561549  LUMO = -0.161260398910139
cycle= 3 E= -3.61600336280565  delta_E= -5.62e-06  |g|= 3.69e-05  |ddm|= 0.00733
  HOMO = -0.270159319071556  LUMO = -0.161267638437077
cycle= 4 E= -3.61600336334926  delta_E= -5.44e-10  |g|= 2.11e-06  |ddm|= 5.17e-05
  HOMO = -0.270160007742664  LUMO = -0.161268032207379
Extra cycle  E= -3.61600336335202  delta_E= -2.76e-12  |g|= 4.85e-07  |ddm|= 2.46e-06
converged SCF energy = -3.61600336335202

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77844923]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22155077 0.99894323]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.5

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpv92906lo
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45812375389439  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.59366080533721  dE = -1.35537051e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=9.14e-27  |maxRot[o]|=0.315
macro iter   2 ( 14 JK    4 micro), CASSCF E = -3.61301341125191  dE = -1.93526059e-02  S^2 = 0.5000000
               |grad[o]|=0.118  |ddm|=2.22e-16  |maxRot[o]|=0.158
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61303320054754  dE = -1.97892956e-05  S^2 = 0.5000000
               |grad[o]|=0.00386  |ddm|=1.87e-23  |maxRot[o]|=0.00507
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61303320054754  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=5.02e-07  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61303320054754
CASCI E = -3.61303320054754  E(CI) = -0.863134088757310  S^2 = 0.5000000
CASCI state-averaged energy = -3.61303320054754
CASCI energy for each state
  State 0 weight 0.25  E = -3.8334675527109 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.39261894991975 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39258339983754 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83346289972196 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:46 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.550000000000 AA    0.000000000000   0.000000000000  -4.818801617641 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.550000000000 AA    0.000000000000   0.000000000000   4.818801617641 Bohr   0.0

nuclear repulsion = 0.933842136917647
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       279.25


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpe2hxl2o2
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50837422135856
  HOMO = -0.182174610737776  LUMO = -0.179684214222027
cycle= 1 E= -3.61459519398234  delta_E= -0.106  |g|= 0.0237  |ddm|= 0.985
  HOMO = -0.266910509927463  LUMO = -0.160548084825337
cycle= 2 E= -3.61492688703377  delta_E= -0.000332  |g|= 0.00299  |ddm|= 0.0492
  HOMO = -0.269176170617415  LUMO = -0.162760327113781
cycle= 3 E= -3.61493237915391  delta_E= -5.49e-06  |g|= 3.35e-05  |ddm|= 0.00727
  HOMO = -0.2691782434427  LUMO = -0.16276613454574
cycle= 4 E= -3.61493237959509  delta_E= -4.41e-10  |g|= 1.81e-06  |ddm|= 4.59e-05
  HOMO = -0.269178917480776  LUMO = -0.162766522288093
Extra cycle  E= -3.61493237959712  delta_E= -2.03e-12  |g|= 4.11e-07  |ddm|= 2.1e-06
converged SCF energy = -3.61493237959712

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77820434]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22179566 0.99916187]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.55

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpe2hxl2o2
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45717291867264  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.59284149872984  dE = -1.35668580e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=3.14e-16  |maxRot[o]|=0.315
macro iter   2 ( 14 JK    4 micro), CASSCF E = -3.61234313287927  dE = -1.95016341e-02  S^2 = 0.5000000
               |grad[o]|=0.118  |ddm|=1.39e-22  |maxRot[o]|=0.159
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61236256219439  dE = -1.94293151e-05  S^2 = 0.5000000
               |grad[o]|=0.00382  |ddm|=2.25e-21  |maxRot[o]|=0.00502
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61236256219439  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=2.1e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61236256219439
CASCI E = -3.61236256219439  E(CI) = -0.860451865057879  S^2 = 0.5000000
CASCI state-averaged energy = -3.61236256219439
CASCI energy for each state
  State 0 weight 0.25  E = -3.83372781458561 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.39101228632705 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.39098546406435 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83372468380055 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:48 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.600000000000 AA    0.000000000000   0.000000000000  -4.913287923869 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.600000000000 AA    0.000000000000   0.000000000000   4.913287923869 Bohr   0.0

nuclear repulsion = 0.915883634284615
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       285.10


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpf06k76k3
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50799725278773
  HOMO = -0.182226625005609  LUMO = -0.180093597875707
cycle= 1 E= -3.61356762168801  delta_E= -0.106  |g|= 0.0235  |ddm|= 0.985
  HOMO = -0.265960094091059  LUMO = -0.161943978728548
cycle= 2 E= -3.61389598898363  delta_E= -0.000328  |g|= 0.00295  |ddm|= 0.0491
  HOMO = -0.268225563256192  LUMO = -0.164158906725549
cycle= 3 E= -3.61390136459647  delta_E= -5.38e-06  |g|= 3.04e-05  |ddm|= 0.00721
  HOMO = -0.268226588205589  LUMO = -0.164163542932666
cycle= 4 E= -3.61390136495312  delta_E= -3.57e-10  |g|= 1.5e-06  |ddm|= 4.08e-05
  HOMO = -0.268227248525148  LUMO = -0.164163926782306
Extra cycle  E= -3.61390136495447  delta_E= -1.35e-12  |g|= 3.29e-07  |ddm|= 1.72e-06
converged SCF energy = -3.61390136495447

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77800568]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22199432 0.99933564]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.6

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpf06k76k3
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45623929433419  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 19 JK    4 micro), CASSCF E = -3.58157153106960  dE = -1.25332237e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=1.6e-26  |maxRot[o]|=0.276
macro iter   2 ( 16 JK    4 micro), CASSCF E = -3.61163005540365  dE = -3.00585243e-02  S^2 = 0.5000000
               |grad[o]|=0.145  |ddm|=5.85e-25  |maxRot[o]|=0.196
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61168105414595  dE = -5.09987423e-05  S^2 = 0.5000000
               |grad[o]|=0.00618  |ddm|=3.14e-16  |maxRot[o]|=0.00818
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61168105414595  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1.1e-06  |ddm|=2.92e-25  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61168105414595
CASCI E = -3.61168105414595  E(CI) = -0.857832165164364  S^2 = 0.5000000
CASCI state-averaged energy = -3.61168105414595
CASCI energy for each state
  State 0 weight 0.25  E = -3.83394582603494 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.3894274114484 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.38940723375151 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83394374534896 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:49 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.650000000000 AA    0.000000000000   0.000000000000  -5.007774230097 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.650000000000 AA    0.000000000000   0.000000000000   5.007774230097 Bohr   0.0

nuclear repulsion = 0.898602810996227
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       290.84


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp1gaa_gbg
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50767607626006
  HOMO = -0.182270768931387  LUMO = -0.180446212235738
cycle= 1 E= -3.61257753034648  delta_E= -0.105  |g|= 0.0233  |ddm|= 0.985
  HOMO = -0.265038332844699  LUMO = -0.163249065506998
cycle= 2 E= -3.61290298308582  delta_E= -0.000325  |g|= 0.00292  |ddm|= 0.0491
  HOMO = -0.267303234547636  LUMO = -0.16546608985249
cycle= 3 E= -3.61290824980696  delta_E= -5.27e-06  |g|= 2.77e-05  |ddm|= 0.00715
  HOMO = -0.267303405356868  LUMO = -0.165469757542786
cycle= 4 E= -3.612908250095  delta_E= -2.88e-10  |g|= 1.19e-06  |ddm|= 3.63e-05
  HOMO = -0.267304052783632  LUMO = -0.165470138537718
Extra cycle  E= -3.61290825009582  delta_E= -8.14e-13  |g|= 2.48e-07  |ddm|= 1.35e-06
converged SCF energy = -3.61290825009582

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77784635]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22215365 0.99947361]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.65

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp1gaa_gbg
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45532535523564  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.59120152991745  dE = -1.35876175e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=3.14e-16  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.61097417084007  dE = -1.97726409e-02  S^2 = 0.5000000
               |grad[o]|=0.119  |ddm|=    0  |maxRot[o]|= 0.16
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61099296321586  dE = -1.87923758e-05  S^2 = 0.5000000
               |grad[o]|=0.00376  |ddm|=4.57e-27  |maxRot[o]|=0.00494
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61099296321586  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=1.59e-06  |ddm|=9.14e-27  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61099296321586
CASCI E = -3.61099296321586  E(CI) = -0.855275197815476  S^2 = 0.5000000
CASCI state-averaged energy = -3.61099296321586
CASCI energy for each state
  State 0 weight 0.25  E = -3.83412803303569 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38786613890801 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.3878510138337 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83412666708603 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:50 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.700000000000 AA    0.000000000000   0.000000000000  -5.102260536326 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.700000000000 AA    0.000000000000   0.000000000000   5.102260536326 Bohr   0.0

nuclear repulsion = 0.8819620182
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       296.22


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmphtk_vxgx
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50740247812268
  HOMO = -0.182308059337704  LUMO = -0.180749774491458
cycle= 1 E= -3.61162310543276  delta_E= -0.104  |g|= 0.0231  |ddm|= 0.984
  HOMO = -0.264144270442038  LUMO = -0.16447205044592
cycle= 2 E= -3.61194599859035  delta_E= -0.000323  |g|= 0.00288  |ddm|= 0.049
  HOMO = -0.266408381464386  LUMO = -0.166690743261515
cycle= 3 E= -3.61195116354672  delta_E= -5.16e-06  |g|= 2.52e-05  |ddm|= 0.00709
  HOMO = -0.266407850763356  LUMO = -0.166693600970717
cycle= 4 E= -3.61195116378021  delta_E= -2.33e-10  |g|= 9.06e-07  |ddm|= 3.23e-05
  HOMO = -0.2664084860876  LUMO = -0.166693979468594
Extra cycle  E= -3.61195116378063  delta_E= -4.28e-13  |g|= 1.73e-07  |ddm|= 1.02e-06
converged SCF energy = -3.61195116378063

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77772018]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22227982 0.99958305]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.7

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmphtk_vxgx
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45443286224211  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.59039005494780  dE = -1.35957193e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=1.28e-25  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.61028347382813  dE = -1.98934189e-02  S^2 = 0.5000000
               |grad[o]|=0.119  |ddm|=3.14e-16  |maxRot[o]|=0.161
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.61030194313188  dE = -1.84693037e-05  S^2 = 0.5000000
               |grad[o]|=0.00372  |ddm|=2.22e-16  |maxRot[o]|=0.00489
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.61030194313188  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=1.11e-06  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.61030194313188
CASCI E = -3.61030194313188  E(CI) = -0.852780887124876  S^2 = 0.5000000
CASCI state-averaged energy = -3.61030194313188
CASCI energy for each state
  State 0 weight 0.25  E = -3.83428039849919 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38632957611412 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.38631828339608 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83427951451814 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:52 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.750000000000 AA    0.000000000000   0.000000000000  -5.196746842554 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.750000000000 AA    0.000000000000   0.000000000000   5.196746842554 Bohr   0.0

nuclear repulsion = 0.865926345141818
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       301.61


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpqqu0prk1
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50716945387338
  HOMO = -0.182339406409969  LUMO = -0.181010929593636
cycle= 1 E= -3.61070267849746  delta_E= -0.104  |g|= 0.023  |ddm|= 0.984
  HOMO = -0.263277059150823  LUMO = -0.165620716365193
cycle= 2 E= -3.61102331996944  delta_E= -0.000321  |g|= 0.00285  |ddm|= 0.049
  HOMO = -0.26554026504153  LUMO = -0.167840770293635
cycle= 3 E= -3.61102838977312  delta_E= -5.07e-06  |g|= 2.31e-05  |ddm|= 0.00704
  HOMO = -0.265539153679085  LUMO = -0.167842943093421
cycle= 4 E= -3.61102838996407  delta_E= -1.91e-10  |g|= 6.69e-07  |ddm|= 2.89e-05
  HOMO = -0.265539777739291  LUMO = -0.167843319108239
Extra cycle  E= -3.61102838996427  delta_E= -1.95e-13  |g|= 1.08e-07  |ddm|= 7.27e-07
converged SCF energy = -3.61102838996427

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.7776217]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.2223783  0.99966979]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.75

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpqqu0prk1
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45356299608891  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.58958888943564  dE = -1.36025893e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=3.14e-16  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.60959292012226  dE = -2.00040307e-02  S^2 = 0.5000000
               |grad[o]|=0.119  |ddm|=2.22e-16  |maxRot[o]|=0.162
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60961108538556  dE = -1.81652633e-05  S^2 = 0.5000000
               |grad[o]|=0.00369  |ddm|=3.14e-16  |maxRot[o]|=0.00485
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60961108538556  dE = -4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=8.91e-07  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60961108538556
CASCI E = -3.60961108538556  E(CI) = -0.850348920592120  S^2 = 0.5000000
CASCI state-averaged energy = -3.60961108538556
CASCI energy for each state
  State 0 weight 0.25  E = -3.83440761265093 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38481903662354 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.38481064255514 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83440704971262 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:53 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.800000000000 AA    0.000000000000   0.000000000000  -5.291233148782 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.800000000000 AA    0.000000000000   0.000000000000   5.291233148782 Bohr   0.0

nuclear repulsion = 0.850463374692857
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       307.00


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpexb0qrtv
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50697101132642
  HOMO = -0.182365623031562  LUMO = -0.181235403856571
cycle= 1 E= -3.60981469801995  delta_E= -0.103  |g|= 0.0229  |ddm|= 0.984
  HOMO = -0.262435924928918  LUMO = -0.166702021420095
cycle= 2 E= -3.61013335580204  delta_E= -0.000319  |g|= 0.00283  |ddm|= 0.049
  HOMO = -0.264698186970755  LUMO = -0.168923218324343
cycle= 3 E= -3.61013833654273  delta_E= -4.98e-06  |g|= 2.12e-05  |ddm|= 0.00699
  HOMO = -0.26469659122945  LUMO = -0.168924805931646
cycle= 4 E= -3.61013833670114  delta_E= -1.58e-10  |g|= 4.97e-07  |ddm|= 2.59e-05
  HOMO = -0.264697204975473  LUMO = -0.168925179377196
Extra cycle  E= -3.61013833670122  delta_E= -7.82e-14  |g|= 5.78e-08  |ddm|= 5.07e-07
converged SCF energy = -3.61013833670122

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77754613]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22245387 0.99973849]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.8

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpexb0qrtv
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45271647038797  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.58880057743051  dE = -1.36084107e-01  S^2 = 0.5000000
               |grad[o]|=0.292  |ddm|=3.14e-16  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.60890510586294  dE = -2.01045284e-02  S^2 = 0.5000000
               |grad[o]|= 0.12  |ddm|=3.14e-16  |maxRot[o]|=0.162
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60892298753050  dE = -1.78816676e-05  S^2 = 0.5000000
               |grad[o]|=0.00366  |ddm|=4.75e-24  |maxRot[o]|=0.00482
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60892298753050  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=7.38e-07  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60892298753050
CASCI E = -3.60892298753050  E(CI) = -0.847978775134064  S^2 = 0.5000000
CASCI state-averaged energy = -3.6089229875305
CASCI energy for each state
  State 0 weight 0.25  E = -3.83451376673571 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38333548883037 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.38332927980943 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83451341474651 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:55 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.850000000000 AA    0.000000000000   0.000000000000  -5.385719455010 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.850000000000 AA    0.000000000000   0.000000000000   5.385719455010 Bohr   0.0

nuclear repulsion = 0.835542964610526
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       312.32


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpclocwfx6
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50680201344485

WARN: HOMO -0.182387432670484 == LUMO -0.181428136944186

cycle= 1 E= -3.60895770887461  delta_E= -0.102  |g|= 0.0228  |ddm|= 0.983
  HOMO = -0.261620140279848  LUMO = -0.167722186720924
cycle= 2 E= -3.60927461682668  delta_E= -0.000317  |g|= 0.0028  |ddm|= 0.0489
  HOMO = -0.263881470873554  LUMO = -0.169944373822073
cycle= 3 E= -3.60927951408078  delta_E= -4.9e-06  |g|= 1.95e-05  |ddm|= 0.00694
  HOMO = -0.263879468027292  LUMO = -0.16994545669176
cycle= 4 E= -3.60927951421463  delta_E= -1.34e-10  |g|= 4.14e-07  |ddm|= 2.34e-05
  HOMO = -0.263880072544202  LUMO = -0.169945827536783
Extra cycle  E= -3.60927951421469  delta_E= -5.51e-14  |g|= 4.41e-08  |ddm|= 3.96e-07
converged SCF energy = -3.60927951421469

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77748929]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22251071 0.99979287]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.85

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpclocwfx6
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45189362715367  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 20 JK    4 micro), CASSCF E = -3.58301759895654  dE = -1.31123972e-01  S^2 = 0.5000000
               |grad[o]|=0.291  |ddm|=2.22e-16  |maxRot[o]|=0.296
macro iter   2 ( 15 JK    4 micro), CASSCF E = -3.60821040075299  dE = -2.51928018e-02  S^2 = 0.5000000
               |grad[o]|=0.133  |ddm|=9.07e-24  |maxRot[o]|=0.181
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60823981757177  dE = -2.94168188e-05  S^2 = 0.5000000
               |grad[o]|=0.00469  |ddm|=1.5e-22  |maxRot[o]|=0.0062
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60823981757177  dE =  4.44089210e-16  S^2 = 0.5000000
               |grad[o]|=8.82e-07  |ddm|=1.5e-22  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 39 JK  10 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60823981757177
CASCI E = -3.60823981757177  E(CI) = -0.845669744035977  S^2 = 0.5000000
CASCI state-averaged energy = -3.60823981757177
CASCI energy for each state
  State 0 weight 0.25  E = -3.83460234381438 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38187968325263 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.38187511471683 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83460212850324 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:56 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.900000000000 AA    0.000000000000   0.000000000000  -5.480205761239 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.900000000000 AA    0.000000000000   0.000000000000   5.480205761239 Bohr   0.0

nuclear repulsion = 0.821137051427586
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       318.11


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmp5hxqe1ud
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50665805269423

WARN: HOMO -0.182405476261831 == LUMO -0.181593394948864

cycle= 1 E= -3.60813033805308  delta_E= -0.101  |g|= 0.0227  |ddm|= 0.983
  HOMO = -0.260829003659711  LUMO = -0.168686774941725
cycle= 2 E= -3.60844570062276  delta_E= -0.000315  |g|= 0.00277  |ddm|= 0.0489
  HOMO = -0.263089448174136  LUMO = -0.170909846699786
cycle= 3 E= -3.60845051947532  delta_E= -4.82e-06  |g|= 1.81e-05  |ddm|= 0.00689
  HOMO = -0.263087100756271  LUMO = -0.170910490575823
cycle= 4 E= -3.60845051959081  delta_E= -1.15e-10  |g|= 4.17e-07  |ddm|= 2.13e-05
  HOMO = -0.263087697248661  LUMO = -0.170910858924662
Extra cycle  E= -3.60845051959089  delta_E= -8.26e-14  |g|= 6.68e-08  |ddm|= 4.09e-07
converged SCF energy = -3.60845051959089

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77744758]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22255242 0.9998359 ]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.9

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmp5hxqe1ud
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45109451695653  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.58726972494201  dE = -1.36175208e-01  S^2 = 0.5000000
               |grad[o]|=0.291  |ddm|=    0  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.60754599469595  dE = -2.02762698e-02  S^2 = 0.5000000
               |grad[o]|= 0.12  |ddm|=5.48e-26  |maxRot[o]|=0.163
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60756337317420  dE = -1.73784782e-05  S^2 = 0.5000000
               |grad[o]|=0.00361  |ddm|=3.14e-16  |maxRot[o]|=0.00475
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60756337317420  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=5.72e-07  |ddm|=3.14e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60756337317420
CASCI E = -3.60756337317420  E(CI) = -0.843420961508312  S^2 = 0.5000000
CASCI state-averaged energy = -3.6075633731742
CASCI energy for each state
  State 0 weight 0.25  E = -3.83467605915816 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.38045242251104 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.38044908017381 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83467593085379 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:58 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -2.950000000000 AA    0.000000000000   0.000000000000  -5.574692067467 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.950000000000 AA    0.000000000000   0.000000000000   5.574692067467 Bohr   0.0

nuclear repulsion = 0.807219474284746
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       323.45


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmptrd0amn5
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50653534951988

WARN: HOMO -0.182420318434285 == LUMO -0.181734867010903

cycle= 1 E= -3.60733128461581  delta_E= -0.101  |g|= 0.0226  |ddm|= 0.983
  HOMO = -0.260061824675402  LUMO = -0.169600760894837
cycle= 2 E= -3.60764528077451  delta_E= -0.000314  |g|= 0.00275  |ddm|= 0.0489
  HOMO = -0.26232144824498  LUMO = -0.17182464533252
cycle= 3 E= -3.60765002585014  delta_E= -4.75e-06  |g|= 1.69e-05  |ddm|= 0.00684
  HOMO = -0.262318807318653  LUMO = -0.171824904634777
cycle= 4 E= -3.6076500259519  delta_E= -1.02e-10  |g|= 4.7e-07  |ddm|= 1.94e-05
  HOMO = -0.262319397064437  LUMO = -0.171825270750567
Extra cycle  E= -3.60765002595204  delta_E= -1.39e-13  |g|= 9.33e-08  |ddm|= 4.88e-07
converged SCF energy = -3.60765002595204

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.77741794]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.22258206 0.99986994]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 2.95

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmptrd0amn5
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.45031896544214  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.58652959501439  dE = -1.36210630e-01  S^2 = 0.5000000
               |grad[o]|=0.291  |ddm|=2.22e-16  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.60687797578209  dE = -2.03483808e-02  S^2 = 0.5000000
               |grad[o]|= 0.12  |ddm|=2.19e-25  |maxRot[o]|=0.163
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60689513476082  dE = -1.71589787e-05  S^2 = 0.5000000
               |grad[o]|=0.00358  |ddm|=2.22e-16  |maxRot[o]|=0.00472
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60689513476082  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=5.26e-07  |ddm|=7.31e-26  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60689513476082
CASCI E = -3.60689513476082  E(CI) = -0.841231425584771  S^2 = 0.5000000
CASCI state-averaged energy = -3.60689513476082
CASCI energy for each state
  State 0 weight 0.25  E = -3.83473747528445 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.37905404642494 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.37905161579659 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83473740153732 S^2 = 2.0000000
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LASPrep/HeH2/HeH2.py ****
from pyscf import gto, scf, mcscf
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs
import numpy as np
import matplotlib.pyplot as plt
from pyscf.tools import molden

def run(b):


    mol = gto.M(
        atom = f'H 0 0 {-b}; He 0 0 0; H 0 0 {b}',
        basis = 'ccpvdz',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )

    ncas = 2     # Number of active orbitals
    nelecas = 2   # Number of active electrons
    mf = scf.RHF(mol).run()

    #Set up solvers for singlet
    solvers = csf_solver(mol, smult=1)
    solvers.nroots = 3

    solverstri = csf_solver(mol, smult=3)
    solverstri.nroots = 1

    # Weights
    weights = np.ones(solvers.nroots+ solverstri.nroots) / (solvers.nroots+ solverstri.nroots)
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]

    #Run CASSCF
    sing = mcscf.CASSCF(mf, ncas, nelecas)
    sing = mcscf.state_average_mix_(sing, [solvers,solverstri], weights)
    print(f'Distance = {b}')
    sing.kernel(mo_coeff)
    sing_e = sing.e_states

    return sing_e

x = [i/20 for i in range(10, 61, 1)]


for b in x:
    sing = (run(b))#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0075.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Thu Jul 24 10:31:59 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -3.000000000000 AA    0.000000000000   0.000000000000  -5.669178373695 Bohr   0.0
[INPUT]  2 He     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.000000000000 AA    0.000000000000   0.000000000000   5.669178373695 Bohr   0.0

nuclear repulsion = 0.79376581638
number of shells = 9
number of NR pGTOs = 21
number of NR cGTOs = 15
basis = ccpvdz
ecp = {}
CPU time:       328.82


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33497194/tmpfvkadzve
max_memory 40000 MB (current use 151 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -3.50643066874475

WARN: HOMO -0.182432453344401 == LUMO -0.181855747677892

cycle= 1 E= -3.60655931232621  delta_E= -0.1  |g|= 0.0226  |ddm|= 0.983
  HOMO = -0.259317914240888  LUMO = -0.170468594883983
cycle= 2 E= -3.60687209889339  delta_E= -0.000313  |g|= 0.00273  |ddm|= 0.0489
  HOMO = -0.261576792329362  LUMO = -0.172693243350368
cycle= 3 E= -3.60687677439247  delta_E= -4.68e-06  |g|= 1.58e-05  |ddm|= 0.0068
  HOMO = -0.26157389998899  LUMO = -0.172693163690745
cycle= 4 E= -3.60687677448385  delta_E= -9.14e-11  |g|= 5.32e-07  |ddm|= 1.79e-05
  HOMO = -0.261574484275184  LUMO = -0.172693527978373
Extra cycle  E= -3.60687677448405  delta_E= -2.03e-13  |g|= 1.15e-07  |ddm|= 5.77e-07
converged SCF energy = -3.60687677448405

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = ccpvdz
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    15
  Number of occupied HF MOs is equal to  2
reference AO indices for ccpvdz ['H 1s']:
 [ 0 10]
Option 2: threshold 0.2
Active from occupied = 1 , eig [0.7773978]
Inactive from occupied = 1
Active from unoccupied = 2 , eig [0.2226022  0.99989685]
Inactive from unoccupied = 11
Dimensions of active 3
# of alpha electrons 1
# of beta electrons 1
Distance = 3.0

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (1e+1e, 2o), ncore = 1, nvir = 12
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33497194/tmpfvkadzve
max_memory 40000 MB (current use 151 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 4
pspace_size = 200
spin = None
State-average over 4 states with weights [0.25 0.25 0.25 0.25]
CASCI E = -3.44956662781290  S^2 = 0.5000000
Set conv_tol_grad to 0.000316228
macro iter   1 ( 21 JK    4 micro), CASSCF E = -3.58580730570691  dE = -1.36240678e-01  S^2 = 0.5000000
               |grad[o]|=0.291  |ddm|=    0  |maxRot[o]|=0.315
macro iter   2 ( 13 JK    3 micro), CASSCF E = -3.60621935178908  dE = -2.04120461e-02  S^2 = 0.5000000
               |grad[o]|= 0.12  |ddm|=4.53e-24  |maxRot[o]|=0.164
macro iter   3 (  3 JK    1 micro), CASSCF E = -3.60623631206571  dE = -1.69602766e-05  S^2 = 0.5000000
               |grad[o]|=0.00356  |ddm|=3.14e-16  |maxRot[o]|=0.00469
macro iter   4 (  1 JK    1 micro), CASSCF E = -3.60623631206571  dE =  0.00000000e+00  S^2 = 0.5000000
               |grad[o]|=4.9e-07  |ddm|=2.22e-16  |maxRot[o]|=    0
1-step CASSCF converged in   4 macro ( 38 JK   9 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1. 1.]
CASSCF energy = -3.60623631206571
CASCI E = -3.60623631206571  E(CI) = -0.839100020689447  S^2 = 0.5000000
CASCI state-averaged energy = -3.60623631206571
CASCI energy for each state
  State 0 weight 0.25  E = -3.83478855085085 S^2 = 0.0000000
  State 1 weight 0.25  E = -3.37768497164602 S^2 = 0.0000000
  State 2 weight 0.25  E = -3.37768321514829 S^2 = 0.0000000
  State 3 weight 0.25  E = -3.83478851061768 S^2 = 2.0000000
