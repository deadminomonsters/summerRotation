/project/lgagliardi/jtejada/examples/LAS/LASH4.py:12: FutureWarning: Most MC-PDFT and MC-DCFT modules have been moved to pyscf-forge (github.com/pyscf/pyscf-forge) and will be removed from mrh soon.
  from mrh.my_pyscf import mcpdft
Distance: 0.5
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:29 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.500000000000 AA    0.000000000000   0.000000000000   0.944863062283 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   0.500000000000 AA    0.000000000000   1.398397332178   0.944863062283 Bohr   0.0

nuclear repulsion = 4.73197265549407
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:         1.24


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp6tj5wud8
max_memory 40000 MB (current use 95 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -2.31389751622982
  HOMO = -0.00642455715801742  LUMO = 0.453908232062436
cycle= 1 E= -1.43194308077068  delta_E= 0.882  |g|= 8.85e-15  |ddm|= 2.79
  HOMO = -0.320425156436962  LUMO = 0.550736261471531
cycle= 2 E= -1.43194308077067  delta_E= 3.55e-15  |g|= 3.49e-15  |ddm|= 2.34e-14
  HOMO = -0.320425156436962  LUMO = 0.55073626147153
Extra cycle  E= -1.43194308077067  delta_E=    0  |g|= 2.03e-15  |ddm|= 9.04e-15
converged SCF energy = -1.43194308077067

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 119 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.7490888064492356), np.float64(-1.7490888064492363)]
LASCI macro 0 : E = -0.713090839756645 ; |g_int| = 1.13160200651599e-06 ; |g_ci| = 0.000142891088069805 ; |g_x| = 0
LASCI micro 1 : |x_orb| = 4.7985001077087e-07 ; |x_ci| = 4.32030839371077e-05
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.7485176755759066), np.float64(-1.7485176755759388)]
LASCI macro 1 : E = -0.713090842299856 ; |g_int| = 2.30300538996581e-06 ; |g_ci| = 1.64791994161244e-05 ; |g_x| = 0
LASCI converged after 2 cycles
LASCI E = -0.713090842299859 ; |g_int| = 2.30300538996581e-06 ; |g_ci| = 1.64791994161244e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97473979 0.02526021]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.86695  -1.65666
1 H 1s          -0.86696   1.65665
2 H 1s           0.46113   0.73872
3 H 1s           0.46113  -0.73872
Fragment 1 natural orbitals
Natural occ [1.97473979 0.02526021]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.46113   0.73872
1 H 1s           0.46113  -0.73872
2 H 1s          -0.86695  -1.65666
3 H 1s          -0.86696   1.65665
LASCI energy = -0.713090842299859

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp6tj5wud8
max_memory 40000 MB (current use 130 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.46640166049345  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -1.46640166049345  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=5.13e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.98777298 1.97695147 0.02601692 0.00925863]
CASSCF energy = -1.46640166049345
CASCI E = -1.46640166049345  E(CI) = -6.19837431598752  S^2 = 0.0000000
CASCI state-averaged energy = -1.46640166049345
CASCI energy for each state
  State 0 weight 1  E = -1.46640166049345 S^2 = 0.0000000
Distance: 0.6
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:32 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.600000000000 AA    0.000000000000   0.000000000000   1.133835674739 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   0.600000000000 AA    0.000000000000   1.398397332178   1.133835674739 Bohr   0.0

nuclear repulsion = 4.30505552719314
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:         3.83


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpxjmgh5f0
max_memory 40000 MB (current use 130 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -2.31149607577394
  HOMO = 0.065084874068324  LUMO = 0.31395845784505
cycle= 1 E= -1.52406462141479  delta_E= 0.787  |g|= 3.69e-15  |ddm|= 2.93
  HOMO = -0.252057870382233  LUMO = 0.428127595927587
cycle= 2 E= -1.52406462141479  delta_E= -2.66e-15  |g|= 3.17e-15  |ddm|= 9.9e-15
  HOMO = -0.252057870382232  LUMO = 0.428127595927587
Extra cycle  E= -1.52406462141479  delta_E= 1.78e-15  |g|= 3.35e-15  |ddm|= 1.37e-14
converged SCF energy = -1.52406462141479

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 130 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.7933608096255254), np.float64(-1.7933608096255287)]
LASCI macro 0 : E = -1.16301953214702 ; |g_int| = 4.61578979554366e-06 ; |g_ci| = 0.00013256491608718 ; |g_x| = 0
LASCI micro 1 : |x_orb| = 1.71141610817721e-06 ; |x_ci| = 3.66410187981312e-05
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.7929492852150912), np.float64(-1.7929492852150972)]
LASCI macro 1 : E = -1.16301953447917 ; |g_int| = 3.42340995181518e-06 ; |g_ci| = 4.19183073306151e-06 ; |g_x| = 0
LASCI converged after 2 cycles
LASCI E = -1.16301953447917 ; |g_int| = 3.42340995181518e-06 ; |g_ci| = 4.19183073306151e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97354792 0.02645208]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.77726  -1.51719
1 H 1s          -0.77727   1.51719
2 H 1s           0.36459   0.57781
3 H 1s           0.36459  -0.57781
Fragment 1 natural orbitals
Natural occ [1.97354792 0.02645208]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.36459   0.57781
1 H 1s          -0.36459  -0.57781
2 H 1s           0.77727  -1.51719
3 H 1s           0.77726   1.51719
LASCI energy = -1.16301953447917

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpxjmgh5f0
max_memory 40000 MB (current use 130 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.57131665035529  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -1.57131665035529  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=5.94e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.98267117 1.9359522  0.06731737 0.01405926]
CASSCF energy = -1.57131665035529
CASCI E = -1.57131665035529  E(CI) = -5.87637217754844  S^2 = 0.0000000
CASCI state-averaged energy = -1.57131665035529
CASCI energy for each state
  State 0 weight 1  E = -1.57131665035529 S^2 = 0.0000000
Distance: 0.7
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:33 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.700000000000 AA    0.000000000000   0.000000000000   1.322808287196 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   0.700000000000 AA    0.000000000000   1.398397332178   1.322808287196 Bohr   0.0

nuclear repulsion = 3.98114500084438
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:         5.50


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpmo_xnk4k
max_memory 40000 MB (current use 130 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -2.24569551730632
  HOMO = 0.128395836082602  LUMO = 0.194524419863542
cycle= 1 E= -1.53324967088098  delta_E= 0.712  |g|= 5.27e-15  |ddm|= 3.09
  HOMO = -0.190696485297011  LUMO = 0.326522176278131
cycle= 2 E= -1.53324967088098  delta_E=    0  |g|= 5.55e-15  |ddm|= 2.23e-14
  HOMO = -0.190696485297012  LUMO = 0.326522176278133
Extra cycle  E= -1.53324967088098  delta_E= 2.66e-15  |g|= 3.55e-15  |ddm|= 1.53e-14
converged SCF energy = -1.53324967088098

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 130 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8213045360825852), np.float64(-1.821304536082586)]
LASCI macro 0 : E = -1.47442768360309 ; |g_int| = 3.61874287343744e-06 ; |g_ci| = 0.000119134284223898 ; |g_x| = 0
LASCI micro 1 : |x_orb| = 1.2814836699209e-06 ; |x_ci| = 3.37511173064637e-05
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8210511748117812), np.float64(-1.8210511748117801)]
LASCI macro 1 : E = -1.47442768555675 ; |g_int| = 1.87389778202193e-06 ; |g_ci| = 3.1823917173433e-06 ; |g_x| = 0
LASCI converged after 2 cycles
LASCI E = -1.47442768555675 ; |g_int| = 1.87389778202193e-06 ; |g_ci| = 3.1823917173433e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97282986 0.02717014]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.71625  -1.42524
1 H 1s          -0.71625   1.42524
2 H 1s           0.29603   0.46330
3 H 1s           0.29603  -0.46330
Fragment 1 natural orbitals
Natural occ [1.97282986 0.02717014]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.29603   0.46330
1 H 1s          -0.29603  -0.46330
2 H 1s           0.71625  -1.42524
3 H 1s           0.71625   1.42524
LASCI energy = -1.47442768555675

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpmo_xnk4k
max_memory 40000 MB (current use 130 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.61275938390550  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -1.61275938390550  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.82e-14  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97730141 1.59276558 0.40848964 0.02144337]
CASSCF energy = -1.61275938390550
CASCI E = -1.61275938390550  E(CI) = -5.59390438474988  S^2 = 0.0000000
CASCI state-averaged energy = -1.6127593839055
CASCI energy for each state
  State 0 weight 1  E = -1.6127593839055 S^2 = 0.0000000
Distance: 0.8
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:33 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.800000000000 AA    0.000000000000   0.000000000000   1.511780899652 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   0.800000000000 AA    0.000000000000   1.398397332178   1.511780899652 Bohr   0.0

nuclear repulsion = 3.72432344040784
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:         7.78


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpfvae6p18
max_memory 40000 MB (current use 130 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -2.15610028903624
  HOMO = 0.0919397333023438  LUMO = 0.184449201836134
cycle= 1 E= -1.64704898685324  delta_E= 0.509  |g|= 8.37e-16  |ddm|= 2.78
  HOMO = -0.208804945061626  LUMO = 0.318406294490538
cycle= 2 E= -1.64704898685324  delta_E= -1.78e-15  |g|= 2.34e-15  |ddm|= 6.22e-15
  HOMO = -0.208804945061627  LUMO = 0.318406294490536
Extra cycle  E= -1.64704898685324  delta_E=    0  |g|= 1.55e-15  |ddm|= 9.22e-15
converged SCF energy = -1.64704898685324

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 130 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8385106943992324), np.float64(-1.8385106943992366)]
LASCI macro 0 : E = -1.69570291698448 ; |g_int| = 2.81575438838687e-06 ; |g_ci| = 0.000104542176041573 ; |g_x| = 0
LASCI micro 1 : |x_orb| = 9.6897289238337e-07 ; |x_ci| = 3.0304139638608e-05
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8384011202336217), np.float64(-1.838401120233627)]
LASCI macro 1 : E = -1.69570291853219 ; |g_int| = 1.02763504540202e-06 ; |g_ci| = 2.4923955551274e-06 ; |g_x| = 0
LASCI converged after 2 cycles
LASCI E = -1.69570291853219 ; |g_int| = 1.02763504540202e-06 ; |g_ci| = 2.4923955551274e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.9724601 0.0275399]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.67309  -1.36251
1 H 1s          -0.67309   1.36251
2 H 1s           0.24482   0.37757
3 H 1s           0.24482  -0.37757
Fragment 1 natural orbitals
Natural occ [1.9724601 0.0275399]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.24482   0.37757
1 H 1s          -0.24482  -0.37757
2 H 1s           0.67309  -1.36251
3 H 1s           0.67309   1.36251
LASCI energy = -1.69570291853219

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpfvae6p18
max_memory 40000 MB (current use 130 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.72453610732006  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -1.72453610732006  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=3.02e-14  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97358944 1.69661231 0.30517893 0.02461932]
CASSCF energy = -1.72453610732006
CASCI E = -1.72453610732006  E(CI) = -5.44885954772790  S^2 = 0.0000000
CASCI state-averaged energy = -1.72453610732006
CASCI energy for each state
  State 0 weight 1  E = -1.72453610732006 S^2 = 0.0000000
Distance: 0.9
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:34 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   0.900000000000 AA    0.000000000000   0.000000000000   1.700753512109 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   0.900000000000 AA    0.000000000000   1.398397332178   1.700753512109 Bohr   0.0

nuclear repulsion = 3.5144912898071
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:         9.61


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpe8q1m7n1
max_memory 40000 MB (current use 130 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -2.06241712233551
  HOMO = 0.00354766318736602  LUMO = 0.234161572503803
cycle= 1 E= -1.80757956807408  delta_E= 0.255  |g|= 2.21e-15  |ddm|= 2.33
  HOMO = -0.26738258110441  LUMO = 0.360607452843569
cycle= 2 E= -1.80757956807408  delta_E= 8.88e-16  |g|= 1.23e-15  |ddm|= 6.33e-15
  HOMO = -0.267382581104408  LUMO = 0.360607452843571
Extra cycle  E= -1.80757956807407  delta_E= 4.44e-15  |g|= 8.79e-16  |ddm|= 6.07e-15
converged SCF energy = -1.80757956807407

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 130 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8486850973944904), np.float64(-1.8486850973944942)]
LASCI macro 0 : E = -1.85539795122055 ; |g_int| = 3.94153826503756e-07 ; |g_ci| = 9.02747003866197e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -1.85539795122055 ; |g_int| = 3.94153826503756e-07 ; |g_ci| = 9.02747003866197e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97233241 0.02766759]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.64174  -1.31879
1 H 1s           0.64175   1.31878
2 H 1s          -0.20508   0.31099
3 H 1s          -0.20508  -0.31099
Fragment 1 natural orbitals
Natural occ [1.97233241 0.02766759]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.20508   0.31099
1 H 1s          -0.20508  -0.31099
2 H 1s           0.64174  -1.31879
3 H 1s           0.64175   1.31878
LASCI energy = -1.85539795122055

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpe8q1m7n1
max_memory 40000 MB (current use 130 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.86872230348789  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -1.86872230348789  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=4.68e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97277662 1.9038508  0.09904572 0.02432685]
CASSCF energy = -1.86872230348789
CASCI E = -1.86872230348789  E(CI) = -5.38321359329499  S^2 = 0.0000000
CASCI state-averaged energy = -1.86872230348789
CASCI energy for each state
  State 0 weight 1  E = -1.86872230348789 S^2 = 0.0000000
Distance: 1.0
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:34 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.000000000000 AA    0.000000000000   1.398397332178   1.889726124565 Bohr   0.0

nuclear repulsion = 3.33931272848403
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        10.46


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpkjscqf21
max_memory 40000 MB (current use 130 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.97430219388477
  HOMO = -0.0727269749093562  LUMO = 0.278321753561167
cycle= 1 E= -1.92479434004032  delta_E= 0.0495  |g|= 1.41e-15  |ddm|= 2.02
  HOMO = -0.31609163301569  LUMO = 0.39839959436518
cycle= 2 E= -1.92479434004032  delta_E= -2.66e-15  |g|= 1.4e-15  |ddm|= 5.95e-15
  HOMO = -0.316091633015691  LUMO = 0.39839959436518
Extra cycle  E= -1.92479434004032  delta_E= -1.78e-15  |g|= 1.64e-15  |ddm|= 4.15e-15
converged SCF energy = -1.92479434004032

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 130 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8543485288109136), np.float64(-1.8543485288109138)]
LASCI macro 0 : E = -1.97173647558088 ; |g_int| = 3.08899489900317e-07 ; |g_ci| = 7.6951423186288e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -1.97173647558088 ; |g_int| = 3.08899489900317e-07 ; |g_ci| = 7.6951423186288e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97238594 0.02761406]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.61858  -1.28790
1 H 1s          -0.61858   1.28790
2 H 1s           0.17334   0.25789
3 H 1s           0.17334  -0.25789
Fragment 1 natural orbitals
Natural occ [1.97238594 0.02761406]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.17334   0.25789
1 H 1s           0.17334  -0.25789
2 H 1s          -0.61858  -1.28790
3 H 1s          -0.61858   1.28790
LASCI energy = -1.97173647558088

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpkjscqf21
max_memory 40000 MB (current use 130 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -1.98010623413169  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -1.98010623413169  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=4.16e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97314264 1.94105091 0.06145195 0.0243545 ]
CASSCF energy = -1.98010623413169
CASCI E = -1.98010623413169  E(CI) = -5.31941896261571  S^2 = 0.0000000
CASCI state-averaged energy = -1.98010623413169
CASCI energy for each state
  State 0 weight 1  E = -1.98010623413169 S^2 = 0.0000000
Distance: 1.1
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:34 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.100000000000 AA    0.000000000000   0.000000000000   2.078698737022 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.100000000000 AA    0.000000000000   1.398397332178   2.078698737022 Bohr   0.0

nuclear repulsion = 3.19065821095179
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        11.87


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpx15_k99t
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.89605468543344
  HOMO = -0.13857463884805  LUMO = 0.317610515670971
cycle= 1 E= -2.01089315917674  delta_E= -0.115  |g|= 8.44e-16  |ddm|=  1.8
  HOMO = -0.35686669115089  LUMO = 0.432264721777232
cycle= 2 E= -2.01089315917674  delta_E= 1.78e-15  |g|= 5.71e-16  |ddm|= 3.09e-15
  HOMO = -0.356866691150888  LUMO = 0.432264721777234
Extra cycle  E= -2.01089315917674  delta_E= 1.78e-15  |g|= 1.35e-15  |ddm|= 3.81e-15
converged SCF energy = -2.01089315917674

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8572199273888603), np.float64(-1.857219927388867)]
LASCI macro 0 : E = -2.05697737326816 ; |g_int| = 2.42511625405574e-07 ; |g_ci| = 6.51264576977075e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.05697737326816 ; |g_int| = 2.42511625405574e-07 ; |g_ci| = 6.51264576977075e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97254701 0.02745299]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.60127  -1.26593
1 H 1s          -0.60126   1.26594
2 H 1s           0.14742   0.21473
3 H 1s           0.14742  -0.21473
Fragment 1 natural orbitals
Natural occ [1.97254701 0.02745299]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.14742   0.21473
1 H 1s           0.14742  -0.21473
2 H 1s          -0.60127  -1.26593
3 H 1s          -0.60126   1.26594
LASCI energy = -2.05697737326816

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpx15_k99t
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.06279233108276  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.06279233108276  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.07e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97372424 1.95400975 0.04784376 0.02442225]
CASSCF energy = -2.06279233108276
CASCI E = -2.06279233108276  E(CI) = -5.25345054203456  S^2 = 0.0000000
CASCI state-averaged energy = -2.06279233108276
CASCI energy for each state
  State 0 weight 1  E = -2.06279233108276 S^2 = 0.0000000
Distance: 1.2
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:35 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.200000000000 AA    0.000000000000   0.000000000000   2.267671349478 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.200000000000 AA    0.000000000000   1.398397332178   2.267671349478 Bohr   0.0

nuclear repulsion = 3.06287107445698
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        12.94


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp8ckwvmg3
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.82905282983279
  HOMO = -0.195399230331656  LUMO = 0.352605494455357
cycle= 1 E= -2.07435549744127  delta_E= -0.245  |g|= 8.87e-16  |ddm|= 1.65
  HOMO = -0.391195062424805  LUMO = 0.462603759124432
cycle= 2 E= -2.07435549744127  delta_E= -4.44e-15  |g|= 7.38e-16  |ddm|= 4.17e-15
  HOMO = -0.391195062424803  LUMO = 0.462603759124433
Extra cycle  E= -2.07435549744127  delta_E= 8.88e-16  |g|= 9.96e-16  |ddm|= 1.8e-15
converged SCF energy = -2.07435549744127

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8584460808220857), np.float64(-1.8584460808220875)]
LASCI macro 0 : E = -2.11963809154394 ; |g_int| = 1.90124992817002e-07 ; |g_ci| = 5.49442291279866e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.11963809154394 ; |g_int| = 1.90124992817002e-07 ; |g_ci| = 5.49442291279866e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97276702 0.02723298]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.58824  -1.25026
1 H 1s          -0.58823   1.25026
2 H 1s           0.12589   0.17918
3 H 1s           0.12589  -0.17918
Fragment 1 natural orbitals
Natural occ [1.97276702 0.02723298]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.12589   0.17918
1 H 1s           0.12589  -0.17918
2 H 1s          -0.58824  -1.25026
3 H 1s          -0.58823   1.25026
LASCI energy = -2.11963809154394

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp8ckwvmg3
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.12385603939174  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.12385603939174  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.47e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97430462 1.96022683 0.04099012 0.02447843]
CASSCF energy = -2.12385603939174
CASCI E = -2.12385603939174  E(CI) = -5.18672711384872  S^2 = 0.0000000
CASCI state-averaged energy = -2.12385603939174
CASCI energy for each state
  State 0 weight 1  E = -2.12385603939174 S^2 = 0.0000000
Distance: 1.3
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:35 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.300000000000 AA    0.000000000000   0.000000000000   2.456643961935 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.300000000000 AA    0.000000000000   1.398397332178   2.456643961935 Bohr   0.0

nuclear repulsion = 2.9518493882865
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        14.09


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpuv3oel0b
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.77311029603836
  HOMO = -0.244385493697934  LUMO = 0.383775441365186
cycle= 1 E= -2.12120598666786  delta_E= -0.348  |g|= 2.09e-15  |ddm|= 1.54
  HOMO = -0.42022644664085  LUMO = 0.489741599404502
cycle= 2 E= -2.12120598666785  delta_E= 8.88e-16  |g|= 1.36e-15  |ddm|= 3.59e-15
  HOMO = -0.42022644664085  LUMO = 0.489741599404502
Extra cycle  E= -2.12120598666786  delta_E= -2.66e-15  |g|= 1.46e-15  |ddm|= 3.19e-15
converged SCF energy = -2.12120598666786

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8587681417927988), np.float64(-1.8587681417928041)]
LASCI macro 0 : E = -2.16576495087181 ; |g_int| = 7.28059308211609e-07 ; |g_ci| = 4.63123022579813e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.16576495087181 ; |g_int| = 7.28059308211609e-07 ; |g_ci| = 4.63123022579813e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97301136 0.02698864]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.57839  -1.23908
1 H 1s           0.57839   1.23908
2 H 1s          -0.10777   0.14965
3 H 1s          -0.10777  -0.14965
Fragment 1 natural orbitals
Natural occ [1.97301136 0.02698864]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.10777   0.14965
1 H 1s           0.10777  -0.14965
2 H 1s          -0.57839  -1.23908
3 H 1s          -0.57839   1.23908
LASCI energy = -2.16576495087181

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpuv3oel0b
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.16889003282463  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.16889003282463  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.89e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97481288 1.96381606 0.03684968 0.02452137]
CASSCF energy = -2.16889003282463
CASCI E = -2.16889003282463  E(CI) = -5.12073942111113  S^2 = 0.0000000
CASCI state-averaged energy = -2.16889003282463
CASCI energy for each state
  State 0 weight 1  E = -2.16889003282463 S^2 = 0.0000000
Distance: 1.4
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:35 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.400000000000 AA    0.000000000000   0.000000000000   2.645616574391 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.400000000000 AA    0.000000000000   1.398397332178   2.645616574391 Bohr   0.0

nuclear repulsion = 2.85452311475324
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        15.05


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp343cxa6i
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.72726220238428
  HOMO = -0.286550258003979  LUMO = 0.411491548830133
cycle= 1 E= -2.15579707249715  delta_E= -0.429  |g|= 1.58e-15  |ddm|= 1.45
  HOMO = -0.444860418657525  LUMO = 0.513939368547722
cycle= 2 E= -2.15579707249714  delta_E= 1.78e-15  |g|= 1.28e-15  |ddm|= 3.86e-15
  HOMO = -0.444860418657527  LUMO = 0.51393936854772
Extra cycle  E= -2.15579707249715  delta_E= -3.55e-15  |g|= 1.27e-15  |ddm|= 4.15e-15
converged SCF energy = -2.15579707249715

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8586486750793643), np.float64(-1.8586486750793672)]
LASCI macro 0 : E = -2.19972027532592 ; |g_int| = 5.46311675265843e-07 ; |g_ci| = 3.91856270356914e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.19972027532592 ; |g_int| = 5.46311675265843e-07 ; |g_ci| = 3.91856270356914e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97325668 0.02674332]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.57095  -1.23112
1 H 1s           0.57095   1.23112
2 H 1s          -0.09238   0.12498
3 H 1s          -0.09238  -0.12498
Fragment 1 natural orbitals
Natural occ [1.97325668 0.02674332]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.09238   0.12498
1 H 1s           0.09238  -0.12498
2 H 1s          -0.57095  -1.23112
3 H 1s          -0.57095   1.23112
LASCI energy = -2.19972027532592

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp343cxa6i
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.20206211934390  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.20206211934390  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.49e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97522454 1.9661515  0.03406616 0.0245578 ]
CASSCF energy = -2.20206211934390
CASCI E = -2.20206211934390  E(CI) = -5.05658523409714  S^2 = 0.0000000
CASCI state-averaged energy = -2.2020621193439
CASCI energy for each state
  State 0 weight 1  E = -2.2020621193439 S^2 = 0.0000000
Distance: 1.5
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:36 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.500000000000 AA    0.000000000000   0.000000000000   2.834589186848 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.500000000000 AA    0.000000000000   1.398397332178   2.834589186848 Bohr   0.0

nuclear repulsion = 2.76853727517802
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        15.90


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmplnr9nvdj
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.69022197039064
  HOMO = -0.32277783552603  LUMO = 0.436054326849695
cycle= 1 E= -2.18131293705015  delta_E= -0.491  |g|= 1.02e-15  |ddm|= 1.39
  HOMO = -0.465811621868108  LUMO = 0.535416696887796
cycle= 2 E= -2.18131293705015  delta_E= -1.78e-15  |g|= 6.44e-16  |ddm|= 2.26e-15
  HOMO = -0.465811621868107  LUMO = 0.535416696887797
Extra cycle  E= -2.18131293705015  delta_E=    0  |g|= 5.89e-16  |ddm|= 2.07e-15
converged SCF energy = -2.18131293705015

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8583640957221124), np.float64(-1.8583640957221217)]
LASCI macro 0 : E = -2.22468999756391 ; |g_int| = 8.90906327929016e-08 ; |g_ci| = 3.33377316380007e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.22468999756391 ; |g_int| = 8.90906327929016e-08 ; |g_ci| = 3.33377316380007e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97348818 0.02651182]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.56533  -1.22546
1 H 1s          -0.56533   1.22546
2 H 1s           0.07922   0.10431
3 H 1s           0.07922  -0.10431
Fragment 1 natural orbitals
Natural occ [1.97348818 0.02651182]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.07922   0.10431
1 H 1s           0.07922  -0.10431
2 H 1s          -0.56533  -1.22546
3 H 1s          -0.56533   1.22546
LASCI energy = -2.22468999756391

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmplnr9nvdj
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.22645645081664  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.22645645081664  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.74e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97553552 1.96779991 0.0320708  0.02459376]
CASSCF energy = -2.22645645081664
CASCI E = -2.22645645081664  E(CI) = -4.99499372599466  S^2 = 0.0000000
CASCI state-averaged energy = -2.22645645081664
CASCI energy for each state
  State 0 weight 1  E = -2.22645645081664 S^2 = 0.0000000
Distance: 1.6
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:36 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.600000000000 AA    0.000000000000   0.000000000000   3.023561799304 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.600000000000 AA    0.000000000000   1.398397332178   3.023561799304 Bohr   0.0

nuclear repulsion = 2.69204962430613
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        16.88


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp116ohhzu
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.66063888797294
  HOMO = -0.353843057800099  LUMO = 0.45772273736602
cycle= 1 E= -2.20010319765137  delta_E= -0.539  |g|= 1.02e-15  |ddm|= 1.35
  HOMO = -0.48365617005157  LUMO = 0.554373962355413
cycle= 2 E= -2.20010319765137  delta_E=    0  |g|= 6.81e-16  |ddm|= 1.64e-15
  HOMO = -0.48365617005157  LUMO = 0.554373962355413
Extra cycle  E= -2.20010319765137  delta_E= 8.88e-16  |g|= 7.09e-16  |ddm|= 2.09e-15
converged SCF energy = -2.20010319765137

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8580690647825027), np.float64(-1.8580690647825038)]
LASCI macro 0 : E = -2.24302013040003 ; |g_int| = 6.84159710665008e-08 ; |g_ci| = 2.84896268776683e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.24302013040003 ; |g_int| = 6.84159710665008e-08 ; |g_ci| = 2.84896268776683e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97369736 0.02630264]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.56109  -1.22146
1 H 1s           0.56109   1.22146
2 H 1s          -0.06790   0.08696
3 H 1s          -0.06790  -0.08696
Fragment 1 natural orbitals
Natural occ [1.97369736 0.02630264]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.06790   0.08696
1 H 1s          -0.06790  -0.08696
2 H 1s           0.56109  -1.22146
3 H 1s           0.56109   1.22146
LASCI energy = -2.24302013040003

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp116ohhzu
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.24435803159807  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.24435803159807  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=1.84e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97575219 1.96903096 0.03058392 0.02463293]
CASSCF energy = -2.24435803159807
CASCI E = -2.24435803159807  E(CI) = -4.93640765590419  S^2 = 0.0000000
CASCI state-averaged energy = -2.24435803159807
CASCI energy for each state
  State 0 weight 1  E = -2.24435803159807 S^2 = 0.0000000
Distance: 1.7
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:36 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.700000000000 AA    0.000000000000   0.000000000000   3.212534411761 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.700000000000 AA    0.000000000000   1.398397332178   3.212534411761 Bohr   0.0

nuclear repulsion = 2.62359572442969
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        17.73


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpmtdbcopr
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.63723427276226
  HOMO = -0.380426968732385  LUMO = 0.476736547298455
cycle= 1 E= -2.21391060596449  delta_E= -0.577  |g|= 1.18e-15  |ddm|= 1.31
  HOMO = -0.498864762617375  LUMO = 0.571007667597295
cycle= 2 E= -2.21391060596449  delta_E=    0  |g|= 1.05e-15  |ddm|= 1.77e-15
  HOMO = -0.498864762617374  LUMO = 0.571007667597295
Extra cycle  E= -2.21391060596449  delta_E= -8.88e-16  |g|= 1.37e-15  |ddm|= 2.31e-15
converged SCF energy = -2.21391060596449

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8578405437057228), np.float64(-1.8578405437057268)]
LASCI macro 0 : E = -2.25644650947805 ; |g_int| = 5.22665052348646e-08 ; |g_ci| = 2.44853283798113e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.25644650947805 ; |g_int| = 5.22665052348646e-08 ; |g_ci| = 2.44853283798113e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97388021 0.02611979]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.55790  -1.21864
1 H 1s           0.55790   1.21863
2 H 1s          -0.05815   0.07239
3 H 1s          -0.05815  -0.07239
Fragment 1 natural orbitals
Natural occ [1.97388021 0.02611979]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.05815   0.07239
1 H 1s          -0.05815  -0.07239
2 H 1s           0.55790  -1.21864
3 H 1s           0.55790   1.21863
LASCI energy = -2.25644650947805

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpmtdbcopr
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.25746266271496  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.25746266271496  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=3.32e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.9758862  1.96998729 0.02944971 0.0246768 ]
CASSCF energy = -2.25746266271496
CASCI E = -2.25746266271496  E(CI) = -4.88105838714465  S^2 = 0.0000000
CASCI state-averaged energy = -2.25746266271496
CASCI energy for each state
  State 0 weight 1  E = -2.25746266271496 S^2 = 0.0000000
Distance: 1.8
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:37 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.800000000000 AA    0.000000000000   0.000000000000   3.401507024217 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.800000000000 AA    0.000000000000   1.398397332178   3.401507024217 Bohr   0.0

nuclear repulsion = 2.56199571759301
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        21.49


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmplgc2hp2d
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.6188652873917
  HOMO = -0.403128586550982  LUMO = 0.493328994921669
cycle= 1 E= -2.22403101193052  delta_E= -0.605  |g|= 3.85e-16  |ddm|= 1.29
  HOMO = -0.511826762890891  LUMO = 0.585517282856344
cycle= 2 E= -2.22403101193052  delta_E=    0  |g|= 5.25e-16  |ddm|= 7.99e-16
  HOMO = -0.511826762890892  LUMO = 0.585517282856344
Extra cycle  E= -2.22403101193052  delta_E= 8.88e-16  |g|= 6.53e-16  |ddm|= 3.53e-15
converged SCF energy = -2.22403101193052

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8577076983324379), np.float64(-1.857707698332438)]
LASCI macro 0 : E = -2.26625626414845 ; |g_int| = 1.67398905958537e-07 ; |g_ci| = 2.11392557631175e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.26625626414845 ; |g_int| = 1.67398905958537e-07 ; |g_ci| = 2.11392557631175e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97403582 0.02596418]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.55552  -1.21665
1 H 1s           0.55551   1.21665
2 H 1s          -0.04974   0.06016
3 H 1s          -0.04974  -0.06016
Fragment 1 natural orbitals
Natural occ [1.97403582 0.02596418]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.04974   0.06016
1 H 1s           0.04974  -0.06016
2 H 1s          -0.55551  -1.21665
3 H 1s          -0.55552   1.21665
LASCI energy = -2.26625626414845

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmplgc2hp2d
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.26702966152816  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.26702966152816  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=1.77e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97595136 1.97075108 0.02857227 0.02472529]
CASSCF energy = -2.26702966152816
CASCI E = -2.26702966152816  E(CI) = -4.82902537912117  S^2 = 0.0000000
CASCI state-averaged energy = -2.26702966152816
CASCI energy for each state
  State 0 weight 1  E = -2.26702966152816 S^2 = 0.0000000
Distance: 1.9
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:38 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   1.900000000000 AA    0.000000000000   1.398397332178   3.590479636674 Bohr   0.0

nuclear repulsion = 2.50628801604333
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        25.30


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp99eon83e
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.60454721018875
  HOMO = -0.422474404072681  LUMO = 0.507730786269409
cycle= 1 E= -2.2314284890048  delta_E= -0.627  |g|= 1.31e-15  |ddm|= 1.27
  HOMO = -0.522867897936546  LUMO = 0.598105030125682
cycle= 2 E= -2.23142848900481  delta_E= -8.88e-16  |g|= 6.12e-16  |ddm|= 1.74e-15
  HOMO = -0.522867897936545  LUMO = 0.598105030125683
Extra cycle  E= -2.23142848900481  delta_E= -8.88e-16  |g|= 7.29e-16  |ddm|= 6.74e-16
converged SCF energy = -2.23142848900481

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8576719946378903), np.float64(-1.8576719946378961)]
LASCI macro 0 : E = -2.27340404064514 ; |g_int| = 3.01133434181516e-08 ; |g_ci| = 1.83599950085841e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.27340404064514 ; |g_int| = 3.01133434181516e-08 ; |g_ci| = 1.83599950085841e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97416533 0.02583467]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.55374  -1.21527
1 H 1s           0.55374   1.21527
2 H 1s          -0.04248   0.04991
3 H 1s          -0.04248  -0.04991
Fragment 1 natural orbitals
Natural occ [1.97416533 0.02583467]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.04248   0.04991
1 H 1s          -0.04248  -0.04991
2 H 1s           0.55374  -1.21527
3 H 1s           0.55374   1.21527
LASCI energy = -2.27340404064514

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp99eon83e
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.27399368580195  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.27399368580195  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=1.68e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97596177 1.97137307 0.02788776 0.0247774 ]
CASSCF energy = -2.27399368580195
CASCI E = -2.27399368580195  E(CI) = -4.78028170184528  S^2 = 0.0000000
CASCI state-averaged energy = -2.27399368580195
CASCI energy for each state
  State 0 weight 1  E = -2.27399368580195 S^2 = 0.0000000
Distance: 2.0
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:39 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.000000000000 AA    0.000000000000   1.398397332178   3.779452249130 Bohr   0.0

nuclear repulsion = 2.45568100322051
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        26.22


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpqyl_ken6
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.59345297338034
  HOMO = -0.438926426775755  LUMO = 0.520168396131677
cycle= 1 E= -2.23681972181701  delta_E= -0.643  |g|= 5.37e-16  |ddm|= 1.25
  HOMO = -0.532263343914628  LUMO = 0.608971529295191
cycle= 2 E= -2.23681972181701  delta_E= 8.88e-16  |g|= 4.46e-16  |ddm|= 1.29e-15
  HOMO = -0.532263343914629  LUMO = 0.60897152929519
Extra cycle  E= -2.23681972181701  delta_E= -8.88e-16  |g|= 2.44e-16  |ddm|= 1.08e-15
converged SCF energy = -2.23681972181701

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.857720470330521), np.float64(-1.8577204703305226)]
LASCI macro 0 : E = -2.27859716136981 ; |g_int| = 2.27398789477017e-08 ; |g_ci| = 1.59892216893239e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.27859716136981 ; |g_int| = 2.27398789477017e-08 ; |g_ci| = 1.59892216893239e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97427108 0.02572892]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.55242  -1.21431
1 H 1s           0.55242   1.21431
2 H 1s          -0.03621   0.04134
3 H 1s          -0.03621  -0.04134
Fragment 1 natural orbitals
Natural occ [1.97427108 0.02572892]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.03621   0.04134
1 H 1s          -0.03621  -0.04134
2 H 1s           0.55242  -1.21431
3 H 1s           0.55242   1.21431
LASCI energy = -2.27859716136981

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpqyl_ken6
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.27904740606262  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.27904740606262  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.07e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97593061 1.97188662 0.02735113 0.02483165]
CASSCF energy = -2.27904740606262
CASCI E = -2.27904740606262  E(CI) = -4.73472840928312  S^2 = 0.0000000
CASCI state-averaged energy = -2.27904740606262
CASCI energy for each state
  State 0 weight 1  E = -2.27904740606262 S^2 = 0.0000000
Distance: 2.1
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:39 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.100000000000 AA    0.000000000000   0.000000000000   3.968424861587 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.100000000000 AA    0.000000000000   1.398397332178   3.968424861587 Bohr   0.0

nuclear repulsion = 2.40951715139228
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        27.09


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpbjic8g3j
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.58490111361066
  HOMO = -0.45288920039089  LUMO = 0.530859981067926
cycle= 1 E= -2.24073664577604  delta_E= -0.656  |g|= 8.63e-16  |ddm|= 1.24
  HOMO = -0.540247485243364  LUMO = 0.61831030746626
cycle= 2 E= -2.24073664577604  delta_E= 1.78e-15  |g|= 5.57e-16  |ddm|= 2.66e-15
  HOMO = -0.540247485243366  LUMO = 0.618310307466257
Extra cycle  E= -2.24073664577604  delta_E=    0  |g|= 7.19e-16  |ddm|= 9.8e-16
converged SCF energy = -2.24073664577604

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8578342339000293), np.float64(-1.8578342339000307)]
LASCI macro 0 : E = -2.2823587729486 ; |g_int| = 6.79050885948659e-08 ; |g_ci| = 1.39503527516481e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.2823587729486 ; |g_int| = 6.79050885948659e-08 ; |g_ci| = 1.39503527516481e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97435603 0.02564397]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.55144  -1.21364
1 H 1s          -0.55144   1.21364
2 H 1s           0.03081   0.03417
3 H 1s           0.03082  -0.03417
Fragment 1 natural orbitals
Natural occ [1.97435603 0.02564397]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.03082   0.03417
1 H 1s          -0.03081  -0.03417
2 H 1s           0.55144  -1.21364
3 H 1s           0.55144   1.21364
LASCI energy = -2.2823587729486

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpbjic8g3j
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.28270310091934  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.28270310091934  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=1.66e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97586954 1.97231475 0.02692927 0.02488643]
CASSCF energy = -2.28270310091934
CASCI E = -2.28270310091934  E(CI) = -4.69222025231162  S^2 = 0.0000000
CASCI state-averaged energy = -2.28270310091934
CASCI energy for each state
  State 0 weight 1  E = -2.28270310091934 S^2 = 0.0000000
Distance: 2.2
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:39 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.200000000000 AA    0.000000000000   0.000000000000   4.157397474043 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.200000000000 AA    0.000000000000   1.398397332178   4.157397474043 Bohr   0.0

nuclear repulsion = 2.36724591630788
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        27.96


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp600ohbqn
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.57833859092451
  HOMO = -0.464716087493034  LUMO = 0.540011356639338
cycle= 1 E= -2.24357326811597  delta_E= -0.665  |g|= 4.84e-16  |ddm|= 1.23
  HOMO = -0.547021280141222  LUMO = 0.626303250947513
cycle= 2 E= -2.24357326811597  delta_E= -8.88e-16  |g|= 3.93e-16  |ddm|= 1.74e-15
  HOMO = -0.547021280141222  LUMO = 0.626303250947513
Extra cycle  E= -2.24357326811597  delta_E= 8.88e-16  |g|= 1.15e-15  |ddm|= 8.59e-16
converged SCF energy = -2.24357326811597

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8579936118854081), np.float64(-1.8579936118854108)]
LASCI macro 0 : E = -2.28507496775978 ; |g_int| = 1.28668674968903e-08 ; |g_ci| = 1.22035670571148e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.28507496775978 ; |g_int| = 1.28668674968903e-08 ; |g_ci| = 1.22035670571148e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.9744233 0.0255767]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.55073  -1.21318
1 H 1s           0.55073   1.21318
2 H 1s          -0.02617   0.02821
3 H 1s          -0.02617  -0.02821
Fragment 1 natural orbitals
Natural occ [1.9744233 0.0255767]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.02617   0.02821
1 H 1s          -0.02617  -0.02821
2 H 1s           0.55073  -1.21318
3 H 1s           0.55073   1.21318
LASCI energy = -2.28507496775978

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp600ohbqn
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.28533873728744  S^2 = -0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.28533873728744  dE =  0.00000000e+00  S^2 = -0.0000000
               |grad[o]|=    0  |ddm|=1.52e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97578848 1.9726741  0.02659716 0.02494026]
CASSCF energy = -2.28533873728744
CASCI E = -2.28533873728744  E(CI) = -4.65258465359531  S^2 = -0.0000000
CASCI state-averaged energy = -2.28533873728744
CASCI energy for each state
  State 0 weight 1  E = -2.28533873728744 S^2 = -0.0000000
Distance: 2.3
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:39 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.300000000000 AA    0.000000000000   0.000000000000   4.346370086500 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.300000000000 AA    0.000000000000   1.398397332178   4.346370086500 Bohr   0.0

nuclear repulsion = 2.32840296799414
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        28.87


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpzcwj974a
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.5733221483394
  HOMO = -0.474714921621333  LUMO = 0.547813218442377
cycle= 1 E= -2.24562074925275  delta_E= -0.672  |g|= 5.24e-16  |ddm|= 1.22
  HOMO = -0.552757878494426  LUMO = 0.633117840450942
cycle= 2 E= -2.24562074925275  delta_E= 1.78e-15  |g|= 1.43e-15  |ddm|= 2.43e-15
  HOMO = -0.552757878494427  LUMO = 0.633117840450941
Extra cycle  E= -2.24562074925275  delta_E= 1.78e-15  |g|= 2.64e-16  |ddm|= 1.56e-15
converged SCF energy = -2.24562074925275

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8581809624044319), np.float64(-1.8581809624044252)]
LASCI macro 0 : E = -2.28703000790442 ; |g_int| = 3.72498118433541e-08 ; |g_ci| = 1.06722077975249e-05 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.28703000790442 ; |g_int| = 3.72498118433541e-08 ; |g_ci| = 1.06722077975249e-05 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.9744759 0.0255241]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.55021  -1.21287
1 H 1s           0.55021   1.21287
2 H 1s          -0.02219   0.02324
3 H 1s          -0.02219  -0.02324
Fragment 1 natural orbitals
Natural occ [1.9744759 0.0255241]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.02219   0.02324
1 H 1s           0.02219  -0.02324
2 H 1s          -0.55021  -1.21287
3 H 1s          -0.55021   1.21287
LASCI energy = -2.28703000790442

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpzcwj974a
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.28723246551290  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.28723246551290  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.16e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.9756955  1.9729771  0.02633556 0.02499184]
CASSCF energy = -2.28723246551290
CASCI E = -2.28723246551290  E(CI) = -4.61563543350704  S^2 = 0.0000000
CASCI state-averaged energy = -2.2872324655129
CASCI energy for each state
  State 0 weight 1  E = -2.2872324655129 S^2 = 0.0000000
Distance: 2.4
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.400000000000 AA    0.000000000000   0.000000000000   4.535342698956 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.400000000000 AA    0.000000000000   1.398397332178   4.535342698956 Bohr   0.0

nuclear repulsion = 2.29259407804694
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        29.76


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpugxpihz7
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.56950023715161
  HOMO = -0.48315310323629  LUMO = 0.55443977505123
cycle= 1 E= -2.24709368271231  delta_E= -0.678  |g|= 3.71e-16  |ddm|= 1.22
  HOMO = -0.557606944423725  LUMO = 0.638906070711607
cycle= 2 E= -2.24709368271231  delta_E= -8.88e-16  |g|= 6.4e-16  |ddm|= 1.79e-15
  HOMO = -0.557606944423724  LUMO = 0.638906070711607
Extra cycle  E= -2.24709368271231  delta_E= 8.88e-16  |g|= 3.02e-16  |ddm|= 2.15e-15
converged SCF energy = -2.24709368271231

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.858381919014625), np.float64(-1.8583819190146207)]
LASCI macro 0 : E = -2.28843263437106 ; |g_int| = 2.76253053187095e-08 ; |g_ci| = 9.33972122615253e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.28843263437106 ; |g_int| = 2.76253053187095e-08 ; |g_ci| = 9.33972122615253e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97451658 0.02548342]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.54983  -1.21265
1 H 1s          -0.54983   1.21265
2 H 1s           0.01878   0.01913
3 H 1s           0.01878  -0.01913
Fragment 1 natural orbitals
Natural occ [1.97451658 0.02548342]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.01878   0.01913
1 H 1s          -0.01878  -0.01913
2 H 1s           0.54983  -1.21265
3 H 1s           0.54983   1.21265
LASCI energy = -2.28843263437106

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpugxpihz7
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.28858840699338  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.28858840699338  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.07e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97559699 1.97323336 0.02612947 0.02504018]
CASSCF energy = -2.28858840699338
CASCI E = -2.28858840699338  E(CI) = -4.58118248504031  S^2 = 0.0000000
CASCI state-averaged energy = -2.28858840699338
CASCI energy for each state
  State 0 weight 1  E = -2.28858840699338 S^2 = 0.0000000
Distance: 2.5
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.500000000000 AA    0.000000000000   0.000000000000   4.724315311413 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.500000000000 AA    0.000000000000   1.398397332178   4.724315311413 Bohr   0.0

nuclear repulsion = 2.25948248195657
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        30.84


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp2lta4k2x
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.56659654835873
  HOMO = -0.490262190113131  LUMO = 0.560048463663891
cycle= 1 E= -2.2481497624204  delta_E= -0.682  |g|= 7.49e-16  |ddm|= 1.21
  HOMO = -0.561698023316828  LUMO = 0.643804536360194
cycle= 2 E= -2.2481497624204  delta_E= 1.78e-15  |g|= 5.36e-16  |ddm|= 1.39e-15
  HOMO = -0.561698023316828  LUMO = 0.643804536360194
Extra cycle  E= -2.24814976242039  delta_E= 8.88e-16  |g|= 5.34e-16  |ddm|= 1.53e-15
converged SCF energy = -2.24814976242039

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8585856485039793), np.float64(-1.8585856485039804)]
LASCI macro 0 : E = -2.28943568788234 ; |g_int| = 2.05114609223668e-08 ; |g_ci| = 8.1725096890617e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.28943568788234 ; |g_int| = 2.05114609223668e-08 ; |g_ci| = 8.1725096890617e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97454773 0.02545227]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.54955  -1.21250
1 H 1s           0.54955   1.21250
2 H 1s          -0.01586   0.01572
3 H 1s          -0.01586  -0.01572
Fragment 1 natural orbitals
Natural occ [1.97454773 0.02545227]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.01586  -0.01572
1 H 1s          -0.01586   0.01572
2 H 1s           0.54955   1.21250
3 H 1s           0.54955  -1.21250
LASCI energy = -2.28943568788234

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp2lta4k2x
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.28955589745922  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.28955589745922  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.08e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97549777 1.97345048 0.02596712 0.02508463]
CASSCF energy = -2.28955589745922
CASCI E = -2.28955589745922  E(CI) = -4.54903837941579  S^2 = 0.0000000
CASCI state-averaged energy = -2.28955589745922
CASCI energy for each state
  State 0 weight 1  E = -2.28955589745922 S^2 = 0.0000000
Distance: 2.6
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.600000000000 AA    0.000000000000   0.000000000000   4.913287923869 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.600000000000 AA    0.000000000000   1.398397332178   4.913287923869 Bohr   0.0

nuclear repulsion = 2.22877886965488
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        31.69


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpc8nfpxty
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.56439559963551
  HOMO = -0.496242040938779  LUMO = 0.564780332872089
cycle= 1 E= -2.24890448837518  delta_E= -0.685  |g|= 3.87e-16  |ddm|= 1.21
  HOMO = -0.56514322180189  LUMO = 0.647935149101692
cycle= 2 E= -2.24890448837518  delta_E= -4.44e-15  |g|= 6.62e-16  |ddm|= 2.14e-15
  HOMO = -0.565143221801888  LUMO = 0.647935149101693
Extra cycle  E= -2.24890448837518  delta_E= 1.78e-15  |g|= 7.42e-16  |ddm|= 1.06e-15
converged SCF energy = -2.24890448837518

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8587845555307314), np.float64(-1.858784555530735)]
LASCI macro 0 : E = -2.29015072265312 ; |g_int| = 1.52496144713263e-08 ; |g_ci| = 7.1491594937067e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.29015072265311 ; |g_int| = 1.52496144713263e-08 ; |g_ci| = 7.1491594937067e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97457139 0.02542861]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.54935  -1.21240
1 H 1s           0.54935   1.21240
2 H 1s          -0.01337   0.01290
3 H 1s          -0.01337  -0.01290
Fragment 1 natural orbitals
Natural occ [1.97457139 0.02542861]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.01337   0.01290
1 H 1s           0.01337  -0.01290
2 H 1s          -0.54935  -1.21240
3 H 1s          -0.54935   1.21240
LASCI energy = -2.29015072265311

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpc8nfpxty
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.29024382500508  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.29024382500508  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.19e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97540136 1.97363462 0.02583925 0.02512478]
CASSCF energy = -2.29024382500508
CASCI E = -2.29024382500508  E(CI) = -4.51902269465996  S^2 = 0.0000000
CASCI state-averaged energy = -2.29024382500508
CASCI energy for each state
  State 0 weight 1  E = -2.29024382500508 S^2 = 0.0000000
Distance: 2.7
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:40 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.700000000000 AA    0.000000000000   0.000000000000   5.102260536326 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.700000000000 AA    0.000000000000   1.398397332178   5.102260536326 Bohr   0.0

nuclear repulsion = 2.20023338738556
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        32.94


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp2bed_gw8
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.56273047894191
  HOMO = -0.501264570106677  LUMO = 0.568760783380557
cycle= 1 E= -2.24944215354706  delta_E= -0.687  |g|= 3.87e-16  |ddm|= 1.21
  HOMO = -0.568039408372854  LUMO = 0.651406113873139
cycle= 2 E= -2.24944215354706  delta_E=    0  |g|= 4.36e-16  |ddm|= 7.97e-16
  HOMO = -0.568039408372855  LUMO = 0.651406113873139
Extra cycle  E= -2.24944215354707  delta_E= -2.66e-15  |g|= 2.72e-16  |ddm|= 2.34e-15
converged SCF energy = -2.24944215354707

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.858973734616749), np.float64(-1.8589737346167532)]
LASCI macro 0 : E = -2.29065887873305 ; |g_int| = 1.13538316815519e-08 ; |g_ci| = 6.25221223505636e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.29065887873305 ; |g_int| = 1.13538316815519e-08 ; |g_ci| = 6.25221223505636e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97458923 0.02541077]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.54921  -1.21234
1 H 1s           0.54921   1.21234
2 H 1s          -0.01125   0.01058
3 H 1s          -0.01125  -0.01058
Fragment 1 natural orbitals
Natural occ [1.97458923 0.02541077]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.01125   0.01058
1 H 1s           0.01125  -0.01058
2 H 1s          -0.54921  -1.21234
3 H 1s          -0.54921   1.21234
LASCI energy = -2.29065887873305

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp2bed_gw8
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.29073129914464  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.29073129914464  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=1.84e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97531013 1.97379083 0.02573854 0.02516051]
CASSCF energy = -2.29073129914464
CASCI E = -2.29073129914464  E(CI) = -4.49096468653020  S^2 = 0.0000000
CASCI state-averaged energy = -2.29073129914464
CASCI energy for each state
  State 0 weight 1  E = -2.29073129914464 S^2 = 0.0000000
Distance: 2.8
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:41 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.800000000000 AA    0.000000000000   0.000000000000   5.291233148782 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.800000000000 AA    0.000000000000   1.398397332178   5.291233148782 Bohr   0.0

nuclear repulsion = 2.1736291950664
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        33.81


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmpuo6xgs1a
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.56147264950057
  HOMO = -0.505477159342966  LUMO = 0.572100491955945
cycle= 1 E= -2.24982404254576  delta_E= -0.688  |g|= 2.1e-15  |ddm|= 1.21
  HOMO = -0.570470083123616  LUMO = 0.654312967668288
cycle= 2 E= -2.24982404254575  delta_E= 3.55e-15  |g|= 6.79e-16  |ddm|= 3.5e-15
  HOMO = -0.570470083123618  LUMO = 0.654312967668287
Extra cycle  E= -2.24982404254575  delta_E=    0  |g|= 4.96e-16  |ddm|= 1.29e-15
converged SCF energy = -2.24982404254575

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8591503596052472), np.float64(-1.8591503596052428)]
LASCI macro 0 : E = -2.29101895967227 ; |g_int| = 8.46605603964951e-09 ; |g_ci| = 5.46691005573708e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.29101895967227 ; |g_int| = 8.46605603964951e-09 ; |g_ci| = 5.46691005573708e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.9746026 0.0253974]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.54911  -1.21229
1 H 1s           0.54911   1.21229
2 H 1s          -0.00945   0.00867
3 H 1s          -0.00945  -0.00867
Fragment 1 natural orbitals
Natural occ [1.9746026 0.0253974]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s          -0.00945  -0.00867
1 H 1s          -0.00945   0.00867
2 H 1s           0.54911   1.21229
3 H 1s           0.54911  -1.21229
LASCI energy = -2.29101895967227

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmpuo6xgs1a
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.29107557693992  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.29107557693992  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=2.99e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97522558 1.97392333 0.02565921 0.02519188]
CASSCF energy = -2.29107557693992
CASCI E = -2.29107557693992  E(CI) = -4.46470477200632  S^2 = 0.0000000
CASCI state-averaged energy = -2.29107557693992
CASCI energy for each state
  State 0 weight 1  E = -2.29107557693992 S^2 = 0.0000000
Distance: 2.9
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:41 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   2.900000000000 AA    0.000000000000   0.000000000000   5.480205761239 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   2.900000000000 AA    0.000000000000   1.398397332178   5.480205761239 Bohr   0.0

nuclear repulsion = 2.14877723807932
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        34.85


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp18d5iqvd
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.56052361927784
  HOMO = -0.509005755138429  LUMO = 0.57489643597625
cycle= 1 E= -2.25009453752838  delta_E= -0.69  |g|= 8.14e-16  |ddm|=  1.2
  HOMO = -0.572507011969497  LUMO = 0.656739604354601
cycle= 2 E= -2.25009453752838  delta_E=    0  |g|= 4.07e-16  |ddm|= 1.74e-15
  HOMO = -0.572507011969497  LUMO = 0.656739604354602
Extra cycle  E= -2.25009453752838  delta_E= 1.78e-15  |g|= 5.34e-16  |ddm|= 2.5e-15
converged SCF energy = -2.25009453752838

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8593131167678345), np.float64(-1.8593131167678356)]
LASCI macro 0 : E = -2.29127342165449 ; |g_int| = 6.32260771960135e-09 ; |g_ci| = 4.78039662593556e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.2912734216545 ; |g_int| = 6.32260771960135e-09 ; |g_ci| = 4.78039662593556e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97461257 0.02538743]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.54904  -1.21226
1 H 1s           0.54904   1.21226
2 H 1s          -0.00793   0.00710
3 H 1s          -0.00793  -0.00710
Fragment 1 natural orbitals
Natural occ [1.97461257 0.02538743]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.00793   0.00710
1 H 1s           0.00793  -0.00710
2 H 1s          -0.54904  -1.21226
3 H 1s          -0.54904   1.21226
LASCI energy = -2.2912734216545

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp18d5iqvd
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.29131793789900  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.29131793789900  dE =  0.00000000e+00  S^2 = 0.0000000
               |grad[o]|=    0  |ddm|=4.32e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.97514851 1.97403568 0.02559669 0.02521912]
CASSCF energy = -2.29131793789900
CASCI E = -2.29131793789900  E(CI) = -4.44009517597832  S^2 = 0.0000000
CASCI state-averaged energy = -2.291317937899
CASCI energy for each state
  State 0 weight 1  E = -2.291317937899 S^2 = 0.0000000
Distance: 3.0
#INFO: **** input file is /project/lgagliardi/jtejada/examples/LAS/LASH4.py ****
import sys
import numpy as np

from pyscf.tools import molden
from pyscf import gto, scf, mcscf, tools, dft, lib
from pyscf.mcscf import avas
from pyscf.csf_fci import csf_solver
from pyscf.csf_fci.csfstring import count_all_csfs

from mrh.my_pyscf.mcscf.lasscf_o0 import LASSCF
from mrh.my_dmet import localintegrals, dmet, fragments
from mrh.my_pyscf import mcpdft
from mrh.my_pyscf import lassi

def run(b):
    
    dist = [.5, .6, 2.0]

    mol = gto.M(
        atom = f'H 0 0 0; H 0 .74 0; H 0 0 {b}; H 0 .74 {b}',
        basis = 'STO-6G',
        charge = 0,
        spin = 0,
        verbose = 4,
        max_memory = 40000
    )


    mf = scf.RHF(mol).run()


    # LASSCF Calculations
    las = LASSCF(mf,(2, 2),(2, 2),spin_sub=(1, 1))
    frag_atom_list = ([0, 1], [2, 3]) 

    # Coeff
    mo_coeff = avas.kernel(mf, ['H 1s'],minao=mol.basis)[2]       
    mo0 = las.localize_init_guess(frag_atom_list, mo_coeff)
    las.kernel(mo0)

    
    #CAS calculations
    
    ncas = 4     # Number of active orbitals
    nelecas = 4   # Number of active electrons

    #Set up solvers1 for singlet
    solvers1 = csf_solver(mol, smult=1)
    solvers1.nroots = 1
    # Weights
    weights = np.ones(solvers1.nroots) / (solvers1.nroots)

    #Run CASSCF
    cas = mcscf.CASSCF(mf, ncas, nelecas)
    cas = mcscf.state_average_mix_(cas, [solvers1,], weights)
    cas.kernel(mo_coeff)


    for i in dist:
        if b == i:
            molden.from_mo(mol, f"AVAS_{b}.molden", mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"LAS_{b}.molden", las.mo_coeff[:, las.ncore:las.ncore+las.ncas])
            molden.from_mo(mol, f"CAS_{b}.molden", cas.mo_coeff[:, cas.ncore:cas.ncore+cas.ncas])



x = [i/10 for i in range(5, 31, 1)]


for b in x:
    print(f'Distance: {b}')
    run(b)#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='midway3-0030.rcc.local', release='4.18.0-305.3.1.el8.x86_64', version='#1 SMP Tue Jun 1 16:14:33 UTC 2021', machine='x86_64')  Threads 4
Python 3.11.5 (main, Nov 30 2024, 03:04:01) [GCC 13.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Fri Jul 25 16:20:42 2025
PySCF version 2.9.0
PySCF path  /home/jtejada/summerRotation/lib/python3.11/site-packages/pyscf
mrh path  /home/jtejada/summerRotation/mrh
GIT HEAD (branch master) cfa18e817372f7269bc605043118ba1143cc97da

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 4
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.740000000000   0.000000000000 AA    0.000000000000   1.398397332178   0.000000000000 Bohr   0.0
[INPUT]  3 H      0.000000000000   0.000000000000   3.000000000000 AA    0.000000000000   0.000000000000   5.669178373695 Bohr   0.0
[INPUT]  4 H      0.000000000000   0.740000000000   3.000000000000 AA    0.000000000000   1.398397332178   5.669178373695 Bohr   0.0

nuclear repulsion = 2.12551197542752
number of shells = 4
number of NR pGTOs = 24
number of NR cGTOs = 4
basis = STO-6G
ecp = {}
CPU time:        36.51


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /scratch/local/jobs/33599714/tmp98217zti
max_memory 40000 MB (current use 131 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
init E= -1.5598082346431
  HOMO = -0.511957668106707  LUMO = 0.577232979710893
cycle= 1 E= -2.25028565259931  delta_E= -0.69  |g|= 6.77e-16  |ddm|=  1.2
  HOMO = -0.574211680313113  LUMO = 0.65875926801772
cycle= 2 E= -2.25028565259931  delta_E=    0  |g|= 2.14e-16  |ddm|= 1.1e-15
  HOMO = -0.574211680313113  LUMO = 0.65875926801772
Extra cycle  E= -2.25028565259931  delta_E=    0  |g|= 4.66e-16  |ddm|= 1.85e-15
converged SCF energy = -2.25028565259931

******** AVAS flags ********
aolabels = ['H 1s']
ncore = 0
minao = STO-6G
threshold = 0.2
with_iao = False
openshell_option = 2
canonicalize = True

** AVAS **
  Total number of HF MOs  is equal to    4
  Number of occupied HF MOs is equal to  2
reference AO indices for STO-6G ['H 1s']:
 [0 1 2 3]
Option 2: threshold 0.2
Active from occupied = 2 , eig [1. 1.]
Inactive from occupied = 0
Active from unoccupied = 2 , eig [1. 1.]
Inactive from unoccupied = 0
Dimensions of active 4
# of alpha electrons 2
# of beta electrons 2

******** LASSCF flags ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
Divided into 2 LAS spaces
LAS 0 : (1e+1e, 2o)
LAS 1 : (1e+1e, 2o)
nroots = 1
max_cycle_macro = 50
max_cycle_micro = 5
conv_tol_grad = 0.0001
max_memory 40000 MB (current use 131 MB)
fragment 0 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
fragment 1 FCI solver flags:
******** <class 'mrh.my_pyscf.mcscf.addons.get_h1e_zipped_fcisolver.<locals>.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = 0
State-average over 1 states with weights [1.0]
LASCI subspace 0 with no orbsym information
LASCI subspace 1 with no orbsym information
LASCI subspace CI energies: [np.float64(-1.8594617300015288), np.float64(-1.8594617300015261)]
LASCI macro 0 : E = -2.29145280168449 ; |g_int| = 4.72931762105252e-09 ; |g_ci| = 4.18123664943035e-06 ; |g_x| = 0
LASCI converged after 1 cycles
LASCI E = -2.29145280168449 ; |g_int| = 4.72931762105252e-09 ; |g_ci| = 4.18123664943035e-06 ; |g_ext| = 0
Fragment 0 natural orbitals
Natural occ [1.97461998 0.02538002]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.54899  -1.21224
1 H 1s           0.54899   1.21224
2 H 1s          -0.00664   0.00581
3 H 1s          -0.00664  -0.00581
Fragment 1 natural orbitals
Natural occ [1.97461998 0.02538002]
Natural orbital (expansion on AOs) in CAS space
               #1        #2       
0 H 1s           0.00664   0.00581
1 H 1s           0.00664  -0.00581
2 H 1s          -0.54899  -1.21224
3 H 1s          -0.54899   1.21224
LASCI energy = -2.29145280168449

******** <class 'pyscf.mcscf.addons.StateAverageCASSCF'> ********
CAS (2e+2e, 4o), ncore = 0, nvir = 0
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
orbital rotation threshold for CI restart = 0.01
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /scratch/local/jobs/33599714/tmp98217zti
max_memory 40000 MB (current use 131 MB)
internal_rotation = False
******** <class 'pyscf.mcscf.addons.StateAverageMixFCISolver'> ********
max. cycles = 100
conv_tol = 1e-10
davidson only = False
linear dependence = 1e-14
level shift = 0.001
max iter space = 12
max_memory 40000 MB
nroots = 1
pspace_size = 200
spin = None
State-average over 1 states with weights [1.]
CASCI E = -2.29148802519992  S^2 = -0.0000000
Set conv_tol_grad to 0.000316228
macro iter   1 (  1 JK    1 micro), CASSCF E = -2.29148802519992  dE =  0.00000000e+00  S^2 = -0.0000000
               |grad[o]|=    0  |ddm|=1.16e-15  |maxRot[o]|=    0
1-step CASSCF converged in   1 macro (  1 JK   1 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.9750792  1.97413089 0.0255474  0.02524251]
CASSCF energy = -2.29148802519992
CASCI E = -2.29148802519992  E(CI) = -4.41700000062743  S^2 = -0.0000000
CASCI state-averaged energy = -2.29148802519992
CASCI energy for each state
  State 0 weight 1  E = -2.29148802519992 S^2 = -0.0000000
Traceback (most recent call last):
  File "/project/lgagliardi/jtejada/examples/LAS/graph.py", line 76, in <module>
    cas_energy.append(all_singlets[i][0])
                      ~~~~~~~~~~~~^^^
IndexError: list index out of range
